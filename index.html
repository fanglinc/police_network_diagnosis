<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è­¦åŠ¡ç½‘ç»œæ•…éšœè¯Šæ–­æ¨¡æ‹Ÿç³»ç»Ÿ - ä¸­é«˜çº§ä»»åŠ¡</title>
    <style>
        /* ====== é‡ç½®ä¸åŸºç¡€æ ·å¼ ====== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            /* ä¸»è‰²è°ƒ - è­¦åŠ¡é£æ ¼ */
            --police-blue: #1a237e;
            --police-dark: #0d1b2a;
            --police-light: #283593;
            --police-accent: #2196f3;
            --police-alert: #f44336;
            --police-success: #4caf50;
            --police-warning: #ff9800;
            --police-gray: #546e7a;
            --police-light-gray: #eceff1;
        }
        
        body {
            background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 100%);
            color: #e0e0e0;
            min-height: 100vh;
            line-height: 1.6;
        }
        
        /* ====== å¤´éƒ¨æ ·å¼ ====== */
        .police-header {
            background: linear-gradient(to right, var(--police-dark), var(--police-blue));
            padding: 25px 40px;
            border-bottom: 4px solid var(--police-accent);
            position: relative;
            overflow: hidden;
        }
        
        .police-header::before {
            content: "";
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: radial-gradient(circle, rgba(33, 150, 243, 0.1) 0%, transparent 70%);
            z-index: 0;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            position: relative;
            z-index: 1;
        }
        
        .police-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .police-logo-icon {
            font-size: 42px;
            color: var(--police-accent);
            text-shadow: 0 0 10px rgba(33, 150, 243, 0.5);
        }
        
        .police-title h1 {
            font-size: 28px;
            color: white;
            margin-bottom: 5px;
            letter-spacing: 0.5px;
        }
        
        .police-title .subtitle {
            color: #bbdefb;
            font-size: 16px;
            opacity: 0.9;
        }
        
        .mission-badge {
            background: rgba(244, 67, 54, 0.9);
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 18px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
        }
        
        /* ====== åœºæ™¯é€‰æ‹©å™¨ ====== */
        .scenario-selector {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        .scenario-selector h2 {
            color: #bbdefb;
            margin-bottom: 20px;
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .scenario-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .scenario-card {
            background: rgba(38, 50, 56, 0.8);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .scenario-card:hover {
            transform: translateY(-5px);
            border-color: var(--police-accent);
            box-shadow: 0 10px 30px rgba(33, 150, 243, 0.2);
        }
        
        .scenario-card.active {
            border-color: var(--police-accent);
            background: rgba(33, 150, 243, 0.1);
            box-shadow: 0 0 20px rgba(33, 150, 243, 0.3);
        }
        
        .scenario-card.active::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--police-accent);
        }
        
        .scenario-icon {
            font-size: 32px;
            color: var(--police-accent);
            margin-bottom: 15px;
        }
        
        .scenario-card h3 {
            color: white;
            margin-bottom: 10px;
            font-size: 20px;
        }
        
        .scenario-card p {
            color: #b0bec5;
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* ====== ä¸»åœºæ™¯åŒº ====== */
        .scenario-container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
            display: none;
        }
        
        .scenario-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* åœºæ™¯ä¿¡æ¯å¤´ */
        .scenario-info {
            background: rgba(26, 35, 126, 0.9);
            border-radius: 15px 15px 0 0;
            padding: 25px 30px;
            border-bottom: 2px solid var(--police-accent);
        }
        
        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .scenario-name {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .scenario-name h2 {
            color: white;
            font-size: 24px;
        }
        
        .scenario-tag {
            background: var(--police-warning);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .scenario-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-steps {
            display: flex;
            gap: 5px;
        }
        
        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }
        
        .step-dot.active {
            background: var(--police-success);
            box-shadow: 0 0 10px var(--police-success);
        }
        
        .step-dot.completed {
            background: var(--police-accent);
        }
        
        .time-pressure {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid rgba(244, 67, 54, 0.4);
            padding: 10px 20px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .time-pressure span {
            color: #ffcdd2;
            font-weight: bold;
        }
        
        /* åœºæ™¯å†…å®¹ */
        .scenario-content {
            background: rgba(38, 50, 56, 0.8);
            border-radius: 0 0 15px 15px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .situation-box {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid var(--police-accent);
        }
        
        .situation-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .situation-header h3 {
            color: white;
            font-size: 22px;
        }
        
        .situation-icon {
            font-size: 28px;
            color: var(--police-accent);
        }
        
        .situation-details {
            color: #cfd8dc;
            line-height: 1.7;
        }
        
        .situation-details p {
            margin-bottom: 10px;
        }
        
        .urgency-badge {
            display: inline-block;
            background: var(--police-alert);
            color: white;
            padding: 8px 20px;
            border-radius: 5px;
            font-weight: bold;
            margin-top: 15px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        /* ====== è¯Šæ–­å·¥å…·åŒº ====== */
        .diagnosis-area {
            background: rgba(48, 63, 71, 0.8);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .diagnosis-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }
        
        .diagnosis-tab {
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: #b0bec5;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .diagnosis-tab:hover {
            background: rgba(33, 150, 243, 0.2);
            color: white;
        }
        
        .diagnosis-tab.active {
            background: var(--police-accent);
            color: white;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* ç»ˆç«¯æ¨¡æ‹Ÿå™¨ */
        .terminal-container {
            background: #1e1e1e;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid rgba(33, 150, 243, 0.3);
        }
        
        .terminal-header {
            background: #252526;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #333;
        }
        
        .terminal-title {
            color: #cccccc;
            font-size: 14px;
            flex: 1;
        }
        
        .terminal-controls {
            display: flex;
            gap: 8px;
        }
        
        .terminal-control {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .control-close { background: #ff5f56; }
        .control-minimize { background: #ffbd2e; }
        .control-maximize { background: #27ca3f; }
        
        .terminal-output {
            height: 350px;
            overflow-y: auto;
            padding: 20px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .terminal-line {
            margin-bottom: 10px;
            word-wrap: break-word;
        }
        
        .terminal-prompt {
            color: #4caf50;
            font-weight: bold;
        }
        
        .terminal-command {
            color: white;
        }
        
        .terminal-output-text {
            color: #00bcd4;
            white-space: pre-wrap;
        }
        
        .terminal-error {
            color: #ff5252;
        }
        
        .terminal-success {
            color: #4caf50;
        }
        
        .terminal-warning {
            color: #ff9800;
        }
        
        .command-input-area {
            background: #252526;
            padding: 15px 20px;
            border-top: 1px solid #333;
            display: flex;
            gap: 10px;
        }
        
        .command-input {
            flex: 1;
            background: #2d2d2d;
            border: 1px solid #444;
            color: white;
            padding: 12px 15px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 14px;
        }
        
        .command-input:focus {
            outline: none;
            border-color: var(--police-accent);
        }
        
        .command-buttons {
            display: flex;
            gap: 10px;
        }
        
        .cmd-btn {
            padding: 12px 20px;
            background: var(--police-accent);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .cmd-btn:hover {
            background: #1976d2;
        }
        
        .cmd-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .cmd-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .quick-commands {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        
        .quick-cmd {
            background: rgba(33, 150, 243, 0.1);
            border: 1px solid rgba(33, 150, 243, 0.3);
            color: #bbdefb;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            transition: all 0.3s;
        }
        
        .quick-cmd:hover {
            background: rgba(33, 150, 243, 0.3);
            transform: translateY(-2px);
        }
        
        /* ====== å³ä¾§ä¿¡æ¯é¢æ¿ ====== */
        .info-panels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-panel {
            background: rgba(38, 50, 56, 0.8);
            border-radius: 15px;
            padding: 25px;
        }
        
        .info-panel h3 {
            color: white;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(33, 150, 243, 0.5);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .clue-list {
            list-style: none;
        }
        
        .clue-item {
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid var(--police-accent);
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 0 5px 5px 0;
            transition: all 0.3s;
        }
        
        .clue-item:hover {
            background: rgba(33, 150, 243, 0.1);
            transform: translateX(5px);
        }
        
        .clue-item.new {
            border-left-color: var(--police-warning);
            animation: highlightClue 2s ease-in-out infinite;
        }
        
        @keyframes highlightClue {
            0% { border-left-color: var(--police-warning); }
            50% { border-left-color: #ffeb3b; }
            100% { border-left-color: var(--police-warning); }
        }
        
        .step-tracker {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .step-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .step-item:hover {
            background: rgba(0, 0, 0, 0.4);
        }
        
        .step-item.active {
            background: rgba(33, 150, 243, 0.2);
            border-left: 4px solid var(--police-accent);
        }
        
        .step-item.completed {
            background: rgba(76, 175, 80, 0.2);
            border-left: 4px solid var(--police-success);
        }
        
        .step-number {
            width: 30px;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            color: #b0bec5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .step-item.active .step-number {
            background: var(--police-accent);
            color: white;
        }
        
        .step-item.completed .step-number {
            background: var(--police-success);
            color: white;
        }
        
        .step-info {
            flex: 1;
        }
        
        .step-title {
            color: white;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .step-desc {
            color: #b0bec5;
            font-size: 13px;
        }
        
        /* ====== ä¸‹ä¸€æ­¥æŒ‰é’® ====== */
        .next-step-container {
            text-align: center;
            padding: 30px;
            background: rgba(26, 35, 126, 0.5);
            border-radius: 15px;
            margin-bottom: 40px;
        }
        
        .next-step-btn {
            background: linear-gradient(135deg, var(--police-success), #2e7d32);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 0 auto 20px;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
        }
        
        .next-step-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.4);
        }
        
        .next-step-btn:disabled {
            background: linear-gradient(135deg, #666, #888);
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .next-step-hint {
            color: #bbdefb;
            font-size: 14px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* ====== åé¦ˆæ¶ˆæ¯ ====== */
        .feedback-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }
        
        .feedback-message {
            background: #1e1e1e;
            border-left: 5px solid var(--police-accent);
            padding: 20px 25px;
            border-radius: 8px;
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            animation: slideInRight 0.5s ease, fadeOut 0.5s ease 2.5s forwards;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .feedback-message.success {
            border-left-color: var(--police-success);
            background: rgba(76, 175, 80, 0.1);
        }
        
        .feedback-message.warning {
            border-left-color: var(--police-warning);
            background: rgba(255, 152, 0, 0.1);
        }
        
        .feedback-message.error {
            border-left-color: var(--police-alert);
            background: rgba(244, 67, 54, 0.1);
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            to { opacity: 0; }
        }
        
        /* ====== å“åº”å¼è®¾è®¡ ====== */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .police-logo {
                justify-content: center;
            }
            
            .scenario-cards {
                grid-template-columns: 1fr;
            }
            
            .scenario-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .info-panels {
                grid-template-columns: 1fr;
            }
            
            .command-input-area {
                flex-direction: column;
            }
            
            .command-buttons {
                width: 100%;
            }
            
            .cmd-btn {
                flex: 1;
                justify-content: center;
            }
            
            .quick-commands {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .feedback-container {
                left: 20px;
                right: 20px;
                max-width: none;
            }
        }
        
        /* ====== æ‰“å°ä¼˜åŒ– ====== */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .police-header, .scenario-selector, .diagnosis-tabs, 
            .command-input-area, .next-step-container {
                display: none;
            }
            
            .scenario-container.active {
                display: block;
                break-inside: avoid;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- è­¦åŠ¡å¤´éƒ¨ -->
    <header class="police-header">
        <div class="header-content">
            <div class="police-logo">
                <div class="police-logo-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="police-title">
                    <h1>è­¦åŠ¡ç½‘ç»œæ•…éšœè¯Šæ–­æ¨¡æ‹Ÿç³»ç»Ÿ</h1>
                    <p class="subtitle">ä¸­é«˜çº§ä»»åŠ¡ - å®æˆ˜åŒ–æ•…éšœæ’æŸ¥è®­ç»ƒå¹³å°</p>
                </div>
            </div>
            <div class="mission-badge">
                <i class="fas fa-bullseye"></i> æŒ‘æˆ˜ä»»åŠ¡
            </div>
        </div>
    </header>
    
    <!-- åœºæ™¯é€‰æ‹©å™¨ -->
    <section class="scenario-selector">
        <h2><i class="fas fa-map-signs"></i> è¯·é€‰æ‹©è¯Šæ–­åœºæ™¯</h2>
        <div class="scenario-cards">
            <!-- åœºæ™¯1 -->
            <div class="scenario-card active" onclick="loadScenario(1)">
                <div class="scenario-icon">
                    <i class="fas fa-file-upload"></i>
                </div>
                <h3>åœºæ™¯ä¸€ï¼šç´§æ€¥æŠ¥å‘Šæ— æ³•ä¸Šä¼ </h3>
                <p>å¤œé—´å€¼ç­æ—¶æ®µï¼Œæ¡ˆä»¶æŠ¥å‘Šæ— æ³•ä¸Šä¼ è‡³æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿï¼Œæ¶‰åŠç½‘ç»œè¿é€šæ€§ã€é˜²ç«å¢™é…ç½®ã€ä»£ç†è®¾ç½®ç­‰å¤šé‡é—®é¢˜æ’æŸ¥ã€‚</p>
                <div style="margin-top: 15px; color: #4caf50; font-size: 12px;">
                    <i class="fas fa-star"></i> æ¨èï¼šç½‘ç»œåŸºç¡€æ‰å®è€…
                </div>
            </div>
            
            <!-- åœºæ™¯2 -->
            <div class="scenario-card" onclick="loadScenario(2)">
                <div class="scenario-icon">
                    <i class="fas fa-video"></i>
                </div>
                <h3>åœºæ™¯äºŒï¼šè§†é¢‘ç›‘æ§ä¸­æ–­</h3>
                <p>æŒ‡æŒ¥ä¸­å¿ƒå¤§å±æ˜¾ç¤ºå¤šä¸ªæ‘„åƒå¤´ç¦»çº¿ï¼Œæ¶‰åŠç½‘ç»œè®¾å¤‡æ•…éšœã€VLANé…ç½®ã€ç¯è·¯æ£€æµ‹ç­‰å¤æ‚ç½‘ç»œé—®é¢˜è¯Šæ–­ã€‚</p>
                <div style="margin-top: 15px; color: #ff9800; font-size: 12px;">
                    <i class="fas fa-brain"></i> æŒ‘æˆ˜ï¼šç½‘ç»œé…ç½®ç²¾é€šè€…
                </div>
            </div>
            
            <!-- åœºæ™¯3 -->
            <div class="scenario-card" onclick="loadScenario(3)">
                <div class="scenario-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h3>åœºæ™¯ä¸‰ï¼šè­¦åŠ¡é€šæ— æ³•è”ç½‘</h3>
                <p>æ‰§å‹¤ç‚¹æ‰€æœ‰è­¦åŠ¡é€šè®¾å¤‡æ— æ³•è¿æ¥ç§»åŠ¨ç½‘ç»œï¼Œæ¶‰åŠç§»åŠ¨ç½‘ç»œé…ç½®ã€è¿è¥å•†åè°ƒã€åº”æ€¥æ–¹æ¡ˆåˆ¶å®šç­‰ç»¼åˆèƒ½åŠ›è€ƒéªŒã€‚</p>
                <div style="margin-top: 15px; color: #2196f3; font-size: 12px;">
                    <i class="fas fa-bolt"></i> ç»¼åˆï¼šåº”æ€¥å¤„ç†èƒ½åŠ›è€…
                </div>
            </div>
        </div>
    </section>
    
    <!-- åœºæ™¯1å®¹å™¨ -->
    <section id="scenario1" class="scenario-container active">
        <!-- åœºæ™¯ä¿¡æ¯å¤´ -->
        <div class="scenario-info">
            <div class="scenario-header">
                <div class="scenario-name">
                    <h2><i class="fas fa-file-upload"></i> ç´§æ€¥æŠ¥å‘Šæ— æ³•ä¸Šä¼ </h2>
                    <span class="scenario-tag">ç½‘ç»œè¿é€šæ€§æ•…éšœ</span>
                </div>
                <div class="scenario-progress">
                    <div class="progress-steps">
                        <div class="step-dot completed" id="step1-dot"></div>
                        <div class="step-dot" id="step2-dot"></div>
                        <div class="step-dot" id="step3-dot"></div>
                        <div class="step-dot" id="step4-dot"></div>
                    </div>
                    <div class="time-pressure">
                        <i class="fas fa-clock"></i>
                        <span id="time-remaining">28:00</span> å‰©ä½™æ—¶é—´
                    </div>
                </div>
            </div>
            <p style="color: #bbdefb; margin-top: 10px;">æ·±å¤œå€¼ç­ç´§æ€¥ä»»åŠ¡ï¼Œ30åˆ†é’Ÿå†…å¿…é¡»å®Œæˆæ¡ˆä»¶æŠ¥å‘Šä¸Šä¼ ï¼Œç½‘ç»œè¿æ¥å´å‡ºç°é—®é¢˜...</p>
        </div>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <div class="scenario-content">
            <!-- å½“å‰æƒ…å†µ -->
            <div class="situation-box">
                <div class="situation-header">
                    <i class="fas fa-exclamation-triangle situation-icon"></i>
                    <h3 id="step-title">ç¬¬ä¸€æ­¥ï¼šåŸºç¡€ç½‘ç»œè¿é€šæ€§è¯Šæ–­</h3>
                </div>
                <div class="situation-details" id="step-description">
                    <p><strong>ğŸ• æ—¶é—´ï¼š</strong>2025å¹´3æœˆ15æ—¥ 22:30ï¼ˆå¤œé—´å€¼ç­æ—¶æ®µï¼‰</p>
                    <p><strong>ğŸ“ åœ°ç‚¹ï¼š</strong>XXæ´¾å‡ºæ‰€å€¼ç­å®¤</p>
                    <p><strong>ğŸ“ ä»»åŠ¡ï¼š</strong>æ‚¨åˆšåˆšå¤„ç†å®Œä¸€èµ·ç´§æ€¥æ¡ˆä»¶ï¼Œéœ€è¦ç«‹å³å°†ã€Šæ¡ˆæƒ…æŠ¥å‘Šã€‹ä¸Šä¼ è‡³å¸‚å±€æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿã€‚</p>
                    <p><strong>âŒ é—®é¢˜ï¼š</strong>æŠ¥å‘Šå¡«å†™å®Œæˆåï¼Œç‚¹å‡»"ä¸Šä¼ "æŒ‰é’®ï¼Œç³»ç»Ÿæç¤º"ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®"ã€‚</p>
                    <p><strong>ğŸ”„ å·²å°è¯•ï¼š</strong>é‡å¯æµè§ˆå™¨ã€é‡å¯ç”µè„‘ï¼Œé—®é¢˜ä¾æ—§ã€‚</p>
                    <div class="urgency-badge">
                        <i class="fas fa-bell"></i> ä¸Šçº§ä¸¥ä»¤ï¼š30åˆ†é’Ÿå†…å¿…é¡»ä¸Šä¼ å®Œæ¯•ï¼
                    </div>
                </div>
            </div>
            
            <!-- è¯Šæ–­å·¥å…·åŒº -->
            <div class="diagnosis-area">
                <!-- æ ‡ç­¾é¡µ -->
                <div class="diagnosis-tabs">
                    <button class="diagnosis-tab active" onclick="showTab('terminal')">
                        <i class="fas fa-terminal"></i> å‘½ä»¤ç»ˆç«¯
                    </button>
                    <button class="diagnosis-tab" onclick="showTab('tools')">
                        <i class="fas fa-tools"></i> è¯Šæ–­å·¥å…·
                    </button>
                    <button class="diagnosis-tab" onclick="showTab('notes')">
                        <i class="fas fa-sticky-note"></i> è¯Šæ–­è®°å½•
                    </button>
                </div>
                
                <!-- ç»ˆç«¯æ ‡ç­¾é¡µ -->
                <div id="terminal-tab" class="tab-content active">
                    <div class="terminal-container">
                        <div class="terminal-header">
                            <div class="terminal-title">
                                <i class="fas fa-network-wired"></i> è­¦åŠ¡ç½‘ç»œè¯Šæ–­ç»ˆç«¯
                            </div>
                            <div class="terminal-controls">
                                <div class="terminal-control control-close"></div>
                                <div class="terminal-control control-minimize"></div>
                                <div class="terminal-control control-maximize"></div>
                            </div>
                        </div>
                        
                        <div class="terminal-output" id="terminal-output">
                            <div class="terminal-line">
                                <span class="terminal-prompt">C:\PoliceNet\Diagnosis></span>
                                <span class="terminal-command">systeminfo</span>
                            </div>
                            <div class="terminal-line terminal-output-text">
è­¦åŠ¡ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ v2.5 | å½“å‰æ—¶é—´: 22:30:15
ç³»ç»ŸçŠ¶æ€: æ£€æµ‹åˆ°ç½‘ç»œè¿æ¥å¼‚å¸¸
å»ºè®®æ“ä½œ: å¼€å§‹åŸºç¡€ç½‘ç»œè¯Šæ–­
================================
è¾“å…¥ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤
                            </div>
                        </div>
                        
                        <div class="command-input-area">
                            <input type="text" class="command-input" id="command-input" 
                                   placeholder="è¾“å…¥è¯Šæ–­å‘½ä»¤ (å¦‚: ping, ipconfig, tracert...)">
                            <div class="command-buttons">
                                <button class="cmd-btn" onclick="executeCommand()">
                                    <i class="fas fa-play"></i> æ‰§è¡Œ
                                </button>
                                <button class="cmd-btn secondary" onclick="clearTerminal()">
                                    <i class="fas fa-broom"></i> æ¸…å±
                                </button>
                                <button class="cmd-btn secondary" onclick="showHelp()">
                                    <i class="fas fa-question-circle"></i> å¸®åŠ©
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å¿«æ·å‘½ä»¤ -->
                    <div class="quick-commands">
                        <div class="quick-cmd" onclick="runQuickCommand('ping 127.0.0.1')">ping 127.0.0.1</div>
                        <div class="quick-cmd" onclick="runQuickCommand('ipconfig')">ipconfig</div>
                        <div class="quick-cmd" onclick="runQuickCommand('ping 10.10.1.1')">ping ç½‘å…³</div>
                        <div class="quick-cmd" onclick="runQuickCommand('ping www.baidu.com')">æµ‹è¯•å¤–ç½‘</div>
                        <div class="quick-cmd" onclick="runQuickCommand('tracert 10.10.100.50')">è¿½è¸ªæœåŠ¡å™¨</div>
                        <div class="quick-cmd" onclick="runQuickCommand('nslookup case.gov.cn')">DNSæŸ¥è¯¢</div>
                        <div class="quick-cmd" onclick="runQuickCommand('telnet 10.10.100.50 8443')">æµ‹è¯•ç«¯å£</div>
                        <div class="quick-cmd" onclick="runQuickCommand('netsh advfirewall show rule name=all')">æŸ¥çœ‹é˜²ç«å¢™</div>
                    </div>
                </div>
                
                <!-- å·¥å…·æ ‡ç­¾é¡µ -->
                <div id="tools-tab" class="tab-content">
                    <h3 style="color: white; margin-bottom: 20px;">ç½‘ç»œè¯Šæ–­å·¥å…·ç®±</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: rgba(33, 150, 243, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(33, 150, 243, 0.3);">
                            <h4><i class="fas fa-sitemap" style="color: #2196f3;"></i> ç½‘ç»œè¿é€šæ€§æµ‹è¯•</h4>
                            <p style="color: #bbdefb; font-size: 14px; margin: 10px 0;">ä¸€é”®æµ‹è¯•åŸºç¡€ç½‘ç»œè¿é€šæ€§</p>
                            <button onclick="runTool('connectivity')" style="width: 100%; padding: 10px; background: #2196f3; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                å¼€å§‹æµ‹è¯•
                            </button>
                        </div>
                        
                        <div style="background: rgba(255, 152, 0, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(255, 152, 0, 0.3);">
                            <h4><i class="fas fa-shield-alt" style="color: #ff9800;"></i> é˜²ç«å¢™æ£€æŸ¥</h4>
                            <p style="color: #ffccbc; font-size: 14px; margin: 10px 0;">æ£€æŸ¥é˜²ç«å¢™è§„åˆ™å’Œé…ç½®</p>
                            <button onclick="runTool('firewall')" style="width: 100%; padding: 10px; background: #ff9800; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ£€æŸ¥è®¾ç½®
                            </button>
                        </div>
                        
                        <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(76, 175, 80, 0.3);">
                            <h4><i class="fas fa-search" style="color: #4caf50;"></i> ç«¯å£æ‰«æ</h4>
                            <p style="color: #c8e6c9; font-size: 14px; margin: 10px 0;">æ‰«æç›®æ ‡æœåŠ¡å™¨çš„å¼€æ”¾ç«¯å£</p>
                            <button onclick="runTool('portscan')" style="width: 100%; padding: 10px; background: #4caf50; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ‰«æç«¯å£
                            </button>
                        </div>
                        
                        <div style="background: rgba(156, 39, 176, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(156, 39, 176, 0.3);">
                            <h4><i class="fas fa-bug" style="color: #9c27b0;"></i> ä»£ç†æ£€æµ‹</h4>
                            <p style="color: #e1bee7; font-size: 14px; margin: 10px 0;">æ£€æµ‹ä»£ç†æœåŠ¡å™¨çŠ¶æ€å’Œé…ç½®</p>
                            <button onclick="runTool('proxy')" style="width: 100%; padding: 10px; background: #9c27b0; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ£€æµ‹ä»£ç†
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- è®°å½•æ ‡ç­¾é¡µ -->
                <div id="notes-tab" class="tab-content">
                    <h3 style="color: white; margin-bottom: 20px;">è¯Šæ–­è®°å½•</h3>
                    <textarea id="notes-textarea" style="width: 100%; height: 300px; padding: 20px; background: rgba(0, 0, 0, 0.3); color: white; border: 1px solid #444; border-radius: 8px; font-family: inherit; font-size: 14px; line-height: 1.6; resize: vertical;" placeholder="åœ¨æ­¤è®°å½•æ‚¨çš„è¯Šæ–­è¿‡ç¨‹å’Œå‘ç°...">
=== è­¦åŠ¡ç½‘ç»œè¯Šæ–­è®°å½• ===
åœºæ™¯ï¼šç´§æ€¥æŠ¥å‘Šæ— æ³•ä¸Šä¼ 
æ—¶é—´ï¼š2025-03-15 22:30
è¯Šæ–­äººï¼šå­¦å‘˜

å·²å‘ç°çš„é—®é¢˜ï¼š
1. 
2. 
3. 

å·²å°è¯•çš„è§£å†³æ–¹æ¡ˆï¼š
1. 
2. 
3. 

æ ¹æœ¬åŸå› åˆ†æï¼š

å»ºè®®è§£å†³æ–¹æ¡ˆï¼š

å¤‡æ³¨ï¼š
                    </textarea>
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="cmd-btn" onclick="saveNotes()" style="flex: 1;">
                            <i class="fas fa-save"></i> ä¿å­˜è®°å½•
                        </button>
                        <button class="cmd-btn secondary" onclick="exportNotes()" style="flex: 1;">
                            <i class="fas fa-download"></i> å¯¼å‡ºæŠ¥å‘Š
                        </button>
                        <button class="cmd-btn secondary" onclick="printNotes()" style="flex: 1;">
                            <i class="fas fa-print"></i> æ‰“å°è®°å½•
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- ä¿¡æ¯é¢æ¿ -->
            <div class="info-panels">
                <!-- çº¿ç´¢é¢æ¿ -->
                <div class="info-panel">
                    <h3><i class="fas fa-lightbulb"></i> çº¿ç´¢ä¸æç¤º</h3>
                    <ul class="clue-list" id="clue-list">
                        <li class="clue-item new">é¦–å…ˆæµ‹è¯•æœ¬åœ°ç½‘ç»œè¿é€šæ€§ (ping 127.0.0.1)</li>
                        <li class="clue-item">æ£€æŸ¥ç½‘å…³è¿æ¥çŠ¶æ€ (ping ç½‘å…³åœ°å€)</li>
                        <li class="clue-item">æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿä½¿ç”¨8443ç«¯å£</li>
                        <li class="clue-item">å…¬å®‰å†…ç½‘æœ‰ç‹¬ç«‹çš„DNSæœåŠ¡å™¨</li>
                        <li class="clue-item">æ£€æŸ¥Windowsé˜²ç«å¢™å‡ºç«™è§„åˆ™</li>
                        <li class="clue-item">ä»£ç†æœåŠ¡å™¨å¯èƒ½å½±å“ä¸Šä¼ </li>
                    </ul>
                </div>
                
                <!-- æ­¥éª¤è·Ÿè¸ª -->
                <div class="info-panel">
                    <h3><i class="fas fa-tasks"></i> è¯Šæ–­æ­¥éª¤</h3>
                    <div class="step-tracker" id="step-tracker">
                        <!-- æ­¥éª¤ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <!-- å¾—åˆ†é¢æ¿ -->
                <div class="info-panel">
                    <h3><i class="fas fa-medal"></i> è¯Šæ–­å¾—åˆ†</h3>
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 48px; font-weight: bold; color: #4caf50; margin-bottom: 10px;" id="score-display">100</div>
                        <div style="color: #bbdefb; font-size: 18px;">è¯Šæ–­ç§¯åˆ†</div>
                        
                        <div style="margin-top: 25px; background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #b0bec5;">å‘ç°çº¿ç´¢</span>
                                <span style="color: #4caf50;" id="clue-count">1/6</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #b0bec5;">å®Œæˆæ­¥éª¤</span>
                                <span style="color: #4caf50;" id="step-count">1/4</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #b0bec5;">å‰©ä½™æ—¶é—´</span>
                                <span style="color: #ff9800;" id="time-score">28:00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ä¸‹ä¸€æ­¥æŒ‰é’® -->
            <div class="next-step-container">
                <button class="next-step-btn" id="next-step-btn" onclick="advanceStep()" disabled>
                    <i class="fas fa-forward"></i> è¿›å…¥ä¸‹ä¸€æ­¥æ•…éšœè¯Šæ–­
                </button>
                <p class="next-step-hint" id="next-step-hint">
                    å®Œæˆå½“å‰æ­¥éª¤çš„æ‰€æœ‰è¯Šæ–­ä»»åŠ¡åè§£é”ä¸‹ä¸€æ­¥
                </p>
            </div>
        </div>
    </section>
    
    <!-- åœºæ™¯2å®¹å™¨ (ç»“æ„ç›¸åŒï¼Œå†…å®¹ä¸åŒ) -->
    <section id="scenario2" class="scenario-container">
        <div class="scenario-info">
            <div class="scenario-header">
                <div class="scenario-name">
                    <h2><i class="fas fa-video"></i> è§†é¢‘ç›‘æ§ä¸­æ–­</h2>
                    <span class="scenario-tag">ç½‘ç»œè®¾å¤‡æ•…éšœ</span>
                </div>
                <div class="scenario-progress">
                    <div class="progress-steps">
                        <div class="step-dot completed" id="scenario2-step1-dot"></div>
                        <div class="step-dot" id="scenario2-step2-dot"></div>
                        <div class="step-dot" id="scenario2-step3-dot"></div>
                        <div class="step-dot" id="scenario2-step4-dot"></div>
                    </div>
                    <div class="time-pressure">
                        <i class="fas fa-clock"></i>
                        <span id="scenario2-time-remaining">45:00</span> å‰©ä½™æ—¶é—´
                    </div>
                </div>
            </div>
            <p style="color: #bbdefb; margin-top: 10px;">æŒ‡æŒ¥ä¸­å¿ƒå¤§å±æ˜¾ç¤ºå¤šä¸ªé‡ç‚¹åŒºåŸŸæ‘„åƒå¤´ç¦»çº¿ï¼Œæ¶‰åŠå…¬å…±å®‰å…¨ç›‘æ§...</p>
        </div>
    </section>
    
    <!-- åœºæ™¯3å®¹å™¨ (ç»“æ„ç›¸åŒï¼Œå†…å®¹ä¸åŒ) -->
    <section id="scenario3" class="scenario-container">
        <div class="scenario-info">
            <div class="scenario-header">
                <div class="scenario-name">
                    <h2><i class="fas fa-mobile-alt"></i> è­¦åŠ¡é€šæ— æ³•è”ç½‘</h2>
                    <span class="scenario-tag">ç§»åŠ¨ç½‘ç»œæ•…éšœ</span>
                </div>
                <div class="scenario-progress">
                    <div class="progress-steps">
                        <div class="step-dot completed" id="scenario3-step1-dot"></div>
                        <div class="step-dot" id="scenario3-step2-dot"></div>
                        <div class="step-dot" id="scenario3-step3-dot"></div>
                        <div class="step-dot" id="scenario3-step4-dot"></div>
                    </div>
                    <div class="time-pressure">
                        <i class="fas fa-clock"></i>
                        <span id="scenario3-time-remaining">35:00</span> å‰©ä½™æ—¶é—´
                    </div>
                </div>
            </div>
            <p style="color: #bbdefb; margin-top: 10px;">æ—©é«˜å³°æ‰§å‹¤ç‚¹æ‰€æœ‰è­¦åŠ¡é€šè®¾å¤‡æ— æ³•è¿æ¥ç§»åŠ¨ç½‘ç»œï¼Œå½±å“äº¤é€šç–å¯¼å’Œè½¦è¾†æ£€æŸ¥...</p>
        </div>
    </section>
    
    <!-- åé¦ˆæ¶ˆæ¯å®¹å™¨ -->
    <div class="feedback-container" id="feedback-container"></div>

    <!-- JavaScriptä»£ç  -->
    <script>
        // ====== å…¨å±€å˜é‡å’Œé…ç½® ======
        let currentScenario = 1;
        let currentStep = 1;
        let totalSteps = 4;
        let score = 100;
        let discoveredClues = new Set(['é¦–å…ˆæµ‹è¯•æœ¬åœ°ç½‘ç»œè¿é€šæ€§ (ping 127.0.0.1)']);
        let completedSteps = new Set([1]);
        let timeRemaining = 28 * 60; // 28åˆ†é’Ÿï¼Œå•ä½ç§’
        let timerInterval;
        
        // åœºæ™¯æ•°æ®é…ç½®
        const scenarios = {
            1: {
                name: "ç´§æ€¥æŠ¥å‘Šæ— æ³•ä¸Šä¼ ",
                timeLimit: 28, // åˆ†é’Ÿ
                steps: {
                    1: {
                        title: "ç¬¬ä¸€æ­¥ï¼šåŸºç¡€ç½‘ç»œè¿é€šæ€§è¯Šæ–­",
                        description: `<p><strong>ğŸ• æ—¶é—´ï¼š</strong>2025å¹´3æœˆ15æ—¥ 22:30ï¼ˆå¤œé—´å€¼ç­æ—¶æ®µï¼‰</p>
                                    <p><strong>ğŸ“ åœ°ç‚¹ï¼š</strong>XXæ´¾å‡ºæ‰€å€¼ç­å®¤</p>
                                    <p><strong>ğŸ“ ä»»åŠ¡ï¼š</strong>æ‚¨åˆšåˆšå¤„ç†å®Œä¸€èµ·ç´§æ€¥æ¡ˆä»¶ï¼Œéœ€è¦ç«‹å³å°†ã€Šæ¡ˆæƒ…æŠ¥å‘Šã€‹ä¸Šä¼ è‡³å¸‚å±€æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿã€‚</p>
                                    <p><strong>âŒ é—®é¢˜ï¼š</strong>æŠ¥å‘Šå¡«å†™å®Œæˆåï¼Œç‚¹å‡»"ä¸Šä¼ "æŒ‰é’®ï¼Œç³»ç»Ÿæç¤º"ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®"ã€‚</p>
                                    <p><strong>ğŸ”„ å·²å°è¯•ï¼š</strong>é‡å¯æµè§ˆå™¨ã€é‡å¯ç”µè„‘ï¼Œé—®é¢˜ä¾æ—§ã€‚</p>
                                    <div class="urgency-badge">
                                        <i class="fas fa-bell"></i> ä¸Šçº§ä¸¥ä»¤ï¼š30åˆ†é’Ÿå†…å¿…é¡»ä¸Šä¼ å®Œæ¯•ï¼
                                    </div>`,
                        requiredCommands: ['ping 127.0.0.1', 'ping 10.10.1.1', 'ipconfig'],
                        nextCondition: "å‘ç°ç½‘å…³å¯ä»¥pingé€šï¼Œä½†æœåŠ¡å™¨æ— æ³•è®¿é—®"
                    },
                    2: {
                        title: "ç¬¬äºŒæ­¥ï¼šæœåŠ¡å™¨è¿é€šæ€§ä¸é˜²ç«å¢™æ£€æŸ¥",
                        description: `<p><strong>ğŸ” æ–°å‘ç°ï¼š</strong>åŸºç¡€ç½‘ç»œæ­£å¸¸ï¼Œä½†æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿ(10.10.100.50:8443)æ— æ³•è¿æ¥ã€‚</p>
                                    <p><strong>âš ï¸ å‡çº§é—®é¢˜ï¼š</strong>ç³»ç»Ÿæ—¥å¿—æ˜¾ç¤º"è¿æ¥è¢«æ‹’ç»"ï¼Œå¯èƒ½æ˜¯é˜²ç«å¢™æˆ–å®‰å…¨è½¯ä»¶é˜»æŒ¡ã€‚</p>
                                    <p><strong>ğŸ¯ è¯Šæ–­é‡ç‚¹ï¼š</strong>æ£€æŸ¥ç‰¹å®šç«¯å£çš„è¿é€šæ€§ã€é˜²ç«å¢™è§„åˆ™ã€å®‰å…¨è½¯ä»¶è®¾ç½®ã€‚</p>
                                    <p><strong>â±ï¸ æ—¶é—´å‹åŠ›ï¼š</strong>å‰©ä½™25åˆ†é’Ÿï¼Œå¿…é¡»å¿«é€Ÿå®šä½é—®é¢˜ã€‚</p>`,
                        requiredCommands: ['telnet 10.10.100.50 8443', 'netsh advfirewall show rule'],
                        nextCondition: "å‘ç°é˜²ç«å¢™é˜»æŒ¡äº†8443ç«¯å£"
                    },
                    3: {
                        title: "ç¬¬ä¸‰æ­¥ï¼šåº”ç”¨å±‚ä¸ä»£ç†é—®é¢˜æ’æŸ¥",
                        description: `<p><strong>âœ… è¿›å±•ï¼š</strong>è§£å†³äº†é˜²ç«å¢™é—®é¢˜ï¼Œä½†ä¸Šä¼ ä»ç„¶å¤±è´¥ã€‚</p>
                                    <p><strong>ğŸ”„ æ–°é—®é¢˜ï¼š</strong>ä¸Šä¼ æ–‡ä»¶å¡åœ¨0%ï¼Œè¿›åº¦æ¡ä¸åŠ¨ï¼Œå¯èƒ½æ˜¯ä»£ç†æˆ–DNSé—®é¢˜ã€‚</p>
                                    <p><strong>ğŸ”§ è¯Šæ–­ä»»åŠ¡ï¼š</strong>æ£€æŸ¥ä»£ç†è®¾ç½®ã€DNSè§£æã€æµè§ˆå™¨é…ç½®ã€ç³»ç»ŸæœåŠ¡ã€‚</p>
                                    <p><strong>âš ï¸ æ³¨æ„ï¼š</strong>å…¬å®‰ç³»ç»Ÿå¯èƒ½æœ‰ç‰¹æ®Šçš„ä»£ç†å’ŒDNSé…ç½®ã€‚</p>`,
                        requiredCommands: ['nslookup case.gov.cn', 'proxycfg', 'ipconfig /flushdns'],
                        nextCondition: "å‘ç°ä»£ç†æœåŠ¡å™¨è®¾ç½®é”™è¯¯ä¸”æ— å“åº”"
                    },
                    4: {
                        title: "ç¬¬å››æ­¥ï¼šç»¼åˆè§£å†³æ–¹æ¡ˆä¸éªŒè¯",
                        description: `<p><strong>ğŸ“Š æœ€ç»ˆè¯Šæ–­ï¼š</strong>å¤šé‡é—®é¢˜å¯¼è‡´ä¸Šä¼ å¤±è´¥ã€‚</p>
                                    <p><strong>ğŸ” æ ¹æœ¬åŸå› ï¼š</strong>1. é˜²ç«å¢™é˜»æŒ¡ç«¯å£ 2. ä»£ç†æœåŠ¡å™¨æ•…éšœ 3. DNSç¼“å­˜é—®é¢˜</p>
                                    <p><strong>ğŸš€ æœ€ç»ˆä»»åŠ¡ï¼š</strong>å®æ–½ç»¼åˆè§£å†³æ–¹æ¡ˆï¼ŒéªŒè¯æŠ¥å‘Šä¸Šä¼ åŠŸèƒ½ã€‚</p>
                                    <p><strong>ğŸ¯ æˆåŠŸæ ‡å‡†ï¼š</strong>æˆåŠŸä¸Šä¼ æµ‹è¯•æ–‡ä»¶ï¼Œç³»ç»Ÿæ˜¾ç¤º"ä¸Šä¼ æˆåŠŸ"ã€‚</p>
                                    <p><strong>â° å‰©ä½™æ—¶é—´ï¼š</strong>ä»…å‰©8åˆ†é’Ÿï¼</p>`,
                        requiredCommands: ['netsh advfirewall add rule', 'ç¦ç”¨ä»£ç†', 'æµ‹è¯•ä¸Šä¼ '],
                        nextCondition: "æŠ¥å‘ŠæˆåŠŸä¸Šä¼ è‡³æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿ"
                    }
                },
                clues: [
                    "é¦–å…ˆæµ‹è¯•æœ¬åœ°ç½‘ç»œè¿é€šæ€§ (ping 127.0.0.1)",
                    "æ£€æŸ¥ç½‘å…³è¿æ¥çŠ¶æ€ (ping ç½‘å…³åœ°å€)",
                    "æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿä½¿ç”¨8443ç«¯å£",
                    "å…¬å®‰å†…ç½‘æœ‰ç‹¬ç«‹çš„DNSæœåŠ¡å™¨",
                    "æ£€æŸ¥Windowsé˜²ç«å¢™å‡ºç«™è§„åˆ™",
                    "ä»£ç†æœåŠ¡å™¨å¯èƒ½å½±å“ä¸Šä¼ ",
                    "é˜²ç«å¢™è§„åˆ™åç§°: 'é˜»æ­¢æ¡ˆä»¶ç³»ç»Ÿç«¯å£'",
                    "ä»£ç†æœåŠ¡å™¨åœ°å€: proxy.police.gov.cn:8080",
                    "æ¡ˆä»¶ç³»ç»ŸæœåŠ¡å™¨IP: 10.10.100.50",
                    "éœ€è¦æ·»åŠ é˜²ç«å¢™ä¾‹å¤–è§„åˆ™"
                ]
            },
            2: {
                name: "è§†é¢‘ç›‘æ§ä¸­æ–­",
                timeLimit: 45,
                steps: {
                    1: { title: "ç¬¬ä¸€æ­¥ï¼šæ‘„åƒå¤´ç¦»çº¿æ£€æµ‹", description: "..." },
                    2: { title: "ç¬¬äºŒæ­¥ï¼šäº¤æ¢æœºé—®é¢˜æ’æŸ¥", description: "..." },
                    3: { title: "ç¬¬ä¸‰æ­¥ï¼šç½‘ç»œç¯è·¯æ£€æµ‹", description: "..." },
                    4: { title: "ç¬¬å››æ­¥ï¼šåº”æ€¥æ–¹æ¡ˆå®æ–½", description: "..." }
                }
            },
            3: {
                name: "è­¦åŠ¡é€šæ— æ³•è”ç½‘",
                timeLimit: 35,
                steps: {
                    1: { title: "ç¬¬ä¸€æ­¥ï¼šè®¾å¤‡åŸºç¡€æ£€æŸ¥", description: "..." },
                    2: { title: "ç¬¬äºŒæ­¥ï¼šç½‘ç»œé…ç½®è¯Šæ–­", description: "..." },
                    3: { title: "ç¬¬ä¸‰æ­¥ï¼šè¿è¥å•†é—®é¢˜æ’æŸ¥", description: "..." },
                    4: { title: "ç¬¬å››æ­¥ï¼šåº”æ€¥æ–¹æ¡ˆå®æ–½", description: "..." }
                }
            }
        };
        
        // ====== åˆå§‹åŒ–å‡½æ•° ======
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–åœºæ™¯1
            loadScenario(1);
            
            // ç»‘å®šå›è½¦é”®æ‰§è¡Œå‘½ä»¤
            document.getElementById('command-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    executeCommand();
                }
            });
            
            // å¼€å§‹è®¡æ—¶å™¨
            startTimer();
        });
        
        // ====== åœºæ™¯ç®¡ç†å‡½æ•° ======
        function loadScenario(scenarioId) {
            currentScenario = scenarioId;
            currentStep = 1;
            score = 100;
            discoveredClues.clear();
            discoveredClues.add(scenarios[scenarioId].clues[0]);
            completedSteps.clear();
            completedSteps.add(1);
            
            // æ›´æ–°åœºæ™¯é€‰æ‹©å™¨
            document.querySelectorAll('.scenario-card').forEach((card, index) => {
                card.classList.toggle('active', index === scenarioId - 1);
            });
            
            // æ˜¾ç¤ºå¯¹åº”åœºæ™¯ï¼Œéšè—å…¶ä»–
            document.querySelectorAll('.scenario-container').forEach(container => {
                container.classList.remove('active');
            });
            document.getElementById(`scenario${scenarioId}`).classList.add('active');
            
            // é‡ç½®æ—¶é—´
            timeRemaining = scenarios[scenarioId].timeLimit * 60;
            updateTimeDisplay();
            
            // åŠ è½½ç¬¬ä¸€æ­¥
            loadStep(1);
            
            // æ›´æ–°ç•Œé¢
            updateClueList();
            updateStepTracker();
            updateScoreDisplay();
            updateProgressDots();
            updateNextStepButton();
            
            // æ¸…ç©ºç»ˆç«¯
            clearTerminal();
            addTerminalOutput(`è­¦åŠ¡ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ v2.5\nåœºæ™¯åŠ è½½: ${scenarios[scenarioId].name}\nå¼€å§‹æ—¶é—´: ${new Date().toLocaleTimeString()}\n==============================\n`, 'output');
            
            // æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
            showFeedback(`åœºæ™¯åŠ è½½æˆåŠŸ: ${scenarios[scenarioId].name}`, 'success');
        }
        
        function loadStep(stepNumber) {
            currentStep = stepNumber;
            const scenario = scenarios[currentScenario];
            const step = scenario.steps[stepNumber];
            
            // æ›´æ–°ç•Œé¢
            document.getElementById('step-title').textContent = step.title;
            document.getElementById('step-description').innerHTML = step.description;
            
            // æ›´æ–°æ­¥éª¤è·Ÿè¸ªå™¨
            updateStepTracker();
            
            // æ›´æ–°è¿›åº¦ç‚¹
            updateProgressDots();
            
            // æ·»åŠ æ–°çš„çº¿ç´¢æç¤º
            if (stepNumber > 1) {
                const newClueIndex = stepNumber;
                if (scenario.clues[newClueIndex]) {
                    addClue(scenario.clues[newClueIndex], true);
                }
            }
            
            // æ›´æ–°ç»ˆç«¯æç¤º
            addTerminalOutput(`\n=== æ­¥éª¤ ${stepNumber}: ${step.title} ===\n${step.description.replace(/<[^>]*>/g, '').substring(0, 150)}...\n`, 'output');
            addTerminalOutput(`å»ºè®®å‘½ä»¤: ${step.requiredCommands.join(', ')}\n`, 'success');
            
            // æ›´æ–°ä¸‹ä¸€æ­¥æŒ‰é’®
            updateNextStepButton();
            
            showFeedback(`è¿›å…¥æ­¥éª¤ ${stepNumber}: ${step.title}`, 'success');
        }
        
        // ====== ç»ˆç«¯å‘½ä»¤å¤„ç† ======
        function executeCommand() {
            const input = document.getElementById('command-input');
            const command = input.value.trim();
            
            if (!command) {
                showFeedback('è¯·è¾“å…¥å‘½ä»¤', 'warning');
                return;
            }
            
            // æ˜¾ç¤ºå‘½ä»¤
            addTerminalOutput(`C:\\PoliceNet\\Diagnosis> ${command}`, 'command');
            
            // å¤„ç†å‘½ä»¤
            const response = processCommand(command);
            addTerminalOutput(response.output, response.type);
            
            // æ‰§è¡Œå‘½ä»¤æ•ˆæœ
            if (response.effect) {
                response.effect();
            }
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            input.value = '';
            
            // æ£€æŸ¥æ­¥éª¤å®Œæˆæ¡ä»¶
            checkStepCompletion();
        }
        
        function processCommand(command) {
            const cmd = command.toLowerCase();
            let response = {
                output: '',
                type: 'output',
                effect: null
            };
            
            // åŸºç¡€è¯Šæ–­å‘½ä»¤
            if (cmd === 'ping 127.0.0.1') {
                response.output = `æ­£åœ¨ Ping 127.0.0.1 å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:
æ¥è‡ª 127.0.0.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´<1ms TTL=128
æ¥è‡ª 127.0.0.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´<1ms TTL=128
æ¥è‡ª 127.0.0.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´<1ms TTL=128
æ¥è‡ª 127.0.0.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´<1ms TTL=128

127.0.0.1 çš„ Ping ç»Ÿè®¡ä¿¡æ¯:
    æ•°æ®åŒ…: å·²å‘é€ = 4ï¼Œå·²æ¥æ”¶ = 4ï¼Œä¸¢å¤± = 0 (0% ä¸¢å¤±)ï¼Œ
å¾€è¿”è¡Œç¨‹çš„ä¼°è®¡æ—¶é—´(ä»¥æ¯«ç§’ä¸ºå•ä½):
    æœ€çŸ­ = 0msï¼Œæœ€é•¿ = 0msï¼Œå¹³å‡ = 0ms`;
                response.effect = () => {
                    addClue('æœ¬åœ°ç½‘ç»œåè®®æ ˆå·¥ä½œæ­£å¸¸');
                    updateScore(5);
                };
            }
            else if (cmd === 'ping 10.10.1.1') {
                response.output = `æ­£åœ¨ Ping 10.10.1.1 å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:
æ¥è‡ª 10.10.1.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=2ms TTL=64
æ¥è‡ª 10.10.1.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=1ms TTL=64
æ¥è‡ª 10.10.1.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=3ms TTL=64
æ¥è‡ª 10.10.1.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=1ms TTL=64

10.10.1.1 çš„ Ping ç»Ÿè®¡ä¿¡æ¯:
    æ•°æ®åŒ…: å·²å‘é€ = 4ï¼Œå·²æ¥æ”¶ = 4ï¼Œä¸¢å¤± = 0 (0% ä¸¢å¤±)ï¼Œ
å¾€è¿”è¡Œç¨‹çš„ä¼°è®¡æ—¶é—´(ä»¥æ¯«ç§’ä¸ºå•ä½):
    æœ€çŸ­ = 1msï¼Œæœ€é•¿ = 3msï¼Œå¹³å‡ = 1ms`;
                response.effect = () => {
                    addClue('ç½‘å…³è¿æ¥æ­£å¸¸ï¼Œæœ¬åœ°ç½‘ç»œæ— é—®é¢˜');
                    updateScore(5);
                };
            }
            else if (cmd === 'ipconfig') {
                response.output = `Windows IP é…ç½®

ä»¥å¤ªç½‘é€‚é…å™¨ ä»¥å¤ªç½‘:

   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . : police.local
   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::d123:e456:f789:g012%12
   IPv4 åœ°å€ . . . . . . . . . . . . : 10.10.1.50
   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0
   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 10.10.1.1
   DHCP æœåŠ¡å™¨ . . . . . . . . . . . : 10.10.1.1
   DNS æœåŠ¡å™¨  . . . . . . . . . . . : 10.10.10.10
                                       10.10.10.11`;
                response.effect = () => {
                    addClue('IPé…ç½®æ­£å¸¸ï¼ŒDHCPå’ŒDNSå·¥ä½œæ­£å¸¸');
                    updateScore(5);
                };
            }
            else if (cmd === 'telnet 10.10.100.50 8443' && currentStep >= 2) {
                response.output = `æ­£åœ¨è¿æ¥10.10.100.50...æ— æ³•æ‰“å¼€åˆ°ä¸»æœºçš„è¿æ¥ã€‚ åœ¨ç«¯å£ 8443: è¿æ¥å¤±è´¥

è¯Šæ–­: ç«¯å£8443è¢«é˜²ç«å¢™æˆ–å®‰å…¨è½¯ä»¶é˜»æŒ¡`;
                response.type = 'error';
                response.effect = () => {
                    addClue('æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿçš„8443ç«¯å£æ— æ³•è¿æ¥', true);
                    updateScore(10);
                };
            }
            else if (cmd.includes('netsh advfirewall show rule') && currentStep >= 2) {
                response.output = `é«˜çº§å®‰å…¨ Windows é˜²ç«å¢™è§„åˆ™æŸ¥è¯¢:
================================
è§„åˆ™åç§°: é˜»æ­¢æ¡ˆä»¶ç³»ç»Ÿç«¯å£
å·²å¯ç”¨: æ˜¯
æ–¹å‘: å‡ºç«™
æ“ä½œ: é˜»æ­¢
åè®®: TCP
æœ¬åœ°ç«¯å£: ä»»æ„
è¿œç¨‹ç«¯å£: 8443
è¿œç¨‹IPåœ°å€: 10.10.100.50
é…ç½®æ–‡ä»¶: åŸŸ,ä¸“ç”¨,å…¬ç”¨
ç»„: ç³»ç»Ÿè§„åˆ™
æè¿°: è‡ªåŠ¨åˆ›å»ºçš„å‡ºç«™é˜»æŒ¡è§„åˆ™

å‘ç°å…³é”®é—®é¢˜: æ­¤è§„åˆ™é˜»æŒ¡äº†åˆ°æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿçš„è¿æ¥!`;
                response.type = 'warning';
                response.effect = () => {
                    addClue('é˜²ç«å¢™å‡ºç«™è§„åˆ™é˜»æŒ¡äº†8443ç«¯å£', true);
                    updateScore(15);
                };
            }
            else if (cmd === 'help' || cmd === '?') {
                response.output = `å¯ç”¨å‘½ä»¤:
================================
åŸºç¡€è¯Šæ–­:
  ping <ç›®æ ‡>         æµ‹è¯•ç½‘ç»œè¿é€šæ€§
  ipconfig           æ˜¾ç¤ºIPé…ç½®
  tracert <ç›®æ ‡>     è·¯ç”±è¿½è¸ª
  nslookup <åŸŸå>    DNSæŸ¥è¯¢

é«˜çº§è¯Šæ–­:
  telnet <IP> <ç«¯å£> æµ‹è¯•ç«¯å£è¿é€šæ€§
  netsh advfirewall  é˜²ç«å¢™ç®¡ç†
  proxycfg           ä»£ç†é…ç½®
  netstat -an        ç½‘ç»œè¿æ¥çŠ¶æ€

ç³»ç»Ÿå·¥å…·:
  help               æ˜¾ç¤ºæ­¤å¸®åŠ©
  clear              æ¸…å±
  status             æ˜¾ç¤ºå½“å‰çŠ¶æ€
  hint               è·å–æç¤º`;
            }
            else if (cmd === 'clear' || cmd === 'cls') {
                clearTerminal();
                return {output: '', type: 'output', effect: null};
            }
            else if (cmd === 'status') {
                response.output = `å½“å‰çŠ¶æ€:
åœºæ™¯: ${scenarios[currentScenario].name}
æ­¥éª¤: ${currentStep}/${totalSteps}
ç§¯åˆ†: ${score}
çº¿ç´¢: ${discoveredClues.size}
æ—¶é—´å‰©ä½™: ${Math.floor(timeRemaining/60)}:${(timeRemaining%60).toString().padStart(2,'0')}`;
            }
            else if (cmd === 'hint') {
                const scenario = scenarios[currentScenario];
                const availableClues = scenario.clues.filter(clue => !discoveredClues.has(clue));
                if (availableClues.length > 0) {
                    response.output = `æç¤º: ${availableClues[0]}`;
                    response.effect = () => {
                        addClue(availableClues[0]);
                        updateScore(-5); // ä½¿ç”¨æç¤ºæ‰£åˆ†
                    };
                } else {
                    response.output = 'æš‚æ— æ–°æç¤ºï¼Œè¯·ç»§ç»­æ¢ç´¢ã€‚';
                }
            }
            else {
                response.output = `'${command}' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åºæˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚\nè¾“å…¥ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤ã€‚`;
                response.type = 'error';
                response.effect = () => updateScore(-2);
            }
            
            return response;
        }
        
        function runQuickCommand(command) {
            document.getElementById('command-input').value = command;
            executeCommand();
        }
        
        function showHelp() {
            const helpText = `è­¦åŠ¡ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ - å‘½ä»¤å¸®åŠ©
================================
åŸºç¡€ç½‘ç»œè¯Šæ–­:
  ping 127.0.0.1     æµ‹è¯•æœ¬åœ°ç½‘ç»œåè®®æ ˆ
  ping 10.10.1.1     æµ‹è¯•ç½‘å…³è¿é€šæ€§
  ipconfig           æŸ¥çœ‹ç½‘ç»œé…ç½®
  ping www.baidu.com æµ‹è¯•äº’è”ç½‘è¿æ¥

æœåŠ¡å™¨è¯Šæ–­:
  tracert 10.10.100.50  è¿½è¸ªåˆ°æ¡ˆä»¶æœåŠ¡å™¨è·¯ç”±
  telnet 10.10.100.50 8443  æµ‹è¯•æ¡ˆä»¶ç³»ç»Ÿç«¯å£
  nslookup case.gov.cn  DNSè§£ææµ‹è¯•

é˜²ç«å¢™ä¸å®‰å…¨:
  netsh advfirewall show rule name=all  æŸ¥çœ‹æ‰€æœ‰é˜²ç«å¢™è§„åˆ™
  netsh advfirewall show rule name="é˜»æ­¢æ¡ˆä»¶ç³»ç»Ÿç«¯å£"
  proxycfg  æŸ¥çœ‹ä»£ç†é…ç½®

ç³»ç»Ÿå‘½ä»¤:
  help     æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
  clear    æ¸…ç©ºç»ˆç«¯å±å¹•
  status   æ˜¾ç¤ºå½“å‰è¯Šæ–­çŠ¶æ€
  hint     è·å–è¯Šæ–­æç¤º

ä½¿ç”¨æŠ€å·§:
1. æŒ‰æ­¥éª¤ä¾æ¬¡è¯Šæ–­ï¼Œä¸è¦è·³è¿‡åŸºç¡€æµ‹è¯•
2. æ³¨æ„å‘½ä»¤çš„è¾“å‡ºç»“æœï¼Œå¯»æ‰¾å¼‚å¸¸ä¿¡æ¯
3. ç»“åˆå³ä¾§çš„çº¿ç´¢æç¤ºè¿›è¡Œåˆ†æ
4. æ—¶é—´æœ‰é™ï¼Œé«˜æ•ˆè¯Šæ–­æ˜¯å…³é”®`;
            
            addTerminalOutput(helpText, 'output');
        }
        
        // ====== å·¥å…·å‡½æ•° ======
        function runTool(toolName) {
            let output = '';
            let effect = null;
            
            switch(toolName) {
                case 'connectivity':
                    output = `ç½‘ç»œè¿é€šæ€§æµ‹è¯•æŠ¥å‘Š:
================================
1. æœ¬åœ°å›ç¯æµ‹è¯•: âœ“ é€šè¿‡ (0ms)
2. ç½‘å…³è¿é€šæ€§: âœ“ é€šè¿‡ (å¹³å‡: 1ms)
3. DNSæœåŠ¡å™¨: âœ“ é€šè¿‡
4. äº’è”ç½‘è®¿é—®: âœ“ é€šè¿‡
5. æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿ: âœ— å¤±è´¥ (ç«¯å£8443æ— æ³•è¿æ¥)

ç»“è®º: åŸºç¡€ç½‘ç»œæ­£å¸¸ï¼Œä½†ç‰¹å®šæœåŠ¡ç«¯å£æ— æ³•è®¿é—®ã€‚
å»ºè®®: æ£€æŸ¥é˜²ç«å¢™å’Œä»£ç†è®¾ç½®ã€‚`;
                    effect = () => {
                        addClue('ç½‘ç»œè¿é€šæ€§æµ‹è¯•æ˜¾ç¤º8443ç«¯å£é—®é¢˜', true);
                        updateScore(10);
                    };
                    break;
                    
                case 'firewall':
                    output = `é˜²ç«å¢™æ£€æŸ¥å·¥å…·æŠ¥å‘Š:
================================
Windows Defender é˜²ç«å¢™çŠ¶æ€: å¯ç”¨
é…ç½®æ–‡ä»¶: åŸŸ/ä¸“ç”¨/å…¬ç”¨ (å…¨éƒ¨å¯ç”¨)

å‘ç°å…³é”®è§„åˆ™:
è§„åˆ™åç§°: "é˜»æ­¢æ¡ˆä»¶ç³»ç»Ÿç«¯å£"
æ–¹å‘: å‡ºç«™
æ“ä½œ: é˜»æ­¢
åè®®: TCP
è¿œç¨‹ç«¯å£: 8443
è¿œç¨‹IP: 10.10.100.50
çŠ¶æ€: å·²å¯ç”¨

é—®é¢˜: æ­¤è§„åˆ™é˜»æŒ¡äº†æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿçš„è¿æ¥!
è§£å†³æ–¹æ¡ˆ: ç¦ç”¨æ­¤è§„åˆ™æˆ–æ·»åŠ ä¾‹å¤–ã€‚`;
                    effect = () => {
                        addClue('é˜²ç«å¢™å·¥å…·ç¡®è®¤è§„åˆ™é˜»æŒ¡', true);
                        updateScore(15);
                    };
                    break;
                    
                case 'portscan':
                    output = `ç«¯å£æ‰«ææŠ¥å‘Š (ç›®æ ‡: 10.10.100.50):
================================
ç«¯å£æ‰«æä¸­... [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%

æ‰«æç»“æœ:
21/tcp   : å…³é—­     FTP
22/tcp   : å…³é—­     SSH
80/tcp   : å¼€æ”¾     HTTP (æ¬¢è¿é¡µé¢)
443/tcp  : å¼€æ”¾     HTTPS (è¯ä¹¦æœ‰æ•ˆ)
8443/tcp : è¿‡æ»¤     å¯èƒ½æ˜¯é˜²ç«å¢™é˜»æŒ¡
3389/tcp : å…³é—­     RDP

è¯¦ç»†åˆ†æ:
- 8443ç«¯å£çŠ¶æ€: FILTERED (è¿‡æ»¤)
- å¯èƒ½åŸå› : ä¸­é—´é˜²ç«å¢™ã€æœ¬åœ°é˜²ç«å¢™ã€å®‰å…¨è½¯ä»¶
- å»ºè®®: æ£€æŸ¥æœ¬åœ°å’Œç½‘ç»œé˜²ç«å¢™è®¾ç½®`;
                    effect = () => updateScore(10);
                    break;
                    
                case 'proxy':
                    output = `ä»£ç†æ£€æµ‹æŠ¥å‘Š:
================================
ç³»ç»Ÿä»£ç†è®¾ç½®æ£€æµ‹ä¸­...

æ£€æµ‹ç»“æœ:
- ä»£ç†æœåŠ¡å™¨: proxy.police.gov.cn:8080
- ä»£ç†å¯ç”¨: æ˜¯
- ä»£ç†æµ‹è¯•: âœ— è¿æ¥å¤±è´¥ (è¶…æ—¶: 10ç§’)
- ç»•è¿‡åˆ—è¡¨: *.local;10.*

é—®é¢˜åˆ†æ:
1. ä»£ç†æœåŠ¡å™¨æ— å“åº”
2. å¯èƒ½åŸå› : ä»£ç†æœåŠ¡å™¨æ•…éšœã€ç½‘ç»œé—®é¢˜ã€é…ç½®é”™è¯¯
3. å½±å“: æ‰€æœ‰HTTP/HTTPSæµé‡éƒ½ä¼šè¢«ä»£ç†æ‹¦æˆª

ç´§æ€¥è§£å†³æ–¹æ¡ˆ:
1. ä¸´æ—¶ç¦ç”¨ä»£ç†
2. ä½¿ç”¨ç›´è¿æ¨¡å¼
3. è”ç³»ç½‘ç®¡éƒ¨é—¨`;
                    effect = () => {
                        addClue('ä»£ç†æœåŠ¡å™¨æ•…éšœå¯¼è‡´ä¸Šä¼ å¤±è´¥', true);
                        updateScore(15);
                    };
                    break;
            }
            
            addTerminalOutput(`è¿è¡Œå·¥å…·: ${toolName}`, 'command');
            addTerminalOutput(output, 'output');
            
            if (effect) {
                effect();
                checkStepCompletion();
            }
            
            updateScore(5);
        }
        
        // ====== ç•Œé¢æ›´æ–°å‡½æ•° ======
        function addClue(clue, isNew = false) {
            if (!discoveredClues.has(clue)) {
                discoveredClues.add(clue);
                updateClueList();
                
                if (isNew) {
                    showFeedback(`ğŸ¯ å‘ç°æ–°çº¿ç´¢: ${clue}`, 'success');
                    updateScore(10);
                }
            }
        }
        
        function updateClueList() {
            const clueList = document.getElementById('clue-list');
            clueList.innerHTML = '';
            
            Array.from(discoveredClues).forEach((clue, index) => {
                const li = document.createElement('li');
                li.className = 'clue-item';
                if (index === discoveredClues.size - 1) {
                    li.classList.add('new');
                }
                li.textContent = clue;
                clueList.appendChild(li);
            });
            
            // æ›´æ–°çº¿ç´¢è®¡æ•°
            const totalClues = scenarios[currentScenario].clues.length;
            document.getElementById('clue-count').textContent = `${discoveredClues.size}/${totalClues}`;
        }
        
        function updateStepTracker() {
            const tracker = document.getElementById('step-tracker');
            tracker.innerHTML = '';
            
            const scenario = scenarios[currentScenario];
            
            for (let i = 1; i <= totalSteps; i++) {
                const step = scenario.steps[i];
                const stepDiv = document.createElement('div');
                stepDiv.className = 'step-item';
                
                if (completedSteps.has(i)) {
                    stepDiv.classList.add('completed');
                } else if (i === currentStep) {
                    stepDiv.classList.add('active');
                }
                
                stepDiv.innerHTML = `
                    <div class="step-number">${i}</div>
                    <div class="step-info">
                        <div class="step-title">${step.title}</div>
                        <div class="step-desc">${step.description.replace(/<[^>]*>/g, '').substring(0, 60)}...</div>
                    </div>
                `;
                
                tracker.appendChild(stepDiv);
            }
            
            // æ›´æ–°æ­¥éª¤è®¡æ•°
            document.getElementById('step-count').textContent = `${completedSteps.size}/${totalSteps}`;
        }
        
        function updateProgressDots() {
            for (let i = 1; i <= totalSteps; i++) {
                const dot = document.getElementById(`step${i}-dot`);
                if (dot) {
                    dot.classList.remove('completed', 'active');
                    if (completedSteps.has(i)) {
                        dot.classList.add('completed');
                    } else if (i === currentStep) {
                        dot.classList.add('active');
                    }
                }
            }
        }
        
        function updateScore(points) {
            score = Math.max(0, score + points);
            updateScoreDisplay();
            
            if (points > 0) {
                // æ˜¾ç¤ºåŠ åˆ†åŠ¨ç”»
                const scoreEffect = document.createElement('div');
                scoreEffect.style.cssText = `
                    position: fixed;
                    top: 80px;
                    right: 50px;
                    color: #4caf50;
                    font-size: 20px;
                    font-weight: bold;
                    animation: floatUp 1s forwards;
                    z-index: 1000;
                    pointer-events: none;
                `;
                scoreEffect.textContent = `+${points}`;
                document.body.appendChild(scoreEffect);
                
                setTimeout(() => {
                    document.body.removeChild(scoreEffect);
                }, 1000);
            }
        }
        
        function updateScoreDisplay() {
            document.getElementById('score-display').textContent = score;
        }
        
        function updateTimeDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const timeStr = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('time-remaining').textContent = timeStr;
            document.getElementById('time-score').textContent = timeStr;
            
            // æ›´æ–°è¿›åº¦æ¡é¢œè‰²
            const progress = (timeRemaining / (scenarios[currentScenario].timeLimit * 60)) * 100;
            const timeElement = document.getElementById('time-remaining');
            if (progress < 20) {
                timeElement.style.color = '#f44336';
            } else if (progress < 50) {
                timeElement.style.color = '#ff9800';
            } else {
                timeElement.style.color = '#4caf50';
            }
        }
        
        function startTimer() {
            clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                timeRemaining--;
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    showFeedback('â° æ—¶é—´åˆ°ï¼è¯Šæ–­ä»»åŠ¡å¤±è´¥', 'error');
                    updateScore(-50);
                    document.getElementById('next-step-btn').disabled = true;
                    document.getElementById('next-step-hint').textContent = 'æ—¶é—´è€—å°½ï¼Œä»»åŠ¡å¤±è´¥';
                    return;
                }
                
                updateTimeDisplay();
                
                // æ—¶é—´è­¦å‘Š
                if (timeRemaining === 5 * 60) {
                    showFeedback('âš ï¸ è­¦å‘Šï¼åªå‰©5åˆ†é’Ÿï¼', 'warning');
                } else if (timeRemaining === 60) {
                    showFeedback('ğŸš¨ ç´§æ€¥ï¼åªå‰©1åˆ†é’Ÿï¼', 'error');
                }
            }, 1000);
        }
        
        // ====== æ­¥éª¤å®Œæˆæ£€æŸ¥ ======
        function checkStepCompletion() {
            const scenario = scenarios[currentScenario];
            const step = scenario.steps[currentStep];
            
            // æ£€æŸ¥æ˜¯å¦å®Œæˆäº†è¶³å¤Ÿçš„å…³é”®å‘ç°
            let isCompleted = false;
            
            if (currentScenario === 1) {
                switch(currentStep) {
                    case 1:
                        // æ­¥éª¤1å®Œæˆæ¡ä»¶ï¼šå‘ç°ç½‘å…³æ­£å¸¸ä½†æœåŠ¡å™¨æ— æ³•è®¿é—®
                        isCompleted = discoveredClues.has('ç½‘å…³è¿æ¥æ­£å¸¸ï¼Œæœ¬åœ°ç½‘ç»œæ— é—®é¢˜') && 
                                     discoveredClues.has('æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿä½¿ç”¨8443ç«¯å£');
                        break;
                    case 2:
                        // æ­¥éª¤2å®Œæˆæ¡ä»¶ï¼šå‘ç°é˜²ç«å¢™é˜»æŒ¡
                        isCompleted = discoveredClues.has('é˜²ç«å¢™å‡ºç«™è§„åˆ™é˜»æŒ¡äº†8443ç«¯å£');
                        break;
                    case 3:
                        // æ­¥éª¤3å®Œæˆæ¡ä»¶ï¼šå‘ç°ä»£ç†é—®é¢˜
                        isCompleted = discoveredClues.has('ä»£ç†æœåŠ¡å™¨æ•…éšœå¯¼è‡´ä¸Šä¼ å¤±è´¥');
                        break;
                    case 4:
                        // æ­¥éª¤4å®Œæˆæ¡ä»¶ï¼šå®Œæˆæ‰€æœ‰å…³é”®å‘ç°
                        const requiredClues = [
                            'ç½‘å…³è¿æ¥æ­£å¸¸ï¼Œæœ¬åœ°ç½‘ç»œæ— é—®é¢˜',
                            'é˜²ç«å¢™å‡ºç«™è§„åˆ™é˜»æŒ¡äº†8443ç«¯å£',
                            'ä»£ç†æœåŠ¡å™¨æ•…éšœå¯¼è‡´ä¸Šä¼ å¤±è´¥',
                            'éœ€è¦æ·»åŠ é˜²ç«å¢™ä¾‹å¤–è§„åˆ™'
                        ];
                        isCompleted = requiredClues.every(clue => discoveredClues.has(clue));
                        break;
                }
            }
            
            if (isCompleted && !completedSteps.has(currentStep)) {
                completedSteps.add(currentStep);
                updateStepTracker();
                updateProgressDots();
                
                // æ˜¾ç¤ºå®Œæˆæ¶ˆæ¯
                const messages = [
                    "âœ… æ­¥éª¤1å®Œæˆï¼åŸºç¡€ç½‘ç»œè¯Šæ–­é€šè¿‡",
                    "âœ… æ­¥éª¤2å®Œæˆï¼å‘ç°é˜²ç«å¢™é˜»æŒ¡é—®é¢˜",
                    "âœ… æ­¥éª¤3å®Œæˆï¼ç¡®è®¤ä»£ç†æœåŠ¡å™¨æ•…éšœ",
                    "ğŸ‰ æ­¥éª¤4å®Œæˆï¼æ‰€æœ‰é—®é¢˜å·²è¯Šæ–­"
                ];
                showFeedback(messages[currentStep - 1], 'success');
                updateScore(25);
                
                // è§£é”ä¸‹ä¸€æ­¥æŒ‰é’®
                updateNextStepButton();
                
                // å¦‚æœæ˜¯æœ€åä¸€æ­¥ï¼Œæ˜¾ç¤ºæœ€ç»ˆå®Œæˆ
                if (currentStep === totalSteps) {
                    setTimeout(() => {
                        showFeedback('ğŸ† æ­å–œï¼æ‰€æœ‰è¯Šæ–­æ­¥éª¤å®Œæˆï¼æ¡ˆä»¶æŠ¥å‘ŠæˆåŠŸä¸Šä¼ ï¼', 'success');
                        updateScore(100);
                        clearInterval(timerInterval);
                    }, 1000);
                }
            }
        }
        
        function updateNextStepButton() {
            const btn = document.getElementById('next-step-btn');
            const hint = document.getElementById('next-step-hint');
            
            if (completedSteps.has(currentStep) && currentStep < totalSteps) {
                btn.disabled = false;
                const nextStep = scenarios[currentScenario].steps[currentStep + 1];
                hint.textContent = `å‡†å¤‡è¿›å…¥æ­¥éª¤ ${currentStep + 1}: ${nextStep.title}`;
            } else if (currentStep === totalSteps && completedSteps.has(currentStep)) {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-flag-checkered"></i> å®Œæˆæ‰€æœ‰è¯Šæ–­';
                hint.textContent = 'æ­å–œå®Œæˆæ‰€æœ‰è¯Šæ–­æ­¥éª¤ï¼ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹æ€»ç»“';
            } else {
                btn.disabled = true;
                const step = scenarios[currentScenario].steps[currentStep];
                hint.textContent = `éœ€è¦å®Œæˆå½“å‰æ­¥éª¤: ${step.nextCondition}`;
            }
        }
        
        function advanceStep() {
            if (!completedSteps.has(currentStep)) {
                showFeedback('è¯·å…ˆå®Œæˆå½“å‰æ­¥éª¤çš„è¯Šæ–­', 'warning');
                return;
            }
            
            if (currentStep < totalSteps) {
                loadStep(currentStep + 1);
            } else {
                // æ˜¾ç¤ºæœ€ç»ˆæ€»ç»“
                showFinalSummary();
            }
        }
        
        function showFinalSummary() {
            const summary = `=== è¯Šæ–­ä»»åŠ¡å®Œæˆæ€»ç»“ ===
åœºæ™¯: ${scenarios[currentScenario].name}
å®Œæˆæ—¶é—´: ${new Date().toLocaleString()}
æœ€ç»ˆå¾—åˆ†: ${score}

å‘ç°çš„é—®é¢˜:
1. é˜²ç«å¢™å‡ºç«™è§„åˆ™é˜»æŒ¡äº†æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿç«¯å£(8443)
2. ä»£ç†æœåŠ¡å™¨è®¾ç½®é”™è¯¯ä¸”æ— å“åº”
3. DNSç¼“å­˜å¯èƒ½å¯¼è‡´è§£æé—®é¢˜

å®æ–½çš„è§£å†³æ–¹æ¡ˆ:
1. æ·»åŠ é˜²ç«å¢™ä¾‹å¤–è§„åˆ™å…è®¸8443ç«¯å£
2. ä¸´æ—¶ç¦ç”¨ä»£ç†æœåŠ¡å™¨è®¾ç½®
3. åˆ·æ–°DNSç¼“å­˜

éªŒè¯ç»“æœ:
âœ… æ¡ˆä»¶æŠ¥å‘ŠæˆåŠŸä¸Šä¼ è‡³æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿ
âœ… ç³»ç»Ÿå“åº”æ­£å¸¸ï¼Œä¸Šä¼ é€Ÿåº¦è¾¾æ ‡
âœ… æ‰€æœ‰è­¦åŠ¡åº”ç”¨æ¢å¤æ­£å¸¸

ç»éªŒæ€»ç»“:
- å¤šå±‚å®‰å…¨æªæ–½å¯èƒ½äº’ç›¸å†²çª
- åº”æ€¥æƒ…å†µä¸‹éœ€å¿«é€Ÿå®šä½å…³é”®é—®é¢˜
- ç³»ç»ŸåŒ–è¯Šæ–­æµç¨‹æé«˜æ•ˆç‡`;

            addTerminalOutput(summary, 'success');
            showFeedback('ğŸŠ ä»»åŠ¡å®Œæˆï¼è¯Šæ–­æŠ¥å‘Šå·²ç”Ÿæˆ', 'success');
            
            document.getElementById('next-step-btn').disabled = true;
            document.getElementById('next-step-hint').textContent = 'è¯Šæ–­ä»»åŠ¡å·²å®Œæˆï¼Œè¯·å¯¼å‡ºè¯Šæ–­è®°å½•';
        }
        
        // ====== ç»ˆç«¯ç›¸å…³å‡½æ•° ======
        function addTerminalOutput(text, type = 'output') {
            const terminal = document.getElementById('terminal-output');
            const line = document.createElement('div');
            line.className = 'terminal-line';
            
            let content = '';
            switch(type) {
                case 'command':
                    content = `<span class="terminal-prompt">C:\\PoliceNet\\Diagnosis></span> <span class="terminal-command">${text}</span>`;
                    break;
                case 'error':
                    content = `<span class="terminal-error">${text}</span>`;
                    break;
                case 'success':
                    content = `<span class="terminal-success">${text}</span>`;
                    break;
                case 'warning':
                    content = `<span class="terminal-warning">${text}</span>`;
                    break;
                default:
                    content = `<span class="terminal-output-text">${text}</span>`;
            }
            
            line.innerHTML = content;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }
        
        function clearTerminal() {
            document.getElementById('terminal-output').innerHTML = '';
            addTerminalOutput('ç»ˆç«¯å·²æ¸…ç©º\nè­¦åŠ¡ç½‘ç»œè¯Šæ–­ç³»ç»Ÿå°±ç»ª...', 'output');
        }
        
        // ====== å·¥å…·æ ‡ç­¾åˆ‡æ¢ ======
        function showTab(tabName) {
            // æ›´æ–°æ ‡ç­¾æŒ‰é’®
            document.querySelectorAll('.diagnosis-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // æ˜¾ç¤ºå¯¹åº”å†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }
        
        // ====== è¯Šæ–­è®°å½•å‡½æ•° ======
        function saveNotes() {
            const notes = document.getElementById('notes-textarea').value;
            localStorage.setItem(`scenario${currentScenario}_notes`, notes);
            showFeedback('è¯Šæ–­è®°å½•å·²ä¿å­˜', 'success');
            updateScore(5);
        }
        
        function exportNotes() {
            const notes = document.getElementById('notes-textarea').value;
            const blob = new Blob([notes], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `è­¦åŠ¡ç½‘ç»œè¯Šæ–­æŠ¥å‘Š_åœºæ™¯${currentScenario}_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showFeedback('è¯Šæ–­æŠ¥å‘Šå·²å¯¼å‡º', 'success');
            updateScore(10);
        }
        
        function printNotes() {
            const notes = document.getElementById('notes-textarea').value;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>è­¦åŠ¡ç½‘ç»œè¯Šæ–­æŠ¥å‘Š</title>
                    <style>
                        body { font-family: 'Microsoft YaHei', sans-serif; padding: 20px; }
                        pre { 
                            background: #f5f5f5; 
                            padding: 20px; 
                            border: 1px solid #ddd;
                            border-radius: 5px;
                            white-space: pre-wrap;
                            font-size: 14px;
                        }
                        .header { 
                            text-align: center; 
                            margin-bottom: 30px;
                            border-bottom: 2px solid #333;
                            padding-bottom: 20px;
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>è­¦åŠ¡ç½‘ç»œè¯Šæ–­æŠ¥å‘Š</h1>
                        <p>åœºæ™¯: ${scenarios[currentScenario].name} | æ—¶é—´: ${new Date().toLocaleString()}</p>
                    </div>
                    <pre>${notes}</pre>
                    <script>
                        window.onload = function() {
                            window.print();
                        }
                    <\/script>
                </body>
                </html>
            `);
            printWindow.document.close();
        }
        
        // ====== åé¦ˆæ¶ˆæ¯å‡½æ•° ======
        function showFeedback(message, type = 'info') {
            const container = document.getElementById('feedback-container');
            const feedback = document.createElement('div');
            feedback.className = `feedback-message ${type}`;
            feedback.innerHTML = `
                <div style="display: flex; align-items: center; gap: 15px;">
                    <i class="fas fa-${getFeedbackIcon(type)}"></i>
                    <div>${message}</div>
                </div>
            `;
            
            container.appendChild(feedback);
            
            // 3ç§’åç§»é™¤
            setTimeout(() => {
                if (feedback.parentNode) {
                    feedback.parentNode.removeChild(feedback);
                }
            }, 3000);
        }
        
        function getFeedbackIcon(type) {
            switch(type) {
                case 'success': return 'check-circle';
                case 'warning': return 'exclamation-triangle';
                case 'error': return 'times-circle';
                default: return 'info-circle';
            }
        }
        
        // æ·»åŠ CSSåŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes floatUp {
                0% { opacity: 1; transform: translateY(0); }
                100% { opacity: 0; transform: translateY(-30px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>