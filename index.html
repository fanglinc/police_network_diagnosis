<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è­¦åŠ¡ç½‘ç»œæ•…éšœè¯Šæ–­æ¨¡æ‹Ÿç³»ç»Ÿ - ä¸­é«˜çº§ä»»åŠ¡</title>
    <style>
        /* æ‰€æœ‰CSSæ ·å¼ä¿æŒä¸å˜ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --police-blue: #1a237e;
            --police-dark: #0d1b2a;
            --police-light: #283593;
            --police-accent: #2196f3;
            --police-alert: #f44336;
            --police-success: #4caf50;
            --police-warning: #ff9800;
            --police-gray: #546e7a;
            --police-light-gray: #eceff1;
        }
        
        body {
            background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 100%);
            color: #e0e0e0;
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .police-header {
            background: linear-gradient(to right, var(--police-dark), var(--police-blue));
            padding: 25px 40px;
            border-bottom: 4px solid var(--police-accent);
            position: relative;
            overflow: hidden;
        }
        
        .police-header::before {
            content: "";
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: radial-gradient(circle, rgba(33, 150, 243, 0.1) 0%, transparent 70%);
            z-index: 0;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            position: relative;
            z-index: 1;
        }
        
        .police-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .police-logo-icon {
            font-size: 42px;
            color: var(--police-accent);
            text-shadow: 0 0 10px rgba(33, 150, 243, 0.5);
        }
        
        .police-title h1 {
            font-size: 28px;
            color: white;
            margin-bottom: 5px;
            letter-spacing: 0.5px;
        }
        
        .police-title .subtitle {
            color: #bbdefb;
            font-size: 16px;
            opacity: 0.9;
        }
        
        .mission-badge {
            background: rgba(244, 67, 54, 0.9);
            color: white;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 18px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
        }
        
        .scenario-selector {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        .scenario-selector h2 {
            color: #bbdefb;
            margin-bottom: 20px;
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .scenario-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .scenario-card {
            background: rgba(38, 50, 56, 0.8);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .scenario-card:hover {
            transform: translateY(-5px);
            border-color: var(--police-accent);
            box-shadow: 0 10px 30px rgba(33, 150, 243, 0.2);
        }
        
        .scenario-card.active {
            border-color: var(--police-accent);
            background: rgba(33, 150, 243, 0.1);
            box-shadow: 0 0 20px rgba(33, 150, 243, 0.3);
        }
        
        .scenario-card.active::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--police-accent);
        }
        
        .scenario-icon {
            font-size: 32px;
            color: var(--police-accent);
            margin-bottom: 15px;
        }
        
        .scenario-card h3 {
            color: white;
            margin-bottom: 10px;
            font-size: 20px;
        }
        
        .scenario-card p {
            color: #b0bec5;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .scenario-container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
            display: none;
        }
        
        .scenario-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .scenario-info {
            background: rgba(26, 35, 126, 0.9);
            border-radius: 15px 15px 0 0;
            padding: 25px 30px;
            border-bottom: 2px solid var(--police-accent);
        }
        
        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .scenario-name {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .scenario-name h2 {
            color: white;
            font-size: 24px;
        }
        
        .scenario-tag {
            background: var(--police-warning);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .scenario-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-steps {
            display: flex;
            gap: 5px;
        }
        
        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }
        
        .step-dot.active {
            background: var(--police-success);
            box-shadow: 0 0 10px var(--police-success);
        }
        
        .step-dot.completed {
            background: var(--police-accent);
        }
        
        .time-pressure {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid rgba(244, 67, 54, 0.4);
            padding: 10px 20px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .time-pressure span {
            color: #ffcdd2;
            font-weight: bold;
        }
        
        .scenario-content {
            background: rgba(38, 50, 56, 0.8);
            border-radius: 0 0 15px 15px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .situation-box {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid var(--police-accent);
        }
        
        .situation-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .situation-header h3 {
            color: white;
            font-size: 22px;
        }
        
        .situation-icon {
            font-size: 28px;
            color: var(--police-accent);
        }
        
        .situation-details {
            color: #cfd8dc;
            line-height: 1.7;
        }
        
        .situation-details p {
            margin-bottom: 10px;
        }
        
        .urgency-badge {
            display: inline-block;
            background: var(--police-alert);
            color: white;
            padding: 8px 20px;
            border-radius: 5px;
            font-weight: bold;
            margin-top: 15px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .upload-test-area {
            background: rgba(26, 35, 126, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px dashed var(--police-accent);
            transition: all 0.3s;
            display: none;
        }
        
        .upload-test-area.uploading {
            border-color: var(--police-warning);
            background: rgba(255, 152, 0, 0.1);
        }
        
        .upload-test-area.success {
            border-color: var(--police-success);
            background: rgba(76, 175, 80, 0.1);
        }
        
        .upload-header {
            color: white;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
        }
        
        .file-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .file-option {
            flex: 1;
            min-width: 200px;
            background: rgba(38, 50, 56, 0.8);
            border: 2px solid rgba(33, 150, 243, 0.3);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .file-option:hover {
            background: rgba(33, 150, 243, 0.2);
            transform: translateY(-2px);
        }
        
        .file-option.active {
            background: rgba(33, 150, 243, 0.3);
            border-color: var(--police-accent);
            box-shadow: 0 0 15px rgba(33, 150, 243, 0.4);
        }
        
        .file-icon {
            font-size: 24px;
            color: var(--police-accent);
            margin-bottom: 10px;
        }
        
        .file-name {
            color: white;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .file-size {
            color: #b0bec5;
            font-size: 12px;
        }
        
        .upload-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .upload-btn {
            padding: 12px 30px;
            background: var(--police-accent);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .upload-btn:hover:not(:disabled) {
            background: #1976d2;
            transform: translateY(-2px);
        }
        
        .upload-btn:disabled {
            background: #546e7a;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .upload-btn.success {
            background: var(--police-success);
        }
        
        .upload-progress-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .progress-bar-container {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--police-accent), var(--police-success));
            transition: width 0.3s;
        }
        
        .upload-status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 5px;
            display: none;
        }
        
        .upload-status.success {
            background: rgba(76, 175, 80, 0.2);
            border-left: 4px solid var(--police-success);
            display: block;
        }
        
        .upload-details {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            font-size: 14px;
            color: #b0bec5;
        }
        
        .diagnosis-area {
            background: rgba(48, 63, 71, 0.8);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .diagnosis-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }
        
        .diagnosis-tab {
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: #b0bec5;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .diagnosis-tab:hover {
            background: rgba(33, 150, 243, 0.2);
            color: white;
        }
        
        .diagnosis-tab.active {
            background: var(--police-accent);
            color: white;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .terminal-container {
            background: #1e1e1e;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid rgba(33, 150, 243, 0.3);
        }
        
        .terminal-header {
            background: #252526;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #333;
        }
        
        .terminal-title {
            color: #cccccc;
            font-size: 14px;
            flex: 1;
        }
        
        .terminal-controls {
            display: flex;
            gap: 8px;
        }
        
        .terminal-control {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .control-close { background: #ff5f56; }
        .control-minimize { background: #ffbd2e; }
        .control-maximize { background: #27ca3f; }
        
        .terminal-output {
            height: 350px;
            overflow-y: auto;
            padding: 20px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .terminal-line {
            margin-bottom: 10px;
            word-wrap: break-word;
        }
        
        .terminal-prompt {
            color: #4caf50;
            font-weight: bold;
        }
        
        .terminal-command {
            color: white;
        }
        
        .terminal-output-text {
            color: #00bcd4;
            white-space: pre-wrap;
        }
        
        .terminal-error {
            color: #ff5252;
        }
        
        .terminal-success {
            color: #4caf50;
        }
        
        .terminal-warning {
            color: #ff9800;
        }
        
        .command-input-area {
            background: #252526;
            padding: 15px 20px;
            border-top: 1px solid #333;
            display: flex;
            gap: 10px;
        }
        
        .command-input {
            flex: 1;
            background: #2d2d2d;
            border: 1px solid #444;
            color: white;
            padding: 12px 15px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 14px;
        }
        
        .command-input:focus {
            outline: none;
            border-color: var(--police-accent);
        }
        
        .command-buttons {
            display: flex;
            gap: 10px;
        }
        
        .cmd-btn {
            padding: 12px 20px;
            background: var(--police-accent);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .cmd-btn:hover {
            background: #1976d2;
        }
        
        .cmd-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .cmd-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .quick-commands {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        
        .quick-cmd {
            background: rgba(33, 150, 243, 0.1);
            border: 1px solid rgba(33, 150, 243, 0.3);
            color: #bbdefb;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            transition: all 0.3s;
        }
        
        .quick-cmd:hover {
            background: rgba(33, 150, 243, 0.3);
            transform: translateY(-2px);
        }
        
        .info-panels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-panel {
            background: rgba(38, 50, 56, 0.8);
            border-radius: 15px;
            padding: 25px;
        }
        
        .info-panel h3 {
            color: white;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(33, 150, 243, 0.5);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .clue-list {
            list-style: none;
        }
        
        .clue-item {
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid var(--police-accent);
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 0 5px 5px 0;
            transition: all 0.3s;
        }
        
        .clue-item:hover {
            background: rgba(33, 150, 243, 0.1);
            transform: translateX(5px);
        }
        
        .clue-item.new {
            border-left-color: var(--police-warning);
            animation: highlightClue 2s ease-in-out infinite;
        }
        
        @keyframes highlightClue {
            0% { border-left-color: var(--police-warning); }
            50% { border-left-color: #ffeb3b; }
            100% { border-left-color: var(--police-warning); }
        }
        
        .step-tracker {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .step-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .step-item:hover {
            background: rgba(0, 0, 0, 0.4);
        }
        
        .step-item.active {
            background: rgba(33, 150, 243, 0.2);
            border-left: 4px solid var(--police-accent);
        }
        
        .step-item.completed {
            background: rgba(76, 175, 80, 0.2);
            border-left: 4px solid var(--police-success);
        }
        
        .step-number {
            width: 30px;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            color: #b0bec5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .step-item.active .step-number {
            background: var(--police-accent);
            color: white;
        }
        
        .step-item.completed .step-number {
            background: var(--police-success);
            color: white;
        }
        
        .step-info {
            flex: 1;
        }
        
        .step-title {
            color: white;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .step-desc {
            color: #b0bec5;
            font-size: 13px;
        }
        
        .next-step-container {
            text-align: center;
            padding: 30px;
            background: rgba(26, 35, 126, 0.5);
            border-radius: 15px;
            margin-bottom: 40px;
        }
        
        .next-step-btn {
            background: linear-gradient(135deg, var(--police-success), #2e7d32);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 0 auto 20px;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
        }
        
        .next-step-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.4);
        }
        
        .next-step-btn:disabled {
            background: linear-gradient(135deg, #666, #888);
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .next-step-hint {
            color: #bbdefb;
            font-size: 14px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .feedback-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }
        
        .feedback-message {
            background: #1e1e1e;
            border-left: 5px solid var(--police-accent);
            padding: 20px 25px;
            border-radius: 8px;
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            animation: slideInRight 0.5s ease, fadeOut 0.5s ease 2.5s forwards;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .feedback-message.success {
            border-left-color: var(--police-success);
            background: rgba(76, 175, 80, 0.1);
        }
        
        .feedback-message.warning {
            border-left-color: var(--police-warning);
            background: rgba(255, 152, 0, 0.1);
        }
        
        .feedback-message.error {
            border-left-color: var(--police-alert);
            background: rgba(244, 67, 54, 0.1);
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            to { opacity: 0; }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .police-logo {
                justify-content: center;
            }
            
            .scenario-cards {
                grid-template-columns: 1fr;
            }
            
            .scenario-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .info-panels {
                grid-template-columns: 1fr;
            }
            
            .command-input-area {
                flex-direction: column;
            }
            
            .command-buttons {
                width: 100%;
            }
            
            .cmd-btn {
                flex: 1;
                justify-content: center;
            }
            
            .quick-commands {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .file-selector {
                flex-direction: column;
            }
            
            .upload-controls {
                flex-direction: column;
            }
            
            .feedback-container {
                left: 20px;
                right: 20px;
                max-width: none;
            }
        }
        
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .police-header, .scenario-selector, .diagnosis-tabs, 
            .command-input-area, .next-step-container {
                display: none;
            }
            
            .scenario-container.active {
                display: block;
                break-inside: avoid;
            }
        }
        
        /* æ–°å¢æ ·å¼ */
        .solution-box {
            background: rgba(26, 35, 126, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid var(--police-success);
            display: none;
        }
        
        .solution-box.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .solution-header {
            color: white;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
        }
        
        .solution-content {
            color: #cfd8dc;
            line-height: 1.7;
        }
        
        .solution-step {
            margin-bottom: 15px;
            padding-left: 20px;
            border-left: 3px solid var(--police-success);
        }
        
        .verification-test {
            background: rgba(76, 175, 80, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid var(--police-success);
        }
        
        .verification-btn {
            padding: 12px 25px;
            background: var(--police-success);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .verification-btn:hover {
            background: #2e7d32;
            transform: translateY(-2px);
        }
        
        .test-result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        
        .test-result.success {
            background: rgba(76, 175, 80, 0.2);
            border-left: 4px solid var(--police-success);
            display: block;
        }
        
        .test-result.failure {
            background: rgba(244, 67, 54, 0.2);
            border-left: 4px solid var(--police-alert);
            display: block;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header class="police-header">
        <div class="header-content">
            <div class="police-logo">
                <div class="police-logo-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="police-title">
                    <h1>è­¦åŠ¡ç½‘ç»œæ•…éšœè¯Šæ–­æ¨¡æ‹Ÿç³»ç»Ÿ</h1>
                    <p class="subtitle">ä¸­é«˜çº§ä»»åŠ¡ - å®æˆ˜åŒ–æ•…éšœæ’æŸ¥è®­ç»ƒå¹³å°</p>
                </div>
            </div>
            <div class="mission-badge">
                <i class="fas fa-bullseye"></i> æŒ‘æˆ˜ä»»åŠ¡
            </div>
        </div>
    </header>
    
    <section class="scenario-selector">
        <h2><i class="fas fa-map-signs"></i> è¯·é€‰æ‹©è¯Šæ–­åœºæ™¯</h2>
        <div class="scenario-cards">
            <div class="scenario-card active" onclick="loadScenario(1)">
                <div class="scenario-icon">
                    <i class="fas fa-file-upload"></i>
                </div>
                <h3>åœºæ™¯ä¸€ï¼šç´§æ€¥æŠ¥å‘Šæ— æ³•ä¸Šä¼ </h3>
                <p>å¤œé—´å€¼ç­æ—¶æ®µï¼Œæ¡ˆä»¶æŠ¥å‘Šæ— æ³•ä¸Šä¼ è‡³æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿï¼Œæ¶‰åŠç½‘ç»œè¿é€šæ€§ã€é˜²ç«å¢™é…ç½®ã€ä»£ç†è®¾ç½®ç­‰å¤šé‡é—®é¢˜æ’æŸ¥ã€‚</p>
                <div style="margin-top: 15px; color: #4caf50; font-size: 12px;">
                    <i class="fas fa-star"></i> æ¨èï¼šç½‘ç»œåŸºç¡€æ‰å®è€…
                </div>
            </div>
            
            <div class="scenario-card" onclick="loadScenario(2)">
                <div class="scenario-icon">
                    <i class="fas fa-video"></i>
                </div>
                <h3>åœºæ™¯äºŒï¼šè§†é¢‘ç›‘æ§ä¸­æ–­</h3>
                <p>æŒ‡æŒ¥ä¸­å¿ƒå¤§å±æ˜¾ç¤ºå¤šä¸ªæ‘„åƒå¤´ç¦»çº¿ï¼Œæ¶‰åŠç½‘ç»œè®¾å¤‡æ•…éšœã€VLANé…ç½®ã€ç¯è·¯æ£€æµ‹ç­‰å¤æ‚ç½‘ç»œé—®é¢˜è¯Šæ–­ã€‚</p>
                <div style="margin-top: 15px; color: #ff9800; font-size: 12px;">
                    <i class="fas fa-brain"></i> æŒ‘æˆ˜ï¼šç½‘ç»œé…ç½®ç²¾é€šè€…
                </div>
            </div>
            
            <div class="scenario-card" onclick="loadScenario(3)">
                <div class="scenario-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h3>åœºæ™¯ä¸‰ï¼šè­¦åŠ¡é€šæ— æ³•è”ç½‘</h3>
                <p>æ‰§å‹¤ç‚¹æ‰€æœ‰è­¦åŠ¡é€šè®¾å¤‡æ— æ³•è¿æ¥ç§»åŠ¨ç½‘ç»œï¼Œæ¶‰åŠç§»åŠ¨ç½‘ç»œé…ç½®ã€è¿è¥å•†åè°ƒã€åº”æ€¥æ–¹æ¡ˆåˆ¶å®šç­‰ç»¼åˆèƒ½åŠ›è€ƒéªŒã€‚</p>
                <div style="margin-top: 15px; color: #2196f3; font-size: 12px;">
                    <i class="fas fa-bolt"></i> ç»¼åˆï¼šåº”æ€¥å¤„ç†èƒ½åŠ›è€…
                </div>
            </div>
        </div>
    </section>
    
    <!-- åœºæ™¯1 -->
    <section id="scenario1" class="scenario-container active">
        <div class="scenario-info">
            <div class="scenario-header">
                <div class="scenario-name">
                    <h2><i class="fas fa-file-upload"></i> ç´§æ€¥æŠ¥å‘Šæ— æ³•ä¸Šä¼ </h2>
                    <span class="scenario-tag">ç½‘ç»œè¿é€šæ€§æ•…éšœ</span>
                </div>
                <div class="scenario-progress">
                    <div class="progress-steps">
                        <div class="step-dot completed" id="step1-dot"></div>
                        <div class="step-dot" id="step2-dot"></div>
                        <div class="step-dot" id="step3-dot"></div>
                        <div class="step-dot" id="step4-dot"></div>
                    </div>
                    <div class="time-pressure">
                        <i class="fas fa-clock"></i>
                        <span id="time-remaining">28:00</span> å‰©ä½™æ—¶é—´
                    </div>
                </div>
            </div>
            <p style="color: #bbdefb; margin-top: 10px;">æ·±å¤œå€¼ç­ç´§æ€¥ä»»åŠ¡ï¼Œ30åˆ†é’Ÿå†…å¿…é¡»å®Œæˆæ¡ˆä»¶æŠ¥å‘Šä¸Šä¼ ï¼Œç½‘ç»œè¿æ¥å´å‡ºç°é—®é¢˜...</p>
        </div>
        
        <div class="scenario-content">
            <div class="situation-box">
                <div class="situation-header">
                    <i class="fas fa-exclamation-triangle situation-icon"></i>
                    <h3 id="step-title">ç¬¬ä¸€æ­¥ï¼šåŸºç¡€ç½‘ç»œè¿é€šæ€§è¯Šæ–­</h3>
                </div>
                <div class="situation-details" id="step-description">
                    <p><strong>ğŸ• æ—¶é—´ï¼š</strong>2025å¹´3æœˆ15æ—¥ 22:30ï¼ˆå¤œé—´å€¼ç­æ—¶æ®µï¼‰</p>
                    <p><strong>ğŸ“ åœ°ç‚¹ï¼š</strong>XXæ´¾å‡ºæ‰€å€¼ç­å®¤</p>
                    <p><strong>ğŸ“ ä»»åŠ¡ï¼š</strong>æ‚¨åˆšåˆšå¤„ç†å®Œä¸€èµ·ç´§æ€¥æ¡ˆä»¶ï¼Œéœ€è¦ç«‹å³å°†ã€Šæ¡ˆæƒ…æŠ¥å‘Šã€‹ä¸Šä¼ è‡³å¸‚å±€æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿã€‚</p>
                    <p><strong>âŒ é—®é¢˜ï¼š</strong>æŠ¥å‘Šå¡«å†™å®Œæˆåï¼Œç‚¹å‡»"ä¸Šä¼ "æŒ‰é’®ï¼Œç³»ç»Ÿæç¤º"ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®"ã€‚</p>
                    <p><strong>ğŸ”„ å·²å°è¯•ï¼š</strong>é‡å¯æµè§ˆå™¨ã€é‡å¯ç”µè„‘ï¼Œé—®é¢˜ä¾æ—§ã€‚</p>
                    <div class="urgency-badge">
                        <i class="fas fa-bell"></i> ä¸Šçº§ä¸¥ä»¤ï¼š30åˆ†é’Ÿå†…å¿…é¡»ä¸Šä¼ å®Œæ¯•ï¼
                    </div>
                </div>
            </div>
            
            <!-- æ–°å¢ï¼šè§£å†³æ–¹æ¡ˆåŒºåŸŸ -->
            <div id="solution-area" class="solution-box">
                <h3 class="solution-header"><i class="fas fa-check-circle"></i> æ•…éšœè§£å†³æ–¹æ¡ˆ</h3>
                <div class="solution-content" id="solution-content">
                    <!-- è§£å†³æ–¹æ¡ˆå†…å®¹ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                <div class="verification-test" id="verification-test">
                    <h4><i class="fas fa-vial"></i> è§£å†³æ–¹æ¡ˆéªŒè¯æµ‹è¯•</h4>
                    <p>è¯·æŒ‰ç…§ä¸Šè¿°è§£å†³æ–¹æ¡ˆæ‰§è¡Œä¿®å¤æ“ä½œï¼Œç„¶åç‚¹å‡»ä¸‹æ–¹æŒ‰é’®éªŒè¯é—®é¢˜æ˜¯å¦è§£å†³ã€‚</p>
                    <button class="verification-btn" onclick="verifyScenario1Solution()">
                        <i class="fas fa-check"></i> éªŒè¯è§£å†³æ–¹æ¡ˆ
                    </button>
                    <div class="test-result" id="verification-result"></div>
                </div>
            </div>
            
            <div id="upload-test-area" class="upload-test-area">
                <h3 class="upload-header"><i class="fas fa-upload"></i> æ–‡ä»¶ä¸Šä¼ éªŒè¯æµ‹è¯•</h3>
                <div class="file-selector">
                    <div class="file-option active" onclick="selectFile('case-report')">
                        <div class="file-icon"><i class="fas fa-file-alt"></i></div>
                        <div class="file-name">æ¡ˆä»¶æŠ¥å‘Š.docx</div>
                        <div class="file-size">256 KB</div>
                    </div>
                    <div class="file-option" onclick="selectFile('scene-photo')">
                        <div class="file-icon"><i class="fas fa-camera"></i></div>
                        <div class="file-name">ç°åœºç…§ç‰‡.jpg</div>
                        <div class="file-size">1.8 MB</div>
                    </div>
                    <div class="file-option" onclick="selectFile('video-evidence')">
                        <div class="file-icon"><i class="fas fa-video"></i></div>
                        <div class="file-name">è§†é¢‘è¯æ®.mp4</div>
                        <div class="file-size">15.2 MB</div>
                    </div>
                </div>
                <div class="upload-controls">
                    <button class="upload-btn" id="upload-btn" onclick="startUpload()">
                        <i class="fas fa-cloud-upload-alt"></i> å¼€å§‹ä¸Šä¼ 
                    </button>
                    <button class="upload-btn secondary" onclick="resetUpload()">
                        <i class="fas fa-redo"></i> é‡æ–°å¼€å§‹
                    </button>
                </div>
                <div class="upload-progress-container" id="upload-progress">
                    <div class="progress-info">
                        <span style="color: #bbdefb;">ä¸Šä¼ è¿›åº¦</span>
                        <span style="color: #4caf50;" id="progress-percent">0%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    <div class="upload-details">
                        <div id="upload-speed">é€Ÿåº¦: -- KB/s</div>
                        <div id="upload-time">æ—¶é—´: --</div>
                        <div id="file-size">å¤§å°: --</div>
                    </div>
                </div>
                <div class="upload-status" id="upload-status"></div>
            </div>
            
            <div class="diagnosis-area">
                <div class="diagnosis-tabs">
                    <button class="diagnosis-tab active" onclick="showTab('terminal')">
                        <i class="fas fa-terminal"></i> å‘½ä»¤ç»ˆç«¯
                    </button>
                    <button class="diagnosis-tab" onclick="showTab('tools')">
                        <i class="fas fa-tools"></i> è¯Šæ–­å·¥å…·
                    </button>
                    <button class="diagnosis-tab" onclick="showTab('notes')">
                        <i class="fas fa-sticky-note"></i> è¯Šæ–­è®°å½•
                    </button>
                </div>
                
                <div id="terminal-tab" class="tab-content active">
                    <div class="terminal-container">
                        <div class="terminal-header">
                            <div class="terminal-title">
                                <i class="fas fa-network-wired"></i> è­¦åŠ¡ç½‘ç»œè¯Šæ–­ç»ˆç«¯
                            </div>
                            <div class="terminal-controls">
                                <div class="terminal-control control-close"></div>
                                <div class="terminal-control control-minimize"></div>
                                <div class="terminal-control control-maximize"></div>
                            </div>
                        </div>
                        <div class="terminal-output" id="terminal-output">
                            <div class="terminal-line">
                                <span class="terminal-prompt">C:\PoliceNet\Diagnosis></span>
                                <span class="terminal-command">systeminfo</span>
                            </div>
                            <div class="terminal-line terminal-output-text">
è­¦åŠ¡ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ v2.5 | å½“å‰æ—¶é—´: 22:30:15
ç³»ç»ŸçŠ¶æ€: æ£€æµ‹åˆ°ç½‘ç»œè¿æ¥å¼‚å¸¸
å»ºè®®æ“ä½œ: å¼€å§‹åŸºç¡€ç½‘ç»œè¯Šæ–­
================================
è¾“å…¥ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤
                            </div>
                        </div>
                        <div class="command-input-area">
                            <input type="text" class="command-input" id="command-input" 
                                   placeholder="è¾“å…¥è¯Šæ–­å‘½ä»¤ (å¦‚: ping, ipconfig, tracert...)" 
                                   onkeypress="if(event.key === 'Enter') executeCommand()">
                            <div class="command-buttons">
                                <button class="cmd-btn" onclick="executeCommand()">
                                    <i class="fas fa-play"></i> æ‰§è¡Œ
                                </button>
                                <button class="cmd-btn secondary" onclick="clearTerminal()">
                                    <i class="fas fa-broom"></i> æ¸…å±
                                </button>
                                <button class="cmd-btn secondary" onclick="showHelp()">
                                    <i class="fas fa-question-circle"></i> å¸®åŠ©
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="quick-commands">
                        <div class="quick-cmd" onclick="runQuickCommand('ping 127.0.0.1')">ping 127.0.0.1</div>
                        <div class="quick-cmd" onclick="runQuickCommand('ipconfig')">ipconfig</div>
                        <div class="quick-cmd" onclick="runQuickCommand('ping 10.10.1.1')">ping ç½‘å…³</div>
                        <div class="quick-cmd" onclick="runQuickCommand('ping www.baidu.com')">æµ‹è¯•å¤–ç½‘</div>
                        <div class="quick-cmd" onclick="runQuickCommand('tracert 10.10.100.50')">è¿½è¸ªæœåŠ¡å™¨</div>
                        <div class="quick-cmd" onclick="runQuickCommand('nslookup case.gov.cn')">DNSæŸ¥è¯¢</div>
                        <div class="quick-cmd" onclick="runQuickCommand('telnet 10.10.100.50 8443')">æµ‹è¯•ç«¯å£</div>
                        <div class="quick-cmd" onclick="runQuickCommand('netsh advfirewall show rule name=all')">æŸ¥çœ‹é˜²ç«å¢™</div>
                    </div>
                </div>
                
                <div id="tools-tab" class="tab-content">
                    <h3 style="color: white; margin-bottom: 20px;">ç½‘ç»œè¯Šæ–­å·¥å…·ç®±</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: rgba(33, 150, 243, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(33, 150, 243, 0.3);">
                            <h4><i class="fas fa-sitemap" style="color: #2196f3;"></i> ç½‘ç»œè¿é€šæ€§æµ‹è¯•</h4>
                            <p style="color: #bbdefb; font-size: 14px; margin: 10px 0;">ä¸€é”®æµ‹è¯•åŸºç¡€ç½‘ç»œè¿é€šæ€§</p>
                            <button onclick="runTool('connectivity')" style="width: 100%; padding: 10px; background: #2196f3; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                å¼€å§‹æµ‹è¯•
                            </button>
                        </div>
                        <div style="background: rgba(255, 152, 0, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(255, 152, 0, 0.3);">
                            <h4><i class="fas fa-shield-alt" style="color: #ff9800;"></i> é˜²ç«å¢™æ£€æŸ¥</h4>
                            <p style="color: #ffccbc; font-size: 14px; margin: 10px 0;">æ£€æŸ¥é˜²ç«å¢™è§„åˆ™å’Œé…ç½®</p>
                            <button onclick="runTool('firewall')" style="width: 100%; padding: 10px; background: #ff9800; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ£€æŸ¥è®¾ç½®
                            </button>
                        </div>
                        <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(76, 175, 80, 0.3);">
                            <h4><i class="fas fa-search" style="color: #4caf50;"></i> ç«¯å£æ‰«æ</h4>
                            <p style="color: #c8e6c9; font-size: 14px; margin: 10px 0;">æ‰«æç›®æ ‡æœåŠ¡å™¨çš„å¼€æ”¾ç«¯å£</p>
                            <button onclick="runTool('portscan')" style="width: 100%; padding: 10px; background: #4caf50; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ‰«æç«¯å£
                            </button>
                        </div>
                        <div style="background: rgba(156, 39, 176, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(156, 39, 176, 0.3);">
                            <h4><i class="fas fa-bug" style="color: #9c27b0;"></i> ä»£ç†æ£€æµ‹</h4>
                            <p style="color: #e1bee7; font-size: 14px; margin: 10px 0;">æ£€æµ‹ä»£ç†æœåŠ¡å™¨çŠ¶æ€å’Œé…ç½®</p>
                            <button onclick="runTool('proxy')" style="width: 100%; padding: 10px; background: #9c27b0; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ£€æµ‹ä»£ç†
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="notes-tab" class="tab-content">
                    <h3 style="color: white; margin-bottom: 20px;">è¯Šæ–­è®°å½•</h3>
                    <textarea id="notes-textarea" style="width: 100%; height: 300px; padding: 20px; background: rgba(0, 0, 0, 0.3); color: white; border: 1px solid #444; border-radius: 8px; font-family: inherit; font-size: 14px; line-height: 1.6; resize: vertical;" placeholder="åœ¨æ­¤è®°å½•æ‚¨çš„è¯Šæ–­è¿‡ç¨‹å’Œå‘ç°...">
=== è­¦åŠ¡ç½‘ç»œè¯Šæ–­è®°å½• ===
åœºæ™¯ï¼šç´§æ€¥æŠ¥å‘Šæ— æ³•ä¸Šä¼ 
æ—¶é—´ï¼š2025-03-15 22:30
è¯Šæ–­äººï¼šå­¦å‘˜

å·²å‘ç°çš„é—®é¢˜ï¼š
1. 
2. 
3. 

å·²å°è¯•çš„è§£å†³æ–¹æ¡ˆï¼š
1. 
2. 
3. 

æ ¹æœ¬åŸå› åˆ†æï¼š

å»ºè®®è§£å†³æ–¹æ¡ˆï¼š

å¤‡æ³¨ï¼š
                    </textarea>
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="cmd-btn" onclick="saveNotes()" style="flex: 1;">
                            <i class="fas fa-save"></i> ä¿å­˜è®°å½•
                        </button>
                        <button class="cmd-btn secondary" onclick="exportNotes()" style="flex: 1;">
                            <i class="fas fa-download"></i> å¯¼å‡ºæŠ¥å‘Š
                        </button>
                        <button class="cmd-btn secondary" onclick="printNotes()" style="flex: 1;">
                            <i class="fas fa-print"></i> æ‰“å°è®°å½•
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="info-panels">
                <div class="info-panel">
                    <h3><i class="fas fa-lightbulb"></i> çº¿ç´¢ä¸æç¤º</h3>
                    <ul class="clue-list" id="clue-list">
                        <li class="clue-item new">é¦–å…ˆæµ‹è¯•æœ¬åœ°ç½‘ç»œè¿é€šæ€§ (ping 127.0.0.1)</li>
                        <li class="clue-item">æ£€æŸ¥ç½‘å…³è¿æ¥çŠ¶æ€ (ping ç½‘å…³åœ°å€)</li>
                        <li class="clue-item">æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿä½¿ç”¨8443ç«¯å£</li>
                        <li class="clue-item">å…¬å®‰å†…ç½‘æœ‰ç‹¬ç«‹çš„DNSæœåŠ¡å™¨</li>
                        <li class="clue-item">æ£€æŸ¥Windowsé˜²ç«å¢™å‡ºç«™è§„åˆ™</li>
                        <li class="clue-item">ä»£ç†æœåŠ¡å™¨å¯èƒ½å½±å“ä¸Šä¼ </li>
                    </ul>
                </div>
                
                <!-- ä¿®å¤ï¼šæ­¥éª¤è·Ÿè¸ªå™¨æ­£ç¡®æ˜¾ç¤º -->
                <div class="info-panel">
                    <h3><i class="fas fa-tasks"></i> è¯Šæ–­æ­¥éª¤</h3>
                    <div class="step-tracker" id="step-tracker">
                        <div class="step-item active">
                            <div class="step-number">1</div>
                            <div class="step-info">
                                <div class="step-title">åŸºç¡€ç½‘ç»œè¿é€šæ€§è¯Šæ–­</div>
                                <div class="step-desc">æµ‹è¯•æœ¬åœ°ç½‘ç»œã€ç½‘å…³è¿æ¥ã€IPé…ç½®</div>
                            </div>
                        </div>
                        <div class="step-item">
                            <div class="step-number">2</div>
                            <div class="step-info">
                                <div class="step-title">æœåŠ¡å™¨è¿é€šæ€§ä¸é˜²ç«å¢™æ£€æŸ¥</div>
                                <div class="step-desc">æ£€æŸ¥ç«¯å£è¿é€šæ€§ã€é˜²ç«å¢™è§„åˆ™</div>
                            </div>
                        </div>
                        <div class="step-item">
                            <div class="step-number">3</div>
                            <div class="step-info">
                                <div class="step-title">åº”ç”¨å±‚ä¸ä»£ç†é—®é¢˜æ’æŸ¥</div>
                                <div class="step-desc">æ£€æŸ¥ä»£ç†è®¾ç½®ã€DNSè§£æã€ç³»ç»ŸæœåŠ¡</div>
                            </div>
                        </div>
                        <div class="step-item">
                            <div class="step-number">4</div>
                            <div class="step-info">
                                <div class="step-title">ç»¼åˆè§£å†³æ–¹æ¡ˆä¸éªŒè¯</div>
                                <div class="step-desc">å®æ–½è§£å†³æ–¹æ¡ˆå¹¶éªŒè¯æ–‡ä»¶ä¸Šä¼ </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="info-panel">
                    <h3><i class="fas fa-medal"></i> è¯Šæ–­å¾—åˆ†</h3>
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 48px; font-weight: bold; color: #4caf50; margin-bottom: 10px;" id="score-display">100</div>
                        <div style="color: #bbdefb; font-size: 18px;">è¯Šæ–­ç§¯åˆ†</div>
                        <div style="margin-top: 25px; background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #b0bec5;">å‘ç°çº¿ç´¢</span>
                                <span style="color: #4caf50;" id="clue-count">1/6</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #b0bec5;">å®Œæˆæ­¥éª¤</span>
                                <span style="color: #4caf50;" id="step-count">1/4</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #b0bec5;">å‰©ä½™æ—¶é—´</span>
                                <span style="color: #ff9800;" id="time-score">28:00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="next-step-container">
                <button class="next-step-btn" id="next-step-btn" onclick="advanceStep()" disabled>
                    <i class="fas fa-forward"></i> è¿›å…¥ä¸‹ä¸€æ­¥æ•…éšœè¯Šæ–­
                </button>
                <p class="next-step-hint" id="next-step-hint">
                    å®Œæˆå½“å‰æ­¥éª¤çš„æ‰€æœ‰è¯Šæ–­ä»»åŠ¡åè§£é”ä¸‹ä¸€æ­¥
                </p>
            </div>
        </div>
    </section>
    
    <!-- åœºæ™¯2 -->
    <section id="scenario2" class="scenario-container">
        <div class="scenario-info">
            <div class="scenario-header">
                <div class="scenario-name">
                    <h2><i class="fas fa-video"></i> è§†é¢‘ç›‘æ§ä¸­æ–­</h2>
                    <span class="scenario-tag">ç½‘ç»œè®¾å¤‡æ•…éšœ</span>
                </div>
                <div class="scenario-progress">
                    <div class="progress-steps">
                        <div class="step-dot completed" id="scenario2-step1-dot"></div>
                        <div class="step-dot" id="scenario2-step2-dot"></div>
                        <div class="step-dot" id="scenario2-step3-dot"></div>
                        <div class="step-dot" id="scenario2-step4-dot"></div>
                    </div>
                    <div class="time-pressure">
                        <i class="fas fa-clock"></i>
                        <span id="scenario2-time-remaining">45:00</span> å‰©ä½™æ—¶é—´
                    </div>
                </div>
            </div>
            <p style="color: #bbdefb; margin-top: 10px;">æŒ‡æŒ¥ä¸­å¿ƒå¤§å±æ˜¾ç¤ºå¤šä¸ªé‡ç‚¹åŒºåŸŸæ‘„åƒå¤´ç¦»çº¿ï¼Œæ¶‰åŠå…¬å…±å®‰å…¨ç›‘æ§...</p>
        </div>
        
        <div class="scenario-content">
            <div class="situation-box">
                <div class="situation-header">
                    <i class="fas fa-exclamation-triangle situation-icon"></i>
                    <h3 id="scenario2-step-title">ç¬¬ä¸€æ­¥ï¼šæ‘„åƒå¤´ç¦»çº¿æ£€æµ‹</h3>
                </div>
                <div class="situation-details" id="scenario2-step-description">
                    <p><strong>ğŸ• æ—¶é—´ï¼š</strong>2025å¹´4æœˆ20æ—¥ 14:15ï¼ˆåˆé«˜å³°æ—¶æ®µï¼‰</p>
                    <p><strong>ğŸ“ åœ°ç‚¹ï¼š</strong>å¸‚å±€æŒ‡æŒ¥ä¸­å¿ƒ</p>
                    <p><strong>ğŸ“ ä»»åŠ¡ï¼š</strong>æŒ‡æŒ¥ä¸­å¿ƒå¤§å±æ˜¾ç¤ºå¤šä¸ªé‡ç‚¹åŒºåŸŸæ‘„åƒå¤´ç¦»çº¿ï¼ŒåŒ…æ‹¬äº¤é€šè¦é“å’Œå•†ä¸šåŒºã€‚</p>
                    <p><strong>âŒ é—®é¢˜ï¼š</strong>ç›‘æ§ç³»ç»ŸæŠ¥è­¦ï¼Œæ˜¾ç¤º15ä¸ªæ‘„åƒå¤´ç¦»çº¿ï¼Œå½±å“å®æ—¶ç›‘æ§å’Œå…¬å…±å®‰å…¨ã€‚</p>
                    <p><strong>ğŸ”„ å·²å°è¯•ï¼š</strong>é‡å¯ç›‘æ§æœåŠ¡å™¨ï¼Œéƒ¨åˆ†æ‘„åƒå¤´æ¢å¤ä½†ä»æœ‰8ä¸ªç¦»çº¿ã€‚</p>
                    <div class="urgency-badge">
                        <i class="fas fa-bell"></i> å±€é•¿æŒ‡ç¤ºï¼š1å°æ—¶å†…å¿…é¡»æ¢å¤ç›‘æ§ï¼
                    </div>
                </div>
            </div>
            
            <!-- æ–°å¢ï¼šåœºæ™¯2è§£å†³æ–¹æ¡ˆåŒºåŸŸ -->
            <div id="scenario2-solution-area" class="solution-box">
                <h3 class="solution-header"><i class="fas fa-check-circle"></i> è§†é¢‘ç›‘æ§æ•…éšœè§£å†³æ–¹æ¡ˆ</h3>
                <div class="solution-content" id="scenario2-solution-content">
                    <!-- è§£å†³æ–¹æ¡ˆå†…å®¹ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                <div class="verification-test" id="scenario2-verification-test">
                    <h4><i class="fas fa-vial"></i> è§£å†³æ–¹æ¡ˆéªŒè¯æµ‹è¯•</h4>
                    <p>è¯·æŒ‰ç…§ä¸Šè¿°è§£å†³æ–¹æ¡ˆæ‰§è¡Œä¿®å¤æ“ä½œï¼Œç„¶åç‚¹å‡»ä¸‹æ–¹æŒ‰é’®éªŒè¯ç›‘æ§æ˜¯å¦æ¢å¤ã€‚</p>
                    <button class="verification-btn" onclick="verifyScenario2Solution()">
                        <i class="fas fa-video"></i> éªŒè¯ç›‘æ§æ¢å¤
                    </button>
                    <div class="test-result" id="scenario2-verification-result"></div>
                </div>
            </div>
            
            <div class="diagnosis-area">
                <div class="diagnosis-tabs">
                    <button class="diagnosis-tab active" onclick="showScenario2Tab('terminal')">
                        <i class="fas fa-terminal"></i> å‘½ä»¤ç»ˆç«¯
                    </button>
                    <button class="diagnosis-tab" onclick="showScenario2Tab('tools')">
                        <i class="fas fa-tools"></i> ç½‘ç»œè®¾å¤‡æ£€æŸ¥
                    </button>
                    <button class="diagnosis-tab" onclick="showScenario2Tab('notes')">
                        <i class="fas fa-sticky-note"></i> è¯Šæ–­è®°å½•
                    </button>
                </div>
                
                <div id="scenario2-terminal-tab" class="tab-content active">
                    <div class="terminal-container">
                        <div class="terminal-header">
                            <div class="terminal-title">
                                <i class="fas fa-network-wired"></i> è§†é¢‘ç›‘æ§ç½‘ç»œè¯Šæ–­ç»ˆç«¯
                            </div>
                            <div class="terminal-controls">
                                <div class="terminal-control control-close"></div>
                                <div class="terminal-control control-minimize"></div>
                                <div class="terminal-control control-maximize"></div>
                            </div>
                        </div>
                        <div class="terminal-output" id="scenario2-terminal-output">
                            <div class="terminal-line">
                                <span class="terminal-prompt">C:\PoliceNet\VideoDiagnosis></span>
                                <span class="terminal-command">status check</span>
                            </div>
                            <div class="terminal-line terminal-output-text">
è§†é¢‘ç›‘æ§ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ v3.2 | å½“å‰æ—¶é—´: 14:15:30
ç³»ç»ŸçŠ¶æ€: æ£€æµ‹åˆ°15ä¸ªæ‘„åƒå¤´ç¦»çº¿
ç¦»çº¿è®¾å¤‡: CAM-001è‡³CAM-015
å»ºè®®æ“ä½œ: å¼€å§‹ç½‘ç»œè®¾å¤‡è¯Šæ–­
================================
è¾“å…¥ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤
                            </div>
                        </div>
                        <div class="command-input-area">
                            <input type="text" class="command-input" id="scenario2-command-input" 
                                   placeholder="è¾“å…¥è¯Šæ–­å‘½ä»¤ (å¦‚: show interface, ping, tracert...)" 
                                   onkeypress="if(event.key === 'Enter') executeScenario2Command()">
                            <div class="command-buttons">
                                <button class="cmd-btn" onclick="executeScenario2Command()">
                                    <i class="fas fa-play"></i> æ‰§è¡Œ
                                </button>
                                <button class="cmd-btn secondary" onclick="clearScenario2Terminal()">
                                    <i class="fas fa-broom"></i> æ¸…å±
                                </button>
                                <button class="cmd-btn secondary" onclick="showScenario2Help()">
                                    <i class="fas fa-question-circle"></i> å¸®åŠ©
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="quick-commands">
                        <div class="quick-cmd" onclick="runScenario2Command('show interface GigabitEthernet0/1')">æ£€æŸ¥æ¥å£çŠ¶æ€</div>
                        <div class="quick-cmd" onclick="runScenario2Command('ping 192.168.10.1')">ping æ ¸å¿ƒäº¤æ¢æœº</div>
                        <div class="quick-cmd" onclick="runScenario2Command('show vlan brief')">æŸ¥çœ‹VLANé…ç½®</div>
                        <div class="quick-cmd" onclick="runScenario2Command('show spanning-tree')">æŸ¥çœ‹ç”Ÿæˆæ ‘çŠ¶æ€</div>
                        <div class="quick-cmd" onclick="runScenario2Command('show ip route')">æŸ¥çœ‹è·¯ç”±è¡¨</div>
                        <div class="quick-cmd" onclick="runScenario2Command('show logging')">æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—</div>
                        <div class="quick-cmd" onclick="runScenario2Command('show mac address-table')">æŸ¥çœ‹MACåœ°å€è¡¨</div>
                        <div class="quick-cmd" onclick="runScenario2Command('show cdp neighbors')">æŸ¥çœ‹é‚»å±…è®¾å¤‡</div>
                    </div>
                </div>
                
                <div id="scenario2-tools-tab" class="tab-content">
                    <h3 style="color: white; margin-bottom: 20px;">ç½‘ç»œè®¾å¤‡è¯Šæ–­å·¥å…·ç®±</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: rgba(33, 150, 243, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(33, 150, 243, 0.3);">
                            <h4><i class="fas fa-sitemap" style="color: #2196f3;"></i> äº¤æ¢æœºçŠ¶æ€æ£€æŸ¥</h4>
                            <p style="color: #bbdefb; font-size: 14px; margin: 10px 0;">æ£€æŸ¥æ ¸å¿ƒäº¤æ¢æœºçŠ¶æ€å’Œæ¥å£</p>
                            <button onclick="runScenario2Tool('switch-check')" style="width: 100%; padding: 10px; background: #2196f3; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                å¼€å§‹æ£€æŸ¥
                            </button>
                        </div>
                        <div style="background: rgba(255, 152, 0, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(255, 152, 0, 0.3);">
                            <h4><i class="fas fa-random" style="color: #ff9800;"></i> ç½‘ç»œç¯è·¯æ£€æµ‹</h4>
                            <p style="color: #ffccbc; font-size: 14px; margin: 10px 0;">æ£€æµ‹ç½‘ç»œç¯è·¯å’Œç”Ÿæˆæ ‘é—®é¢˜</p>
                            <button onclick="runScenario2Tool('loop-detection')" style="width: 100%; padding: 10px; background: #ff9800; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ£€æµ‹ç¯è·¯
                            </button>
                        </div>
                        <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(76, 175, 80, 0.3);">
                            <h4><i class="fas fa-wifi" style="color: #4caf50;"></i> VLANé…ç½®éªŒè¯</h4>
                            <p style="color: #c8e6c9; font-size: 14px; margin: 10px 0;">éªŒè¯æ‘„åƒå¤´VLANé…ç½®å’Œéš”ç¦»</p>
                            <button onclick="runScenario2Tool('vlan-check')" style="width: 100%; padding: 10px; background: #4caf50; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                éªŒè¯é…ç½®
                            </button>
                        </div>
                        <div style="background: rgba(156, 39, 176, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(156, 39, 176, 0.3);">
                            <h4><i class="fas fa-broadcast-tower" style="color: #9c27b0;"></i> PoEç”µæºè¯Šæ–­</h4>
                            <p style="color: #e1bee7; font-size: 14px; margin: 10px 0;">æ£€æŸ¥PoEäº¤æ¢æœºå’Œæ‘„åƒå¤´ä¾›ç”µ</p>
                            <button onclick="runScenario2Tool('poe-check')" style="width: 100%; padding: 10px; background: #9c27b0; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                ç”µæºè¯Šæ–­
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="scenario2-notes-tab" class="tab-content">
                    <h3 style="color: white; margin-bottom: 20px;">è¯Šæ–­è®°å½•</h3>
                    <textarea id="scenario2-notes-textarea" style="width: 100%; height: 300px; padding: 20px; background: rgba(0, 0, 0, 0.3); color: white; border: 1px solid #444; border-radius: 8px; font-family: inherit; font-size: 14px; line-height: 1.6; resize: vertical;" placeholder="åœ¨æ­¤è®°å½•æ‚¨çš„è¯Šæ–­è¿‡ç¨‹å’Œå‘ç°...">
=== è§†é¢‘ç›‘æ§ç½‘ç»œè¯Šæ–­è®°å½• ===
åœºæ™¯ï¼šè§†é¢‘ç›‘æ§ä¸­æ–­
æ—¶é—´ï¼š2025-04-20 14:15
è¯Šæ–­äººï¼šå­¦å‘˜

ç¦»çº¿æ‘„åƒå¤´ï¼š
1. 
2. 
3. 

ç½‘ç»œè®¾å¤‡çŠ¶æ€ï¼š
1. 
2. 
3. 

å·²å‘ç°çš„ç½‘ç»œé—®é¢˜ï¼š
1. 
2. 
3. 

æ ¹æœ¬åŸå› åˆ†æï¼š

å»ºè®®è§£å†³æ–¹æ¡ˆï¼š

å¤‡æ³¨ï¼š
                    </textarea>
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="cmd-btn" onclick="saveScenario2Notes()" style="flex: 1;">
                            <i class="fas fa-save"></i> ä¿å­˜è®°å½•
                        </button>
                        <button class="cmd-btn secondary" onclick="exportScenario2Notes()" style="flex: 1;">
                            <i class="fas fa-download"></i> å¯¼å‡ºæŠ¥å‘Š
                        </button>
                        <button class="cmd-btn secondary" onclick="printScenario2Notes()" style="flex: 1;">
                            <i class="fas fa-print"></i> æ‰“å°è®°å½•
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="info-panels">
                <div class="info-panel">
                    <h3><i class="fas fa-lightbulb"></i> çº¿ç´¢ä¸æç¤º</h3>
                    <ul class="clue-list" id="scenario2-clue-list">
                        <li class="clue-item new">æ£€æŸ¥æ ¸å¿ƒäº¤æ¢æœºçŠ¶æ€ (show interface)</li>
                        <li class="clue-item">éªŒè¯æ‘„åƒå¤´VLANé…ç½® (show vlan brief)</li>
                        <li class="clue-item">æ£€æµ‹ç½‘ç»œç¯è·¯ (show spanning-tree)</li>
                        <li class="clue-item">æ£€æŸ¥PoEäº¤æ¢æœºç”µæºçŠ¶æ€</li>
                        <li class="clue-item">æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯</li>
                        <li class="clue-item">æ£€æŸ¥äº¤æ¢æœºMACåœ°å€è¡¨</li>
                    </ul>
                </div>
                
                <!-- åœºæ™¯2æ­¥éª¤è·Ÿè¸ªå™¨ -->
                <div class="info-panel">
                    <h3><i class="fas fa-tasks"></i> è¯Šæ–­æ­¥éª¤</h3>
                    <div class="step-tracker" id="scenario2-step-tracker">
                        <div class="step-item active">
                            <div class="step-number">1</div>
                            <div class="step-info">
                                <div class="step-title">æ‘„åƒå¤´ç¦»çº¿æ£€æµ‹</div>
                                <div class="step-desc">ç¡®è®¤æ‘„åƒå¤´ç¦»çº¿èŒƒå›´å¹¶æ”¶é›†è®¾å¤‡ä¿¡æ¯</div>
                            </div>
                        </div>
                        <div class="step-item">
                            <div class="step-number">2</div>
                            <div class="step-info">
                                <div class="step-title">äº¤æ¢æœºé—®é¢˜æ’æŸ¥</div>
                                <div class="step-desc">æ£€æŸ¥äº¤æ¢æœºçŠ¶æ€ã€ç«¯å£é…ç½®ã€VLANè®¾ç½®</div>
                            </div>
                        </div>
                        <div class="step-item">
                            <div class="step-number">3</div>
                            <div class="step-info">
                                <div class="step-title">ç½‘ç»œç¯è·¯æ£€æµ‹</div>
                                <div class="step-desc">æ£€æŸ¥ç”Ÿæˆæ ‘çŠ¶æ€ã€ç½‘ç»œæ‹“æ‰‘ã€å¹¿æ’­é£æš´</div>
                            </div>
                        </div>
                        <div class="step-item">
                            <div class="step-number">4</div>
                            <div class="step-info">
                                <div class="step-title">åº”æ€¥æ–¹æ¡ˆå®æ–½</div>
                                <div class="step-desc">å®æ–½åº”æ€¥æ–¹æ¡ˆï¼Œæ¢å¤å…³é”®ç›‘æ§</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="info-panel">
                    <h3><i class="fas fa-medal"></i> è¯Šæ–­å¾—åˆ†</h3>
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 48px; font-weight: bold; color: #4caf50; margin-bottom: 10px;" id="scenario2-score-display">100</div>
                        <div style="color: #bbdefb; font-size: 18px;">è¯Šæ–­ç§¯åˆ†</div>
                        <div style="margin-top: 25px; background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #b0bec5;">å‘ç°çº¿ç´¢</span>
                                <span style="color: #4caf50;" id="scenario2-clue-count">1/6</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #b0bec5;">å®Œæˆæ­¥éª¤</span>
                                <span style="color: #4caf50;" id="scenario2-step-count">1/4</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #b0bec5;">å‰©ä½™æ—¶é—´</span>
                                <span style="color: #ff9800;" id="scenario2-time-score">45:00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="next-step-container">
                <button class="next-step-btn" id="scenario2-next-step-btn" onclick="advanceScenario2Step()" disabled>
                    <i class="fas fa-forward"></i> è¿›å…¥ä¸‹ä¸€æ­¥æ•…éšœè¯Šæ–­
                </button>
                <p class="next-step-hint" id="scenario2-next-step-hint">
                    å®Œæˆå½“å‰æ­¥éª¤çš„æ‰€æœ‰è¯Šæ–­ä»»åŠ¡åè§£é”ä¸‹ä¸€æ­¥
                </p>
            </div>
        </div>
    </section>
    
    <!-- åœºæ™¯3 -->
    <section id="scenario3" class="scenario-container">
        <div class="scenario-info">
            <div class="scenario-header">
                <div class="scenario-name">
                    <h2><i class="fas fa-mobile-alt"></i> è­¦åŠ¡é€šæ— æ³•è”ç½‘</h2>
                    <span class="scenario-tag">ç§»åŠ¨ç½‘ç»œæ•…éšœ</span>
                </div>
                <div class="scenario-progress">
                    <div class="progress-steps">
                        <div class="step-dot completed" id="scenario3-step1-dot"></div>
                        <div class="step-dot" id="scenario3-step2-dot"></div>
                        <div class="step-dot" id="scenario3-step3-dot"></div>
                        <div class="step-dot" id="scenario3-step4-dot"></div>
                    </div>
                    <div class="time-pressure">
                        <i class="fas fa-clock"></i>
                        <span id="scenario3-time-remaining">35:00</span> å‰©ä½™æ—¶é—´
                    </div>
                </div>
            </div>
            <p style="color: #bbdefb; margin-top: 10px;">æ—©é«˜å³°æ‰§å‹¤ç‚¹æ‰€æœ‰è­¦åŠ¡é€šè®¾å¤‡æ— æ³•è¿æ¥ç§»åŠ¨ç½‘ç»œï¼Œå½±å“äº¤é€šç–å¯¼å’Œè½¦è¾†æ£€æŸ¥...</p>
        </div>
        
        <div class="scenario-content">
            <div class="situation-box">
                <div class="situation-header">
                    <i class="fas fa-exclamation-triangle situation-icon"></i>
                    <h3 id="scenario3-step-title">ç¬¬ä¸€æ­¥ï¼šè®¾å¤‡åŸºç¡€æ£€æŸ¥</h3>
                </div>
                <div class="situation-details" id="scenario3-step-description">
                    <p><strong>ğŸ• æ—¶é—´ï¼š</strong>2025å¹´5æœˆ10æ—¥ 08:30ï¼ˆæ—©é«˜å³°æ—¶æ®µï¼‰</p>
                    <p><strong>ğŸ“ åœ°ç‚¹ï¼š</strong>å¸‚ä¸­å¿ƒäº¤é€šæ‰§å‹¤ç‚¹</p>
                    <p><strong>ğŸ“ ä»»åŠ¡ï¼š</strong>æ‰§å‹¤ç‚¹æ‰€æœ‰è­¦åŠ¡é€šè®¾å¤‡æ— æ³•è¿æ¥ç§»åŠ¨ç½‘ç»œï¼Œæ— æ³•è¿›è¡Œäº¤é€šæŸ¥è¯¢ã€è½¦è¾†æ£€æŸ¥ç­‰å·¥ä½œã€‚</p>
                    <p><strong>âŒ é—®é¢˜ï¼š</strong>8å°è­¦åŠ¡é€šå…¨éƒ¨æ˜¾ç¤º"æ— ç½‘ç»œè¿æ¥"ï¼Œå½±å“æ—©é«˜å³°äº¤é€šç–å¯¼å·¥ä½œã€‚</p>
                    <p><strong>ğŸ”„ å·²å°è¯•ï¼š</strong>é‡å¯è®¾å¤‡ã€åˆ‡æ¢é£è¡Œæ¨¡å¼ï¼Œé—®é¢˜ä¾æ—§ã€‚</p>
                    <div class="urgency-badge">
                        <i class="fas fa-bell"></i> ç´§æ€¥æƒ…å†µï¼šæ—©é«˜å³°äº¤é€šç–å¯¼æ€¥éœ€è­¦åŠ¡é€šï¼
                    </div>
                </div>
            </div>
            
            <!-- æ–°å¢ï¼šåœºæ™¯3è§£å†³æ–¹æ¡ˆåŒºåŸŸ -->
            <div id="scenario3-solution-area" class="solution-box">
                <h3 class="solution-header"><i class="fas fa-check-circle"></i> è­¦åŠ¡é€šç§»åŠ¨ç½‘ç»œæ•…éšœè§£å†³æ–¹æ¡ˆ</h3>
                <div class="solution-content" id="scenario3-solution-content">
                    <!-- è§£å†³æ–¹æ¡ˆå†…å®¹ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                <div class="verification-test" id="scenario3-verification-test">
                    <h4><i class="fas fa-vial"></i> è§£å†³æ–¹æ¡ˆéªŒè¯æµ‹è¯•</h4>
                    <p>è¯·æŒ‰ç…§ä¸Šè¿°è§£å†³æ–¹æ¡ˆæ‰§è¡Œä¿®å¤æ“ä½œï¼Œç„¶åç‚¹å‡»ä¸‹æ–¹æŒ‰é’®éªŒè¯è­¦åŠ¡é€šæ˜¯å¦æ¢å¤è”ç½‘ã€‚</p>
                    <button class="verification-btn" onclick="verifyScenario3Solution()">
                        <i class="fas fa-mobile-alt"></i> éªŒè¯ç½‘ç»œæ¢å¤
                    </button>
                    <div class="test-result" id="scenario3-verification-result"></div>
                </div>
            </div>
            
            <div class="diagnosis-area">
                <div class="diagnosis-tabs">
                    <button class="diagnosis-tab active" onclick="showScenario3Tab('terminal')">
                        <i class="fas fa-terminal"></i> ç§»åŠ¨ç½‘ç»œç»ˆç«¯
                    </button>
                    <button class="diagnosis-tab" onclick="showScenario3Tab('tools')">
                        <i class="fas fa-tools"></i> ç½‘ç»œè¯Šæ–­å·¥å…·
                    </button>
                    <button class="diagnosis-tab" onclick="showScenario3Tab('notes')">
                        <i class="fas fa-sticky-note"></i> è¯Šæ–­è®°å½•
                    </button>
                </div>
                
                <div id="scenario3-terminal-tab" class="tab-content active">
                    <div class="terminal-container">
                        <div class="terminal-header">
                            <div class="terminal-title">
                                <i class="fas fa-mobile-alt"></i> è­¦åŠ¡é€šç§»åŠ¨ç½‘ç»œè¯Šæ–­ç»ˆç«¯
                            </div>
                            <div class="terminal-controls">
                                <div class="terminal-control control-close"></div>
                                <div class="terminal-control control-minimize"></div>
                                <div class="terminal-control control-maximize"></div>
                            </div>
                        </div>
                        <div class="terminal-output" id="scenario3-terminal-output">
                            <div class="terminal-line">
                                <span class="terminal-prompt">MobileNet\Diagnosis></span>
                                <span class="terminal-command">check devices</span>
                            </div>
                            <div class="terminal-line terminal-output-text">
è­¦åŠ¡é€šç§»åŠ¨ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ v4.1 | å½“å‰æ—¶é—´: 08:30:45
ç³»ç»ŸçŠ¶æ€: æ£€æµ‹åˆ°æ‰€æœ‰è­¦åŠ¡é€šè®¾å¤‡ç¦»çº¿
ç¦»çº¿è®¾å¤‡: 8å°è­¦åŠ¡é€š (ID: PD-M001è‡³PD-M008)
å»ºè®®æ“ä½œ: å¼€å§‹ç§»åŠ¨ç½‘ç»œè¯Šæ–­
================================
è¾“å…¥ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤
                            </div>
                        </div>
                        <div class="command-input-area">
                            <input type="text" class="command-input" id="scenario3-command-input" 
                                   placeholder="è¾“å…¥è¯Šæ–­å‘½ä»¤ (å¦‚: signal check, apn list, ping...)" 
                                   onkeypress="if(event.key === 'Enter') executeScenario3Command()">
                            <div class="command-buttons">
                                <button class="cmd-btn" onclick="executeScenario3Command()">
                                    <i class="fas fa-play"></i> æ‰§è¡Œ
                                </button>
                                <button class="cmd-btn secondary" onclick="clearScenario3Terminal()">
                                    <i class="fas fa-broom"></i> æ¸…å±
                                </button>
                                <button class="cmd-btn secondary" onclick="showScenario3Help()">
                                    <i class="fas fa-question-circle"></i> å¸®åŠ©
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="quick-commands">
                        <div class="quick-cmd" onclick="runScenario3Command('signal strength')">æ£€æŸ¥ä¿¡å·å¼ºåº¦</div>
                        <div class="quick-cmd" onclick="runScenario3Command('show apn')">æŸ¥çœ‹APNé…ç½®</div>
                        <div class="quick-cmd" onclick="runScenario3Command('ping 8.8.8.8')">æµ‹è¯•äº’è”ç½‘è¿æ¥</div>
                        <div class="quick-cmd" onclick="runScenario3Command('show imsi')">æŸ¥çœ‹IMSIçŠ¶æ€</div>
                        <div class="quick-cmd" onclick="runScenario3Command('network scan')">æ‰«æå¯ç”¨ç½‘ç»œ</div>
                        <div class="quick-cmd" onclick="runScenario3Command('show data status')">æŸ¥çœ‹æ•°æ®çŠ¶æ€</div>
                        <div class="quick-cmd" onclick="runScenario3Command('reset network')">é‡ç½®ç½‘ç»œè®¾ç½®</div>
                        <div class="quick-cmd" onclick="runScenario3Command('check carrier')">æ£€æŸ¥è¿è¥å•†çŠ¶æ€</div>
                    </div>
                </div>
                
                <div id="scenario3-tools-tab" class="tab-content">
                    <h3 style="color: white; margin-bottom: 20px;">ç§»åŠ¨ç½‘ç»œè¯Šæ–­å·¥å…·ç®±</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: rgba(33, 150, 243, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(33, 150, 243, 0.3);">
                            <h4><i class="fas fa-signal" style="color: #2196f3;"></i> ä¿¡å·å¼ºåº¦åˆ†æ</h4>
                            <p style="color: #bbdefb; font-size: 14px; margin: 10px 0;">åˆ†æå½“å‰ä½ç½®ä¿¡å·è¦†ç›–æƒ…å†µ</p>
                            <button onclick="runScenario3Tool('signal-analysis')" style="width: 100%; padding: 10px; background: #2196f3; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                åˆ†æä¿¡å·
                            </button>
                        </div>
                        <div style="background: rgba(255, 152, 0, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(255, 152, 0, 0.3);">
                            <h4><i class="fas fa-cog" style="color: #ff9800;"></i> APNé…ç½®æ£€æŸ¥</h4>
                            <p style="color: #ffccbc; font-size: 14px; margin: 10px 0;">æ£€æŸ¥è­¦åŠ¡ä¸“ç”¨APNé…ç½®</p>
                            <button onclick="runScenario3Tool('apn-check')" style="width: 100%; padding: 10px; background: #ff9800; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ£€æŸ¥é…ç½®
                            </button>
                        </div>
                        <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(76, 175, 80, 0.3);">
                            <h4><i class="fas fa-tower-cell" style="color: #4caf50;"></i> è¿è¥å•†çŠ¶æ€æ£€æµ‹</h4>
                            <p style="color: #c8e6c9; font-size: 14px; margin: 10px 0;">æ£€æµ‹è¿è¥å•†ç½‘ç»œçŠ¶æ€å’ŒæœåŠ¡</p>
                            <button onclick="runScenario3Tool('carrier-check')" style="width: 100%; padding: 10px; background: #4caf50; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æ£€æµ‹çŠ¶æ€
                            </button>
                        </div>
                        <div style="background: rgba(156, 39, 176, 0.1); padding: 20px; border-radius: 10px; border: 1px solid rgba(156, 39, 176, 0.3);">
                            <h4><i class="fas fa-satellite-dish" style="color: #9c27b0;"></i> ç´§æ€¥é€šä¿¡æµ‹è¯•</h4>
                            <p style="color: #e1bee7; font-size: 14px; margin: 10px 0;">æµ‹è¯•ç´§æ€¥é€šä¿¡å’Œå¤‡ç”¨æ–¹æ¡ˆ</p>
                            <button onclick="runScenario3Tool('emergency-test')" style="width: 100%; padding: 10px; background: #9c27b0; color: white; border: none; border-radius: 5px; cursor: pointer;">
                                æµ‹è¯•é€šä¿¡
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="scenario3-notes-tab" class="tab-content">
                    <h3 style="color: white; margin-bottom: 20px;">è¯Šæ–­è®°å½•</h3>
                    <textarea id="scenario3-notes-textarea" style="width: 100%; height: 300px; padding: 20px; background: rgba(0, 0, 0, 0.3); color: white; border: 1px solid #444; border-radius: 8px; font-family: inherit; font-size: 14px; line-height: 1.6; resize: vertical;" placeholder="åœ¨æ­¤è®°å½•æ‚¨çš„è¯Šæ–­è¿‡ç¨‹å’Œå‘ç°...">
=== è­¦åŠ¡é€šç§»åŠ¨ç½‘ç»œè¯Šæ–­è®°å½• ===
åœºæ™¯ï¼šè­¦åŠ¡é€šæ— æ³•è”ç½‘
æ—¶é—´ï¼š2025-05-10 08:30
è¯Šæ–­äººï¼šå­¦å‘˜

å—å½±å“è®¾å¤‡ï¼š
1. 
2. 
3. 

ç½‘ç»œçŠ¶æ€æ£€æŸ¥ï¼š
1. 
2. 
3. 

å·²å‘ç°çš„ç½‘ç»œé—®é¢˜ï¼š
1. 
2. 
3. 

æ ¹æœ¬åŸå› åˆ†æï¼š

å»ºè®®è§£å†³æ–¹æ¡ˆï¼š

å¤‡æ³¨ï¼š
                    </textarea>
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="cmd-btn" onclick="saveScenario3Notes()" style="flex: 1;">
                            <i class="fas fa-save"></i> ä¿å­˜è®°å½•
                        </button>
                        <button class="cmd-btn secondary" onclick="exportScenario3Notes()" style="flex: 1;">
                            <i class="fas fa-download"></i> å¯¼å‡ºæŠ¥å‘Š
                        </button>
                        <button class="cmd-btn secondary" onclick="printScenario3Notes()" style="flex: 1;">
                            <i class="fas fa-print"></i> æ‰“å°è®°å½•
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="info-panels">
                <div class="info-panel">
                    <h3><i class="fas fa-lightbulb"></i> çº¿ç´¢ä¸æç¤º</h3>
                    <ul class="clue-list" id="scenario3-clue-list">
                        <li class="clue-item new">æ£€æŸ¥è­¦åŠ¡é€šä¿¡å·å¼ºåº¦ (signal strength)</li>
                        <li class="clue-item">éªŒè¯è­¦åŠ¡ä¸“ç”¨APNé…ç½® (show apn)</li>
                        <li class="clue-item">æ£€æŸ¥SIMå¡å’ŒIMSIçŠ¶æ€</li>
                        <li class="clue-item">æ‰«æå¯ç”¨çš„è¿è¥å•†ç½‘ç»œ</li>
                        <li class="clue-item">æ£€æŸ¥ç§»åŠ¨æ•°æ®æœåŠ¡çŠ¶æ€</li>
                        <li class="clue-item">è”ç³»è¿è¥å•†ç¡®è®¤ç½‘ç»œçŠ¶æ€</li>
                    </ul>
                </div>
                
                <!-- åœºæ™¯3æ­¥éª¤è·Ÿè¸ªå™¨ -->
                <div class="info-panel">
                    <h3><i class="fas fa-tasks"></i> è¯Šæ–­æ­¥éª¤</h3>
                    <div class="step-tracker" id="scenario3-step-tracker">
                        <div class="step-item active">
                            <div class="step-number">1</div>
                            <div class="step-info">
                                <div class="step-title">è®¾å¤‡åŸºç¡€æ£€æŸ¥</div>
                                <div class="step-desc">ç¡®è®¤æ‰€æœ‰è­¦åŠ¡é€šè®¾å¤‡éƒ½æ— æ³•è”ç½‘</div>
                            </div>
                        </div>
                        <div class="step-item">
                            <div class="step-number">2</div>
                            <div class="step-info">
                                <div class="step-title">ç½‘ç»œé…ç½®è¯Šæ–­</div>
                                <div class="step-desc">æ£€æŸ¥APNé…ç½®ã€SIMå¡çŠ¶æ€ã€ç½‘ç»œæ³¨å†Œ</div>
                            </div>
                        </div>
                        <div class="step-item">
                            <div class="step-number">3</div>
                            <div class="step-info">
                                <div class="step-title">è¿è¥å•†é—®é¢˜æ’æŸ¥</div>
                                <div class="step-desc">è”ç³»è¿è¥å•†ã€æ£€æŸ¥åŸºç«™çŠ¶æ€ã€æµ‹è¯•é¢‘æ®µ</div>
                            </div>
                        </div>
                        <div class="step-item">
                            <div class="step-number">4</div>
                            <div class="step-info">
                                <div class="step-title">åº”æ€¥æ–¹æ¡ˆå®æ–½</div>
                                <div class="step-desc">å®æ–½åº”æ€¥é€šä¿¡æ–¹æ¡ˆï¼Œæ¢å¤è­¦åŠ¡é€šä¿¡</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="info-panel">
                    <h3><i class="fas fa-medal"></i> è¯Šæ–­å¾—åˆ†</h3>
                    <div style="text-align: center; padding: 20px;">
                        <div style="font-size: 48px; font-weight: bold; color: #4caf50; margin-bottom: 10px;" id="scenario3-score-display">100</div>
                        <div style="color: #bbdefb; font-size: 18px;">è¯Šæ–­ç§¯åˆ†</div>
                        <div style="margin-top: 25px; background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #b0bec5;">å‘ç°çº¿ç´¢</span>
                                <span style="color: #4caf50;" id="scenario3-clue-count">1/6</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #b0bec5;">å®Œæˆæ­¥éª¤</span>
                                <span style="color: #4caf50;" id="scenario3-step-count">1/4</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #b0bec5;">å‰©ä½™æ—¶é—´</span>
                                <span style="color: #ff9800;" id="scenario3-time-score">35:00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="next-step-container">
                <button class="next-step-btn" id="scenario3-next-step-btn" onclick="advanceScenario3Step()" disabled>
                    <i class="fas fa-forward"></i> è¿›å…¥ä¸‹ä¸€æ­¥æ•…éšœè¯Šæ–­
                </button>
                <p class="next-step-hint" id="scenario3-next-step-hint">
                    å®Œæˆå½“å‰æ­¥éª¤çš„æ‰€æœ‰è¯Šæ–­ä»»åŠ¡åè§£é”ä¸‹ä¸€æ­¥
                </p>
            </div>
        </div>
    </section>
    
    <div class="feedback-container" id="feedback-container"></div>

    <script>
        // ====== å…¨å±€å˜é‡å’Œé…ç½® ======
        let currentScenario = 1;
        let currentStep = 1;
        let totalSteps = 4;
        let score = 100;
        let discoveredClues = new Set(['é¦–å…ˆæµ‹è¯•æœ¬åœ°ç½‘ç»œè¿é€šæ€§ (ping 127.0.0.1)']);
        let completedSteps = new Set([1]);
        let timeRemaining = 28 * 60;
        let timerInterval;
        let selectedFile = 'case-report';
        let isUploadInProgress = false;
        let uploadSuccess = false;
        
        // åœºæ™¯2å˜é‡
        let scenario2Score = 100;
        let scenario2DiscoveredClues = new Set(['æ£€æŸ¥æ ¸å¿ƒäº¤æ¢æœºçŠ¶æ€ (show interface)']);
        let scenario2CompletedSteps = new Set([1]);
        let scenario2TimeRemaining = 45 * 60;
        let scenario2Step = 1;
        
        // åœºæ™¯3å˜é‡
        let scenario3Score = 100;
        let scenario3DiscoveredClues = new Set(['æ£€æŸ¥è­¦åŠ¡é€šä¿¡å·å¼ºåº¦ (signal strength)']);
        let scenario3CompletedSteps = new Set([1]);
        let scenario3TimeRemaining = 35 * 60;
        let scenario3Step = 1;
        
        // åœºæ™¯æ•°æ®é…ç½®
        const scenarios = {
            1: {
                name: "ç´§æ€¥æŠ¥å‘Šæ— æ³•ä¸Šä¼ ",
                timeLimit: 28,
                steps: {
                    1: {
                        title: "ç¬¬ä¸€æ­¥ï¼šåŸºç¡€ç½‘ç»œè¿é€šæ€§è¯Šæ–­",
                        description: `<p><strong>ğŸ• æ—¶é—´ï¼š</strong>2025å¹´3æœˆ15æ—¥ 22:30ï¼ˆå¤œé—´å€¼ç­æ—¶æ®µï¼‰</p>
                                    <p><strong>ğŸ“ åœ°ç‚¹ï¼š</strong>XXæ´¾å‡ºæ‰€å€¼ç­å®¤</p>
                                    <p><strong>ğŸ“ ä»»åŠ¡ï¼š</strong>æ‚¨åˆšåˆšå¤„ç†å®Œä¸€èµ·ç´§æ€¥æ¡ˆä»¶ï¼Œéœ€è¦ç«‹å³å°†ã€Šæ¡ˆæƒ…æŠ¥å‘Šã€‹ä¸Šä¼ è‡³å¸‚å±€æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿã€‚</p>
                                    <p><strong>âŒ é—®é¢˜ï¼š</strong>æŠ¥å‘Šå¡«å†™å®Œæˆåï¼Œç‚¹å‡»"ä¸Šä¼ "æŒ‰é’®ï¼Œç³»ç»Ÿæç¤º"ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®"ã€‚</p>
                                    <p><strong>ğŸ”„ å·²å°è¯•ï¼š</strong>é‡å¯æµè§ˆå™¨ã€é‡å¯ç”µè„‘ï¼Œé—®é¢˜ä¾æ—§ã€‚</p>
                                    <div class="urgency-badge">
                                        <i class="fas fa-bell"></i> ä¸Šçº§ä¸¥ä»¤ï¼š30åˆ†é’Ÿå†…å¿…é¡»ä¸Šä¼ å®Œæ¯•ï¼
                                    </div>`,
                        nextCondition: "å‘ç°ç½‘å…³å¯ä»¥pingé€šï¼Œä½†æœåŠ¡å™¨æ— æ³•è®¿é—®"
                    },
                    2: {
                        title: "ç¬¬äºŒæ­¥ï¼šæœåŠ¡å™¨è¿é€šæ€§ä¸é˜²ç«å¢™æ£€æŸ¥",
                        description: `<p><strong>ğŸ” æ–°å‘ç°ï¼š</strong>åŸºç¡€ç½‘ç»œæ­£å¸¸ï¼Œä½†æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿ(10.10.100.50:8443)æ— æ³•è¿æ¥ã€‚</p>
                                    <p><strong>âš ï¸ å‡çº§é—®é¢˜ï¼š</strong>ç³»ç»Ÿæ—¥å¿—æ˜¾ç¤º"è¿æ¥è¢«æ‹’ç»"ï¼Œå¯èƒ½æ˜¯é˜²ç«å¢™æˆ–å®‰å…¨è½¯ä»¶é˜»æŒ¡ã€‚</p>
                                    <p><strong>ğŸ¯ è¯Šæ–­é‡ç‚¹ï¼š</strong>æ£€æŸ¥ç‰¹å®šç«¯å£çš„è¿é€šæ€§ã€é˜²ç«å¢™è§„åˆ™ã€å®‰å…¨è½¯ä»¶è®¾ç½®ã€‚</p>
                                    <p><strong>â±ï¸ æ—¶é—´å‹åŠ›ï¼š</strong>å‰©ä½™25åˆ†é’Ÿï¼Œå¿…é¡»å¿«é€Ÿå®šä½é—®é¢˜ã€‚</p>`,
                        nextCondition: "å‘ç°é˜²ç«å¢™é˜»æŒ¡äº†8443ç«¯å£"
                    },
                    3: {
                        title: "ç¬¬ä¸‰æ­¥ï¼šåº”ç”¨å±‚ä¸ä»£ç†é—®é¢˜æ’æŸ¥",
                        description: `<p><strong>âœ… è¿›å±•ï¼š</strong>è§£å†³äº†é˜²ç«å¢™é—®é¢˜ï¼Œä½†ä¸Šä¼ ä»ç„¶å¤±è´¥ã€‚</p>
                                    <p><strong>ğŸ”„ æ–°é—®é¢˜ï¼š</strong>ä¸Šä¼ æ–‡ä»¶å¡åœ¨0%ï¼Œè¿›åº¦æ¡ä¸åŠ¨ï¼Œå¯èƒ½æ˜¯ä»£ç†æˆ–DNSé—®é¢˜ã€‚</p>
                                    <p><strong>ğŸ”§ è¯Šæ–­ä»»åŠ¡ï¼š</strong>æ£€æŸ¥ä»£ç†è®¾ç½®ã€DNSè§£æã€æµè§ˆå™¨é…ç½®ã€ç³»ç»ŸæœåŠ¡ã€‚</p>
                                    <p><strong>âš ï¸ æ³¨æ„ï¼š</strong>å…¬å®‰ç³»ç»Ÿå¯èƒ½æœ‰ç‰¹æ®Šçš„ä»£ç†å’ŒDNSé…ç½®ã€‚</p>`,
                        nextCondition: "å‘ç°ä»£ç†æœåŠ¡å™¨è®¾ç½®é”™è¯¯ä¸”æ— å“åº”"
                    },
                    4: {
                        title: "ç¬¬å››æ­¥ï¼šç»¼åˆè§£å†³æ–¹æ¡ˆä¸éªŒè¯",
                        description: `<p><strong>ğŸ“Š æœ€ç»ˆè¯Šæ–­ï¼š</strong>å¤šé‡é—®é¢˜å¯¼è‡´ä¸Šä¼ å¤±è´¥ã€‚</p>
                                    <p><strong>ğŸ” æ ¹æœ¬åŸå› ï¼š</strong>1. é˜²ç«å¢™é˜»æŒ¡ç«¯å£ 2. ä»£ç†æœåŠ¡å™¨æ•…éšœ 3. DNSç¼“å­˜é—®é¢˜</p>
                                    <p><strong>ğŸš€ æœ€ç»ˆä»»åŠ¡ï¼š</strong>å®æ–½ç»¼åˆè§£å†³æ–¹æ¡ˆï¼ŒéªŒè¯æŠ¥å‘Šä¸Šä¼ åŠŸèƒ½ã€‚</p>
                                    <p><strong>ğŸ¯ æˆåŠŸæ ‡å‡†ï¼š</strong>æˆåŠŸä¸Šä¼ æµ‹è¯•æ–‡ä»¶ï¼Œç³»ç»Ÿæ˜¾ç¤º"ä¸Šä¼ æˆåŠŸ"ã€‚</p>
                                    <p><strong>â° å‰©ä½™æ—¶é—´ï¼š</strong>ä»…å‰©8åˆ†é’Ÿï¼</p>`,
                        nextCondition: "æŠ¥å‘ŠæˆåŠŸä¸Šä¼ è‡³æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿ"
                    }
                },
                clues: [
                    "é¦–å…ˆæµ‹è¯•æœ¬åœ°ç½‘ç»œè¿é€šæ€§ (ping 127.0.0.1)",
                    "æ£€æŸ¥ç½‘å…³è¿æ¥çŠ¶æ€ (ping ç½‘å…³åœ°å€)",
                    "æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿä½¿ç”¨8443ç«¯å£",
                    "å…¬å®‰å†…ç½‘æœ‰ç‹¬ç«‹çš„DNSæœåŠ¡å™¨",
                    "æ£€æŸ¥Windowsé˜²ç«å¢™å‡ºç«™è§„åˆ™",
                    "ä»£ç†æœåŠ¡å™¨å¯èƒ½å½±å“ä¸Šä¼ "
                ],
                solution: {
                    title: "ç´§æ€¥æŠ¥å‘Šæ— æ³•ä¸Šä¼ æ•…éšœè§£å†³æ–¹æ¡ˆ",
                    steps: [
                        "1. æ·»åŠ é˜²ç«å¢™ä¾‹å¤–è§„åˆ™ï¼šå…è®¸å‡ºç«™è¿æ¥åˆ°10.10.100.50:8443",
                        "2. ä¸´æ—¶ç¦ç”¨ä»£ç†æœåŠ¡å™¨è®¾ç½®ï¼šåœ¨Interneté€‰é¡¹ä¸­å–æ¶ˆä»£ç†",
                        "3. åˆ·æ–°DNSç¼“å­˜ï¼šæ‰§è¡Œå‘½ä»¤ 'ipconfig /flushdns'",
                        "4. é‡å¯ç›¸å…³æœåŠ¡ï¼šé‡å¯Windows UpdateæœåŠ¡å’ŒCryptographic Services",
                        "5. éªŒè¯è§£å†³æ–¹æ¡ˆï¼šæµ‹è¯•æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½"
                    ],
                    verification: "éªŒè¯æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ˜¯å¦æ¢å¤æ­£å¸¸"
                }
            },
            2: {
                name: "è§†é¢‘ç›‘æ§ä¸­æ–­",
                timeLimit: 45,
                steps: {
                    1: {
                        title: "ç¬¬ä¸€æ­¥ï¼šæ‘„åƒå¤´ç¦»çº¿æ£€æµ‹",
                        description: `<p><strong>ğŸ• æ—¶é—´ï¼š</strong>2025å¹´4æœˆ20æ—¥ 14:15ï¼ˆåˆé«˜å³°æ—¶æ®µï¼‰</p>
                                    <p><strong>ğŸ“ åœ°ç‚¹ï¼š</strong>å¸‚å±€æŒ‡æŒ¥ä¸­å¿ƒ</p>
                                    <p><strong>ğŸ“ ä»»åŠ¡ï¼š</strong>æŒ‡æŒ¥ä¸­å¿ƒå¤§å±æ˜¾ç¤ºå¤šä¸ªé‡ç‚¹åŒºåŸŸæ‘„åƒå¤´ç¦»çº¿ï¼ŒåŒ…æ‹¬äº¤é€šè¦é“å’Œå•†ä¸šåŒºã€‚</p>
                                    <p><strong>âŒ é—®é¢˜ï¼š</strong>ç›‘æ§ç³»ç»ŸæŠ¥è­¦ï¼Œæ˜¾ç¤º15ä¸ªæ‘„åƒå¤´ç¦»çº¿ï¼Œå½±å“å®æ—¶ç›‘æ§å’Œå…¬å…±å®‰å…¨ã€‚</p>
                                    <p><strong>ğŸ”„ å·²å°è¯•ï¼š</strong>é‡å¯ç›‘æ§æœåŠ¡å™¨ï¼Œéƒ¨åˆ†æ‘„åƒå¤´æ¢å¤ä½†ä»æœ‰8ä¸ªç¦»çº¿ã€‚</p>
                                    <div class="urgency-badge">
                                        <i class="fas fa-bell"></i> å±€é•¿æŒ‡ç¤ºï¼š1å°æ—¶å†…å¿…é¡»æ¢å¤ç›‘æ§ï¼
                                    </div>`,
                        nextCondition: "ç¡®è®¤æ‘„åƒå¤´ç¦»çº¿èŒƒå›´å¹¶æ”¶é›†è®¾å¤‡ä¿¡æ¯"
                    },
                    2: {
                        title: "ç¬¬äºŒæ­¥ï¼šäº¤æ¢æœºé—®é¢˜æ’æŸ¥",
                        description: `<p><strong>ğŸ” æ–°å‘ç°ï¼š</strong>ç¦»çº¿æ‘„åƒå¤´é›†ä¸­åœ¨åŒä¸€å°PoEäº¤æ¢æœºä¸Šã€‚</p>
                                    <p><strong>âš ï¸ å‡çº§é—®é¢˜ï¼š</strong>äº¤æ¢æœºç«¯å£çŠ¶æ€å¼‚å¸¸ï¼Œå¯èƒ½è®¾å¤‡æ•…éšœæˆ–é…ç½®é—®é¢˜ã€‚</p>
                                    <p><strong>ğŸ¯ è¯Šæ–­é‡ç‚¹ï¼š</strong>æ£€æŸ¥äº¤æ¢æœºçŠ¶æ€ã€ç«¯å£é…ç½®ã€VLANè®¾ç½®ã€ç”µæºçŠ¶æ€ã€‚</p>
                                    <p><strong>â±ï¸ æ—¶é—´å‹åŠ›ï¼š</strong>å‰©ä½™40åˆ†é’Ÿï¼Œé‡ç‚¹åŒºåŸŸç›‘æ§ç¼ºå¤±ã€‚</p>`,
                        nextCondition: "å‘ç°äº¤æ¢æœºç«¯å£çŠ¶æ€å¼‚å¸¸"
                    },
                    3: {
                        title: "ç¬¬ä¸‰æ­¥ï¼šç½‘ç»œç¯è·¯æ£€æµ‹",
                        description: `<p><strong>âœ… è¿›å±•ï¼š</strong>äº¤æ¢æœºé‡å¯åéƒ¨åˆ†æ‘„åƒå¤´æ¢å¤ï¼Œä½†ä»æœ‰é—®é¢˜ã€‚</p>
                                    <p><strong>ğŸ”„ æ–°é—®é¢˜ï¼š</strong>ç½‘ç»œå‡ºç°é—´æ­‡æ€§ä¸­æ–­ï¼Œå¯èƒ½æ˜¯ç¯è·¯æˆ–ç”Ÿæˆæ ‘é—®é¢˜ã€‚</p>
                                    <p><strong>ğŸ”§ è¯Šæ–­ä»»åŠ¡ï¼š</strong>æ£€æŸ¥ç”Ÿæˆæ ‘çŠ¶æ€ã€ç½‘ç»œæ‹“æ‰‘ã€å¹¿æ’­é£æš´æ£€æµ‹ã€‚</p>
                                    <p><strong>âš ï¸ æ³¨æ„ï¼š</strong>ç½‘ç»œç¯è·¯ä¼šå½±å“æ•´ä¸ªå­ç½‘æ€§èƒ½ã€‚</p>`,
                        nextCondition: "æ£€æµ‹åˆ°ç½‘ç»œç¯è·¯å¯¼è‡´å¹¿æ’­é£æš´"
                    },
                    4: {
                        title: "ç¬¬å››æ­¥ï¼šåº”æ€¥æ–¹æ¡ˆå®æ–½",
                        description: `<p><strong>ğŸ“Š æœ€ç»ˆè¯Šæ–­ï¼š</strong>äº¤æ¢æœºæ•…éšœå’Œç½‘ç»œç¯è·¯åŒé‡é—®é¢˜ã€‚</p>
                                    <p><strong>ğŸ” æ ¹æœ¬åŸå› ï¼š</strong>1. PoEäº¤æ¢æœºç”µæºæ¨¡å—æ•…éšœ 2. ç½‘ç»œç¯è·¯å¯¼è‡´å¹¿æ’­é£æš´</p>
                                    <p><strong>ğŸš€ æœ€ç»ˆä»»åŠ¡ï¼š</strong>å®æ–½åº”æ€¥æ–¹æ¡ˆï¼Œæ¢å¤å…³é”®ç›‘æ§ã€‚</p>
                                    <p><strong>ğŸ¯ æˆåŠŸæ ‡å‡†ï¼š</strong>æ‰€æœ‰å…³é”®åŒºåŸŸæ‘„åƒå¤´æ¢å¤åœ¨çº¿ã€‚</p>
                                    <p><strong>â° å‰©ä½™æ—¶é—´ï¼š</strong>ä»…å‰©15åˆ†é’Ÿï¼</p>`,
                        nextCondition: "å…³é”®ç›‘æ§æ‘„åƒå¤´å…¨éƒ¨æ¢å¤åœ¨çº¿"
                    }
                },
                clues: [
                    "æ£€æŸ¥æ ¸å¿ƒäº¤æ¢æœºçŠ¶æ€ (show interface)",
                    "éªŒè¯æ‘„åƒå¤´VLANé…ç½® (show vlan brief)",
                    "æ£€æµ‹ç½‘ç»œç¯è·¯ (show spanning-tree)",
                    "æ£€æŸ¥PoEäº¤æ¢æœºç”µæºçŠ¶æ€",
                    "æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯",
                    "æ£€æŸ¥äº¤æ¢æœºMACåœ°å€è¡¨"
                ],
                solution: {
                    title: "è§†é¢‘ç›‘æ§ä¸­æ–­æ•…éšœè§£å†³æ–¹æ¡ˆ",
                    steps: [
                        "1. éš”ç¦»ç½‘ç»œç¯è·¯ï¼šæ‰¾åˆ°å¹¶æ‹”é™¤å¯¼è‡´ç¯è·¯çš„ç½‘çº¿",
                        "2. é‡å¯ç”Ÿæˆæ ‘åè®®ï¼šåœ¨äº¤æ¢æœºä¸Šæ‰§è¡Œ 'spanning-tree reset'",
                        "3. æ›´æ¢æ•…éšœPoEæ¨¡å—ï¼šä½¿ç”¨å¤‡ç”¨PoEäº¤æ¢æœºæˆ–å¤–éƒ¨æ³¨å…¥å™¨",
                        "4. é‡æ–°åˆ†é…æ‘„åƒå¤´ï¼šå°†å…³é”®æ‘„åƒå¤´è½¬ç§»åˆ°æ­£å¸¸äº¤æ¢æœºç«¯å£",
                        "5. ç›‘æ§ç³»ç»Ÿæ¢å¤ï¼šæ£€æŸ¥æ‰€æœ‰æ‘„åƒå¤´åœ¨çº¿çŠ¶æ€"
                    ],
                    verification: "éªŒè¯å…³é”®åŒºåŸŸæ‘„åƒå¤´æ˜¯å¦å…¨éƒ¨æ¢å¤åœ¨çº¿"
                }
            },
            3: {
                name: "è­¦åŠ¡é€šæ— æ³•è”ç½‘",
                timeLimit: 35,
                steps: {
                    1: {
                        title: "ç¬¬ä¸€æ­¥ï¼šè®¾å¤‡åŸºç¡€æ£€æŸ¥",
                        description: `<p><strong>ğŸ• æ—¶é—´ï¼š</strong>2025å¹´5æœˆ10æ—¥ 08:30ï¼ˆæ—©é«˜å³°æ—¶æ®µï¼‰</p>
                                    <p><strong>ğŸ“ åœ°ç‚¹ï¼š</strong>å¸‚ä¸­å¿ƒäº¤é€šæ‰§å‹¤ç‚¹</p>
                                    <p><strong>ğŸ“ ä»»åŠ¡ï¼š</strong>æ‰§å‹¤ç‚¹æ‰€æœ‰è­¦åŠ¡é€šè®¾å¤‡æ— æ³•è¿æ¥ç§»åŠ¨ç½‘ç»œï¼Œæ— æ³•è¿›è¡Œäº¤é€šæŸ¥è¯¢ã€è½¦è¾†æ£€æŸ¥ç­‰å·¥ä½œã€‚</p>
                                    <p><strong>âŒ é—®é¢˜ï¼š</strong>8å°è­¦åŠ¡é€šå…¨éƒ¨æ˜¾ç¤º"æ— ç½‘ç»œè¿æ¥"ï¼Œå½±å“æ—©é«˜å³°äº¤é€šç–å¯¼å·¥ä½œã€‚</p>
                                    <p><strong>ğŸ”„ å·²å°è¯•ï¼š</strong>é‡å¯è®¾å¤‡ã€åˆ‡æ¢é£è¡Œæ¨¡å¼ï¼Œé—®é¢˜ä¾æ—§ã€‚</p>
                                    <div class="urgency-badge">
                                        <i class="fas fa-bell"></i> ç´§æ€¥æƒ…å†µï¼šæ—©é«˜å³°äº¤é€šç–å¯¼æ€¥éœ€è­¦åŠ¡é€šï¼
                                    </div>`,
                        nextCondition: "ç¡®è®¤æ‰€æœ‰è­¦åŠ¡é€šè®¾å¤‡éƒ½æ— æ³•è”ç½‘"
                    },
                    2: {
                        title: "ç¬¬äºŒæ­¥ï¼šç½‘ç»œé…ç½®è¯Šæ–­",
                        description: `<p><strong>ğŸ” æ–°å‘ç°ï¼š</strong>ä¸ªäººæ‰‹æœºåœ¨åŒä¸€ä½ç½®æœ‰ä¿¡å·ï¼Œä½†è­¦åŠ¡é€šæ— ä¿¡å·ã€‚</p>
                                    <p><strong>âš ï¸ å‡çº§é—®é¢˜ï¼š</strong>å¯èƒ½æ˜¯è­¦åŠ¡ä¸“ç”¨APNé…ç½®é—®é¢˜æˆ–SIMå¡é—®é¢˜ã€‚</p>
                                    <p><strong>ğŸ¯ è¯Šæ–­é‡ç‚¹ï¼š</strong>æ£€æŸ¥APNé…ç½®ã€SIMå¡çŠ¶æ€ã€ç½‘ç»œæ³¨å†Œã€æ•°æ®æœåŠ¡ã€‚</p>
                                    <p><strong>â±ï¸ æ—¶é—´å‹åŠ›ï¼š</strong>å‰©ä½™28åˆ†é’Ÿï¼Œäº¤é€šç–å¯¼å·¥ä½œå—å½±å“ã€‚</p>`,
                        nextCondition: "å‘ç°APNé…ç½®é”™è¯¯å¯¼è‡´æ— æ³•æ³¨å†Œç½‘ç»œ"
                    },
                    3: {
                        title: "ç¬¬ä¸‰æ­¥ï¼šè¿è¥å•†é—®é¢˜æ’æŸ¥",
                        description: `<p><strong>âœ… è¿›å±•ï¼š</strong>APNé…ç½®æ­£ç¡®ï¼Œä½†è­¦åŠ¡é€šä»æ— æ³•è”ç½‘ã€‚</p>
                                    <p><strong>ğŸ”„ æ–°é—®é¢˜ï¼š</strong>å¯èƒ½æ˜¯è¿è¥å•†ç½‘ç»œé—®é¢˜æˆ–è­¦åŠ¡ä¸“ç½‘æ•…éšœã€‚</p>
                                    <p><strong>ğŸ”§ è¯Šæ–­ä»»åŠ¡ï¼š</strong>è”ç³»è¿è¥å•†ã€æ£€æŸ¥åŸºç«™çŠ¶æ€ã€æµ‹è¯•å…¶ä»–é¢‘æ®µã€‚</p>
                                    <p><strong>âš ï¸ æ³¨æ„ï¼š</strong>è­¦åŠ¡ä¸“ç½‘å¯èƒ½æœ‰ç‰¹æ®Šç»´æŠ¤æˆ–æ•…éšœã€‚</p>`,
                        nextCondition: "ç¡®è®¤è¿è¥å•†åŸºç«™ç»´æŠ¤å¯¼è‡´è­¦åŠ¡ä¸“ç½‘ä¸­æ–­"
                    },
                    4: {
                        title: "ç¬¬å››æ­¥ï¼šåº”æ€¥æ–¹æ¡ˆå®æ–½",
                        description: `<p><strong>ğŸ“Š æœ€ç»ˆè¯Šæ–­ï¼š</strong>è¿è¥å•†åŸºç«™ç»´æŠ¤å¯¼è‡´è­¦åŠ¡ä¸“ç½‘ä¸­æ–­ã€‚</p>
                                    <p><strong>ğŸ” æ ¹æœ¬åŸå› ï¼š</strong>1. è¿è¥å•†åŸºç«™è®¡åˆ’å¤–ç»´æŠ¤ 2. è­¦åŠ¡ä¸“ç½‘åˆ‡æ¢å¤±è´¥</p>
                                    <p><strong>ğŸš€ æœ€ç»ˆä»»åŠ¡ï¼š</strong>å®æ–½åº”æ€¥é€šä¿¡æ–¹æ¡ˆï¼Œæ¢å¤è­¦åŠ¡é€šä¿¡ã€‚</p>
                                    <p><strong>ğŸ¯ æˆåŠŸæ ‡å‡†ï¼š</strong>è­¦åŠ¡é€šæ¢å¤åŸºæœ¬é€šä¿¡åŠŸèƒ½ã€‚</p>
                                    <p><strong>â° å‰©ä½™æ—¶é—´ï¼š</strong>ä»…å‰©10åˆ†é’Ÿï¼</p>`,
                        nextCondition: "è­¦åŠ¡é€šæ¢å¤åŸºæœ¬é€šä¿¡åŠŸèƒ½"
                    }
                },
                clues: [
                    "æ£€æŸ¥è­¦åŠ¡é€šä¿¡å·å¼ºåº¦ (signal strength)",
                    "éªŒè¯è­¦åŠ¡ä¸“ç”¨APNé…ç½® (show apn)",
                    "æ£€æŸ¥SIMå¡å’ŒIMSIçŠ¶æ€",
                    "æ‰«æå¯ç”¨çš„è¿è¥å•†ç½‘ç»œ",
                    "æ£€æŸ¥ç§»åŠ¨æ•°æ®æœåŠ¡çŠ¶æ€",
                    "è”ç³»è¿è¥å•†ç¡®è®¤ç½‘ç»œçŠ¶æ€"
                ],
                solution: {
                    title: "è­¦åŠ¡é€šæ— æ³•è”ç½‘æ•…éšœè§£å†³æ–¹æ¡ˆ",
                    steps: [
                        "1. åˆ‡æ¢APNé…ç½®ï¼šä¸´æ—¶ä½¿ç”¨å…¬å…±ç½‘ç»œAPNï¼ˆcmnetï¼‰",
                        "2. é‡å¯ç½‘ç»œæœåŠ¡ï¼šåœ¨è­¦åŠ¡é€šä¸Šé‡ç½®ç½‘ç»œè®¾ç½®",
                        "3. éƒ¨ç½²åº”æ€¥é€šä¿¡è®¾å¤‡ï¼šå¯ç”¨ä¾¿æºå¼åŸºç«™æˆ–å«æ˜Ÿé€šä¿¡",
                        "4. åè°ƒè¿è¥å•†ï¼šè¦æ±‚ä¼˜å…ˆæ¢å¤è­¦åŠ¡ä¸“ç½‘æœåŠ¡",
                        "5. éªŒè¯é€šä¿¡æ¢å¤ï¼šæµ‹è¯•è­¦åŠ¡é€šåŸºæœ¬é€šä¿¡åŠŸèƒ½"
                    ],
                    verification: "éªŒè¯è­¦åŠ¡é€šæ˜¯å¦æ¢å¤åŸºæœ¬é€šä¿¡åŠŸèƒ½"
                }
            }
        };
        
        // æ–‡ä»¶é…ç½®
        const files = {
            'case-report': { name: 'æ¡ˆä»¶æŠ¥å‘Š.docx', size: '256 KB', icon: 'fa-file-alt' },
            'scene-photo': { name: 'ç°åœºç…§ç‰‡.jpg', size: '1.8 MB', icon: 'fa-camera' },
            'video-evidence': { name: 'è§†é¢‘è¯æ®.mp4', size: '15.2 MB', icon: 'fa-video' }
        };
        
        // ====== åˆå§‹åŒ–å‡½æ•° ======
        document.addEventListener('DOMContentLoaded', function() {
            loadScenario(1);
            startTimer();
            initializeScenario2();
            initializeScenario3();
        });
        
        // ====== åœºæ™¯ç®¡ç†å‡½æ•° ======
        function loadScenario(scenarioId) {
            currentScenario = scenarioId;
            
            // æ›´æ–°åœºæ™¯é€‰æ‹©å™¨
            document.querySelectorAll('.scenario-card').forEach((card, index) => {
                if (index === scenarioId - 1) {
                    card.classList.add('active');
                } else {
                    card.classList.remove('active');
                }
            });
            
            // æ˜¾ç¤ºå¯¹åº”åœºæ™¯
            document.querySelectorAll('.scenario-container').forEach(container => {
                container.classList.remove('active');
            });
            document.getElementById(`scenario${scenarioId}`).classList.add('active');
            
            // æ ¹æ®åœºæ™¯é‡ç½®æ•°æ®
            if (scenarioId === 1) {
                resetScenario1();
                startTimer();
            } else if (scenarioId === 2) {
                resetScenario2();
                startScenario2Timer();
            } else if (scenarioId === 3) {
                resetScenario3();
                startScenario3Timer();
            }
            
            showFeedback(`åœºæ™¯åŠ è½½æˆåŠŸ: ${scenarios[scenarioId].name}`, 'success');
        }
        
        function resetScenario1() {
            score = 100;
            discoveredClues.clear();
            discoveredClues.add(scenarios[1].clues[0]);
            completedSteps.clear();
            completedSteps.add(1);
            uploadSuccess = false;
            isUploadInProgress = false;
            currentStep = 1;
            
            timeRemaining = scenarios[1].timeLimit * 60;
            updateTimeDisplay();
            
            loadStep(1);
            updateClueList();
            updateStepTracker();
            updateScoreDisplay();
            updateProgressDots();
            updateNextStepButton();
            
            // éšè—è§£å†³æ–¹æ¡ˆåŒºåŸŸ
            document.getElementById('solution-area').style.display = 'none';
            
            clearTerminal();
            addTerminalOutput(`è­¦åŠ¡ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ v2.5\nåœºæ™¯åŠ è½½: ${scenarios[1].name}\nå¼€å§‹æ—¶é—´: ${new Date().toLocaleTimeString()}\n==============================\n`, 'output');
        }
        
        function resetScenario2() {
            scenario2Score = 100;
            scenario2DiscoveredClues.clear();
            scenario2DiscoveredClues.add(scenarios[2].clues[0]);
            scenario2CompletedSteps.clear();
            scenario2CompletedSteps.add(1);
            scenario2Step = 1;
            
            scenario2TimeRemaining = scenarios[2].timeLimit * 60;
            updateScenario2TimeDisplay();
            
            loadScenario2Step(1);
            updateScenario2ClueList();
            updateScenario2StepTracker();
            updateScenario2ScoreDisplay();
            updateScenario2ProgressDots();
            updateScenario2NextStepButton();
            
            // éšè—è§£å†³æ–¹æ¡ˆåŒºåŸŸ
            document.getElementById('scenario2-solution-area').style.display = 'none';
            
            clearScenario2Terminal();
            addScenario2TerminalOutput(`è§†é¢‘ç›‘æ§ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ v3.2\nåœºæ™¯åŠ è½½: ${scenarios[2].name}\nå¼€å§‹æ—¶é—´: ${new Date().toLocaleTimeString()}\n==============================\n`, 'output');
        }
        
        function resetScenario3() {
            scenario3Score = 100;
            scenario3DiscoveredClues.clear();
            scenario3DiscoveredClues.add(scenarios[3].clues[0]);
            scenario3CompletedSteps.clear();
            scenario3CompletedSteps.add(1);
            scenario3Step = 1;
            
            scenario3TimeRemaining = scenarios[3].timeLimit * 60;
            updateScenario3TimeDisplay();
            
            loadScenario3Step(1);
            updateScenario3ClueList();
            updateScenario3StepTracker();
            updateScenario3ScoreDisplay();
            updateScenario3ProgressDots();
            updateScenario3NextStepButton();
            
            // éšè—è§£å†³æ–¹æ¡ˆåŒºåŸŸ
            document.getElementById('scenario3-solution-area').style.display = 'none';
            
            clearScenario3Terminal();
            addScenario3TerminalOutput(`è­¦åŠ¡é€šç§»åŠ¨ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ v4.1\nåœºæ™¯åŠ è½½: ${scenarios[3].name}\nå¼€å§‹æ—¶é—´: ${new Date().toLocaleTimeString()}\n==============================\n`, 'output');
        }
        
        // ====== åœºæ™¯1å‡½æ•° ======
        function loadStep(stepNumber) {
            currentStep = stepNumber;
            const scenario = scenarios[currentScenario];
            const step = scenario.steps[stepNumber];
            
            // æ›´æ–°ç•Œé¢
            document.getElementById('step-title').textContent = step.title;
            document.getElementById('step-description').innerHTML = step.description;
            
            // æ˜¾ç¤ºæˆ–éšè—ä¸Šä¼ æµ‹è¯•åŒºåŸŸ
            const uploadArea = document.getElementById('upload-test-area');
            if (stepNumber === 4) {
                uploadArea.style.display = 'block';
                resetUpload();
            } else {
                uploadArea.style.display = 'none';
            }
            
            // æ›´æ–°æ­¥éª¤è·Ÿè¸ªå™¨
            updateStepTracker();
            
            // æ›´æ–°è¿›åº¦ç‚¹
            updateProgressDots();
            
            // æ·»åŠ æ–°çš„çº¿ç´¢æç¤º
            if (stepNumber > 1 && stepNumber <= scenario.clues.length) {
                addClue(scenario.clues[stepNumber - 1], true);
            }
            
            // æ›´æ–°ç»ˆç«¯æç¤º
            addTerminalOutput(`\n=== æ­¥éª¤ ${stepNumber}: ${step.title} ===\n${step.description.replace(/<[^>]*>/g, '').substring(0, 150)}...\n`, 'output');
            
            // æ›´æ–°ä¸‹ä¸€æ­¥æŒ‰é’®
            updateNextStepButton();
            
            showFeedback(`è¿›å…¥æ­¥éª¤ ${stepNumber}: ${step.title}`, 'success');
        }
        
        function updateStepTracker() {
            const tracker = document.getElementById('step-tracker');
            const items = tracker.querySelectorAll('.step-item');
            
            items.forEach((item, index) => {
                item.classList.remove('active', 'completed');
                const stepNum = index + 1;
                
                if (completedSteps.has(stepNum)) {
                    item.classList.add('completed');
                } else if (stepNum === currentStep) {
                    item.classList.add('active');
                }
            });
            
            document.getElementById('step-count').textContent = `${completedSteps.size}/${totalSteps}`;
        }
        
        function updateProgressDots() {
            for (let i = 1; i <= totalSteps; i++) {
                const dot = document.getElementById(`step${i}-dot`);
                if (dot) {
                    dot.classList.remove('completed', 'active');
                    if (completedSteps.has(i)) {
                        dot.classList.add('completed');
                    } else if (i === currentStep) {
                        dot.classList.add('active');
                    }
                }
            }
        }
        
        function updateNextStepButton() {
            const btn = document.getElementById('next-step-btn');
            const hint = document.getElementById('next-step-hint');
            
            if (completedSteps.has(currentStep) && currentStep < totalSteps) {
                btn.disabled = false;
                const nextStep = scenarios[currentScenario].steps[currentStep + 1];
                hint.textContent = `å‡†å¤‡è¿›å…¥æ­¥éª¤ ${currentStep + 1}: ${nextStep.title}`;
            } else if (currentStep === totalSteps && completedSteps.has(currentStep)) {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-flag-checkered"></i> å®Œæˆæ‰€æœ‰è¯Šæ–­';
                hint.textContent = 'æ­å–œå®Œæˆæ‰€æœ‰è¯Šæ–­æ­¥éª¤ï¼ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹æ€»ç»“';
            } else {
                btn.disabled = true;
                const step = scenarios[currentScenario].steps[currentStep];
                hint.textContent = `éœ€è¦å®Œæˆå½“å‰æ­¥éª¤: ${step.nextCondition}`;
            }
        }
        
        function advanceStep() {
            if (!completedSteps.has(currentStep)) {
                showFeedback('è¯·å…ˆå®Œæˆå½“å‰æ­¥éª¤çš„è¯Šæ–­', 'warning');
                return;
            }
            
            if (currentStep < totalSteps) {
                loadStep(currentStep + 1);
            } else {
                showScenario1Solution();
            }
        }
        
        function showScenario1Solution() {
            const solution = scenarios[1].solution;
            const solutionContent = document.getElementById('solution-content');
            
            let html = `<p><strong>æ ¹æœ¬åŸå› åˆ†æï¼š</strong></p>
                       <p>ç»è¿‡è¯Šæ–­å‘ç°ä¸‰é‡é—®é¢˜å¯¼è‡´æŠ¥å‘Šæ— æ³•ä¸Šä¼ ï¼š</p>
                       <ol style="margin-left: 20px; margin-bottom: 15px;">`;
            
            solution.steps.forEach(step => {
                html += `<li class="solution-step">${step}</li>`;
            });
            
            html += `</ol>
                    <p><strong>å®æ–½æ­¥éª¤ï¼š</strong></p>
                    <p>è¯·æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸Šè§£å†³æ–¹æ¡ˆæ­¥éª¤ã€‚</p>`;
            
            solutionContent.innerHTML = html;
            
            // æ˜¾ç¤ºè§£å†³æ–¹æ¡ˆåŒºåŸŸ
            document.getElementById('solution-area').style.display = 'block';
            
            // æ›´æ–°ä¸‹ä¸€æ­¥æŒ‰é’®
            const btn = document.getElementById('next-step-btn');
            const hint = document.getElementById('next-step-hint');
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-check-circle"></i> éªŒè¯æ–‡ä»¶ä¸Šä¼ ';
            btn.onclick = function() { startUpload(); };
            hint.textContent = 'æ‰§è¡Œè§£å†³æ–¹æ¡ˆåï¼Œç‚¹å‡»æŒ‰é’®æµ‹è¯•æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½';
            
            showFeedback('ğŸ¯ è¯Šæ–­å®Œæˆï¼è¯·æŸ¥çœ‹è§£å†³æ–¹æ¡ˆå¹¶å®æ–½', 'success');
        }
        
        function verifyScenario1Solution() {
            const resultDiv = document.getElementById('verification-result');
            
            if (uploadSuccess) {
                resultDiv.className = 'test-result success';
                resultDiv.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <div>
                        <strong>éªŒè¯æˆåŠŸï¼</strong>
                        <div style="font-size: 12px; margin-top: 5px; color: #a5d6a7;">
                            æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½å·²å®Œå…¨æ¢å¤ï¼<br>
                            æ¡ˆä»¶æŠ¥å‘ŠæˆåŠŸä¸Šä¼ è‡³æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿã€‚<br>
                            ä¸Šä¼ æ—¶é—´: ${new Date().toLocaleTimeString()}<br>
                            æ¡ˆä»¶ç¼–å·: PD20250315001
                        </div>
                    </div>
                `;
                
                // æ˜¾ç¤ºæœ€ç»ˆå®Œæˆæ¶ˆæ¯
                setTimeout(() => {
                    showFeedback('ğŸ† æ­å–œï¼ç´§æ€¥æŠ¥å‘Šä¸Šä¼ æ•…éšœå®Œå…¨è§£å†³ï¼', 'success');
                    updateScore(100);
                }, 1000);
                
            } else {
                resultDiv.className = 'test-result failure';
                resultDiv.innerHTML = `
                    <i class="fas fa-times-circle"></i>
                    <div>
                        <strong>éªŒè¯å¤±è´¥ï¼</strong>
                        <div style="font-size: 12px; margin-top: 5px; color: #ffcdd2;">
                            æ–‡ä»¶ä¸Šä¼ ä»ç„¶å¤±è´¥ï¼Œè¯·æ£€æŸ¥è§£å†³æ–¹æ¡ˆæ˜¯å¦æ­£ç¡®å®æ–½ã€‚<br>
                            å¯èƒ½éœ€è¦é‡æ–°æ‰§è¡ŒæŸäº›æ­¥éª¤æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚
                        </div>
                    </div>
                `;
            }
        }
        
        // ====== åœºæ™¯1åŸæœ‰å‡½æ•° ======
        function selectFile(fileId) {
            selectedFile = fileId;
            document.querySelectorAll('.file-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.closest('.file-option').classList.add('active');
            const file = files[fileId];
            document.getElementById('file-size').textContent = `å¤§å°: ${file.size}`;
            showFeedback(`å·²é€‰æ‹©æ–‡ä»¶: ${file.name}`, 'success');
        }
        
        function startUpload() {
            if (isUploadInProgress) {
                showFeedback('ä¸Šä¼ æ­£åœ¨è¿›è¡Œä¸­ï¼Œè¯·ç­‰å¾…å®Œæˆ', 'warning');
                return;
            }
            
            const uploadBtn = document.getElementById('upload-btn');
            const uploadArea = document.getElementById('upload-test-area');
            const progressContainer = document.getElementById('upload-progress');
            const progressBar = document.getElementById('progress-bar');
            const progressPercent = document.getElementById('progress-percent');
            const uploadSpeed = document.getElementById('upload-speed');
            const uploadTime = document.getElementById('upload-time');
            const uploadStatus = document.getElementById('upload-status');
            
            uploadBtn.disabled = true;
            uploadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ä¸Šä¼ ä¸­...';
            uploadArea.classList.remove('success');
            uploadArea.classList.add('uploading');
            uploadStatus.className = 'upload-status';
            uploadStatus.style.display = 'none';
            
            progressContainer.style.display = 'block';
            progressBar.style.width = '0%';
            progressPercent.textContent = '0%';
            
            isUploadInProgress = true;
            
            const fileInfo = files[selectedFile];
            const fileSize = parseFloat(fileInfo.size);
            const unit = fileInfo.size.split(' ')[1];
            let bytes = fileSize * (unit === 'KB' ? 1024 : unit === 'MB' ? 1024 * 1024 : 1);
            
            let progress = 0;
            const totalSteps = 100;
            const stepTime = 50;
            
            const uploadInterval = setInterval(() => {
                progress += 1;
                progressBar.style.width = progress + '%';
                progressPercent.textContent = progress + '%';
                const speed = Math.random() * 500 + 100;
                const remaining = ((100 - progress) / 100) * (bytes / speed) * 10;
                uploadSpeed.textContent = `é€Ÿåº¦: ${Math.round(speed)} KB/s`;
                uploadTime.textContent = `æ—¶é—´: ${Math.round(remaining)}s`;
                
                if (progress >= 100) {
                    clearInterval(uploadInterval);
                    uploadSuccess = true;
                    progressBar.style.background = 'linear-gradient(90deg, var(--police-accent), var(--police-success))';
                    uploadBtn.disabled = false;
                    uploadBtn.className = 'upload-btn success';
                    uploadBtn.innerHTML = '<i class="fas fa-check-circle"></i> ä¸Šä¼ æˆåŠŸ';
                    uploadArea.classList.remove('uploading');
                    uploadArea.classList.add('success');
                    uploadStatus.className = 'upload-status success';
                    uploadStatus.innerHTML = `
                        <i class="fas fa-check-circle"></i>
                        <div>
                            <strong>ä¸Šä¼ æˆåŠŸï¼</strong>
                            <div style="font-size: 12px; margin-top: 5px; color: #a5d6a7;">
                                æ–‡ä»¶å·²æˆåŠŸä¸Šä¼ è‡³æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿã€‚æ¡ˆä»¶ç¼–å·: PD20250315001<br>
                                ä¸Šä¼ æ—¶é—´: ${new Date().toLocaleTimeString()}
                            </div>
                        </div>
                    `;
                    uploadStatus.style.display = 'block';
                    addTerminalOutput(`æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼`, 'success');
                    addTerminalOutput(`æ–‡ä»¶: ${fileInfo.name}`, 'output');
                    addTerminalOutput(`å¤§å°: ${fileInfo.size}`, 'output');
                    addTerminalOutput(`æ—¶é—´: ${new Date().toLocaleTimeString()}`, 'output');
                    addTerminalOutput(`éªŒè¯: âœ… æŒ‡æŒ¥ä¸­å¿ƒç³»ç»Ÿå·²æ¥æ”¶æ–‡ä»¶`, 'success');
                    updateScore(50);
                    addClue('æ–‡ä»¶ä¸Šä¼ éªŒè¯æˆåŠŸï¼Œæ‰€æœ‰é—®é¢˜å·²è§£å†³', true);
                    checkStepCompletion();
                    showFeedback('ğŸ‰ æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼æŒ‡æŒ¥ä¸­å¿ƒå·²æ¥æ”¶æ¡ˆä»¶æŠ¥å‘Š', 'success');
                    isUploadInProgress = false;
                }
            }, stepTime);
            
            addTerminalOutput(`å¼€å§‹ä¸Šä¼ æ–‡ä»¶: ${fileInfo.name} (${fileInfo.size})`, 'command');
        }
        
        function resetUpload() {
            if (isUploadInProgress) {
                showFeedback('è¯·ç­‰å¾…ä¸Šä¼ å®Œæˆ', 'warning');
                return;
            }
            
            const uploadBtn = document.getElementById('upload-btn');
            const uploadArea = document.getElementById('upload-test-area');
            const progressContainer = document.getElementById('upload-progress');
            const progressBar = document.getElementById('progress-bar');
            const progressPercent = document.getElementById('progress-percent');
            const uploadStatus = document.getElementById('upload-status');
            const uploadSpeed = document.getElementById('upload-speed');
            const uploadTime = document.getElementById('upload-time');
            
            uploadBtn.disabled = false;
            uploadBtn.className = 'upload-btn';
            uploadBtn.innerHTML = '<i class="fas fa-cloud-upload-alt"></i> å¼€å§‹ä¸Šä¼ ';
            uploadArea.className = 'upload-test-area';
            progressContainer.style.display = 'none';
            progressBar.style.width = '0%';
            progressBar.style.background = 'linear-gradient(90deg, var(--police-accent), var(--police-success))';
            progressPercent.textContent = '0%';
            uploadStatus.className = 'upload-status';
            uploadStatus.style.display = 'none';
            uploadSpeed.textContent = 'é€Ÿåº¦: -- KB/s';
            uploadTime.textContent = 'æ—¶é—´: --';
            uploadSuccess = false;
            isUploadInProgress = false;
            showFeedback('ä¸Šä¼ æµ‹è¯•å·²é‡ç½®', 'info');
        }
        
        function executeCommand() {
            const input = document.getElementById('command-input');
            const command = input.value.trim();
            if (!command) {
                showFeedback('è¯·è¾“å…¥å‘½ä»¤', 'warning');
                return;
            }
            addTerminalOutput(`C:\\PoliceNet\\Diagnosis> ${command}`, 'command');
            const response = processCommand(command);
            addTerminalOutput(response.output, response.type);
            if (response.effect) response.effect();
            input.value = '';
            checkStepCompletion();
        }
        
        function processCommand(command) {
            const cmd = command.toLowerCase();
            let response = { output: '', type: 'output', effect: null };
            
            if (cmd === 'ping 127.0.0.1') {
                response.output = `æ­£åœ¨ Ping 127.0.0.1 å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:
æ¥è‡ª 127.0.0.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´<1ms TTL=128
æ¥è‡ª 127.0.0.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´<1ms TTL=128
æ¥è‡ª 127.0.0.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´<1ms TTL=128
æ¥è‡ª 127.0.0.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´<1ms TTL=128

127.0.0.1 çš„ Ping ç»Ÿè®¡ä¿¡æ¯:
    æ•°æ®åŒ…: å·²å‘é€ = 4ï¼Œå·²æ¥æ”¶ = 4ï¼Œä¸¢å¤± = 0 (0% ä¸¢å¤±)ï¼Œ
å¾€è¿”è¡Œç¨‹çš„ä¼°è®¡æ—¶é—´(ä»¥æ¯«ç§’ä¸ºå•ä½):
    æœ€çŸ­ = 0msï¼Œæœ€é•¿ = 0msï¼Œå¹³å‡ = 0ms`;
                response.effect = () => {
                    addClue('æœ¬åœ°ç½‘ç»œåè®®æ ˆå·¥ä½œæ­£å¸¸');
                    updateScore(5);
                };
            }
            else if (cmd === 'ping 10.10.1.1') {
                response.output = `æ­£åœ¨ Ping 10.10.1.1 å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:
æ¥è‡ª 10.10.1.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=2ms TTL=64
æ¥è‡ª 10.10.1.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=1ms TTL=64
æ¥è‡ª 10.10.1.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=3ms TTL=64
æ¥è‡ª 10.10.1.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=1ms TTL=64

10.10.1.1 çš„ Ping ç»Ÿè®¡ä¿¡æ¯:
    æ•°æ®åŒ…: å·²å‘é€ = 4ï¼Œå·²æ¥æ”¶ = 4ï¼Œä¸¢å¤± = 0 (0% ä¸¢å¤±)ï¼Œ
å¾€è¿”è¡Œç¨‹çš„ä¼°è®¡æ—¶é—´(ä»¥æ¯«ç§’ä¸ºå•ä½):
    æœ€çŸ­ = 1msï¼Œæœ€é•¿ = 3msï¼Œå¹³å‡ = 1ms`;
                response.effect = () => {
                    addClue('ç½‘å…³è¿æ¥æ­£å¸¸ï¼Œæœ¬åœ°ç½‘ç»œæ— é—®é¢˜');
                    updateScore(5);
                };
            }
            else if (cmd === 'ipconfig') {
                response.output = `Windows IP é…ç½®

ä»¥å¤ªç½‘é€‚é…å™¨ ä»¥å¤ªç½‘:

   è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . : police.local
   æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::d123:e456:f789:g012%12
   IPv4 åœ°å€ . . . . . . . . . . . . : 10.10.1.50
   å­ç½‘æ©ç   . . . . . . . . . . . . : 255.255.255.0
   é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 10.10.1.1
   DHCP æœåŠ¡å™¨ . . . . . . . . . . . : 10.10.1.1
   DNS æœåŠ¡å™¨  . . . . . . . . . . . : 10.10.10.10
                                       10.10.10.11`;
                response.effect = () => {
                    addClue('IPé…ç½®æ­£å¸¸ï¼ŒDHCPå’ŒDNSå·¥ä½œæ­£å¸¸');
                    updateScore(5);
                };
            }
            else if (cmd === 'telnet 10.10.100.50 8443' && currentStep >= 2) {
                response.output = `æ­£åœ¨è¿æ¥10.10.100.50...æ— æ³•æ‰“å¼€åˆ°ä¸»æœºçš„è¿æ¥ã€‚ åœ¨ç«¯å£ 8443: è¿æ¥å¤±è´¥

è¯Šæ–­: ç«¯å£8443è¢«é˜²ç«å¢™æˆ–å®‰å…¨è½¯ä»¶é˜»æŒ¡`;
                response.type = 'error';
                response.effect = () => {
                    addClue('æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿçš„8443ç«¯å£æ— æ³•è¿æ¥', true);
                    updateScore(10);
                };
            }
            else if (cmd.includes('netsh advfirewall show rule') && currentStep >= 2) {
                response.output = `é«˜çº§å®‰å…¨ Windows é˜²ç«å¢™è§„åˆ™æŸ¥è¯¢:
================================
è§„åˆ™åç§°: é˜»æ­¢æ¡ˆä»¶ç³»ç»Ÿç«¯å£
å·²å¯ç”¨: æ˜¯
æ–¹å‘: å‡ºç«™
æ“ä½œ: é˜»æ­¢
åè®®: TCP
æœ¬åœ°ç«¯å£: ä»»æ„
è¿œç¨‹ç«¯å£: 8443
è¿œç¨‹IPåœ°å€: 10.10.100.50
é…ç½®æ–‡ä»¶: åŸŸ,ä¸“ç”¨,å…¬ç”¨
ç»„: ç³»ç»Ÿè§„åˆ™
æè¿°: è‡ªåŠ¨åˆ›å»ºçš„å‡ºç«™é˜»æŒ¡è§„åˆ™

å‘ç°å…³é”®é—®é¢˜: æ­¤è§„åˆ™é˜»æŒ¡äº†åˆ°æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿçš„è¿æ¥!`;
                response.type = 'warning';
                response.effect = () => {
                    addClue('é˜²ç«å¢™å‡ºç«™è§„åˆ™é˜»æŒ¡äº†8443ç«¯å£', true);
                    updateScore(15);
                };
            }
            else if (cmd === 'help' || cmd === '?') {
                response.output = `å¯ç”¨å‘½ä»¤:
================================
åŸºç¡€è¯Šæ–­:
  ping <ç›®æ ‡>         æµ‹è¯•ç½‘ç»œè¿é€šæ€§
  ipconfig           æ˜¾ç¤ºIPé…ç½®
  tracert <ç›®æ ‡>     è·¯ç”±è¿½è¸ª
  nslookup <åŸŸå>    DNSæŸ¥è¯¢

é«˜çº§è¯Šæ–­:
  telnet <IP> <ç«¯å£> æµ‹è¯•ç«¯å£è¿é€šæ€§
  netsh advfirewall  é˜²ç«å¢™ç®¡ç†
  proxycfg           ä»£ç†é…ç½®
  netstat -an        ç½‘ç»œè¿æ¥çŠ¶æ€

ç³»ç»Ÿå·¥å…·:
  help               æ˜¾ç¤ºæ­¤å¸®åŠ©
  clear              æ¸…å±
  status             æ˜¾ç¤ºå½“å‰çŠ¶æ€
  hint               è·å–æç¤º`;
            }
            else if (cmd === 'clear' || cmd === 'cls') {
                clearTerminal();
                return {output: '', type: 'output', effect: null};
            }
            else if (cmd === 'status') {
                response.output = `å½“å‰çŠ¶æ€:
åœºæ™¯: ${scenarios[currentScenario].name}
æ­¥éª¤: ${currentStep}/${totalSteps}
ç§¯åˆ†: ${score}
çº¿ç´¢: ${discoveredClues.size}
æ—¶é—´å‰©ä½™: ${Math.floor(timeRemaining/60)}:${(timeRemaining%60).toString().padStart(2,'0')}
ä¸Šä¼ æµ‹è¯•: ${uploadSuccess ? 'âœ… å·²æˆåŠŸ' : 'âŒ æœªå®Œæˆ'}`;
            }
            else if (cmd === 'hint') {
                const scenario = scenarios[currentScenario];
                const availableClues = scenario.clues.filter(clue => !discoveredClues.has(clue));
                if (availableClues.length > 0) {
                    response.output = `æç¤º: ${availableClues[0]}`;
                    response.effect = () => {
                        addClue(availableClues[0]);
                        updateScore(-5);
                    };
                } else {
                    response.output = 'æš‚æ— æ–°æç¤ºï¼Œè¯·ç»§ç»­æ¢ç´¢ã€‚';
                }
            }
            else {
                response.output = `'${command}' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åºæˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚\nè¾“å…¥ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤ã€‚`;
                response.type = 'error';
                response.effect = () => updateScore(-2);
            }
            
            return response;
        }
        
        function runQuickCommand(command) {
            document.getElementById('command-input').value = command;
            executeCommand();
        }
        
        function runTool(toolName) {
            let output = '';
            let effect = null;
            
            switch(toolName) {
                case 'connectivity':
                    output = `ç½‘ç»œè¿é€šæ€§æµ‹è¯•æŠ¥å‘Š:
================================
1. æœ¬åœ°å›ç¯æµ‹è¯•: âœ“ é€šè¿‡ (0ms)
2. ç½‘å…³è¿é€šæ€§: âœ“ é€šè¿‡ (å¹³å‡: 1ms)
3. DNSæœåŠ¡å™¨: âœ“ é€šè¿‡
4. äº’è”ç½‘è®¿é—®: âœ“ é€šè¿‡
5. æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿ: âœ— å¤±è´¥ (ç«¯å£8443æ— æ³•è¿æ¥)

ç»“è®º: åŸºç¡€ç½‘ç»œæ­£å¸¸ï¼Œä½†ç‰¹å®šæœåŠ¡ç«¯å£æ— æ³•è®¿é—®ã€‚
å»ºè®®: æ£€æŸ¥é˜²ç«å¢™å’Œä»£ç†è®¾ç½®ã€‚`;
                    effect = () => {
                        addClue('ç½‘ç»œè¿é€šæ€§æµ‹è¯•æ˜¾ç¤º8443ç«¯å£é—®é¢˜', true);
                        updateScore(10);
                    };
                    break;
                case 'firewall':
                    output = `é˜²ç«å¢™æ£€æŸ¥å·¥å…·æŠ¥å‘Š:
================================
Windows Defender é˜²ç«å¢™çŠ¶æ€: å¯ç”¨
é…ç½®æ–‡ä»¶: åŸŸ/ä¸“ç”¨/å…¬ç”¨ (å…¨éƒ¨å¯ç”¨)

å‘ç°å…³é”®è§„åˆ™:
è§„åˆ™åç§°: "é˜»æ­¢æ¡ˆä»¶ç³»ç»Ÿç«¯å£"
æ–¹å‘: å‡ºç«™
æ“ä½œ: é˜»æ­¢
åè®®: TCP
è¿œç¨‹ç«¯å£: 8443
è¿œç¨‹IP: 10.10.100.50
çŠ¶æ€: å·²å¯ç”¨

é—®é¢˜: æ­¤è§„åˆ™é˜»æŒ¡äº†æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿçš„è¿æ¥!
è§£å†³æ–¹æ¡ˆ: ç¦ç”¨æ­¤è§„åˆ™æˆ–æ·»åŠ ä¾‹å¤–ã€‚`;
                    effect = () => {
                        addClue('é˜²ç«å¢™å·¥å…·ç¡®è®¤è§„åˆ™é˜»æŒ¡', true);
                        updateScore(15);
                    };
                    break;
                case 'portscan':
                    output = `ç«¯å£æ‰«ææŠ¥å‘Š (ç›®æ ‡: 10.10.100.50):
================================
ç«¯å£æ‰«æä¸­... [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%

æ‰«æç»“æœ:
21/tcp   : å…³é—­     FTP
22/tcp   : å…³é—­     SSH
80/tcp   : å¼€æ”¾     HTTP (æ¬¢è¿é¡µé¢)
443/tcp  : å¼€æ”¾     HTTPS (è¯ä¹¦æœ‰æ•ˆ)
8443/tcp : è¿‡æ»¤     å¯èƒ½æ˜¯é˜²ç«å¢™é˜»æŒ¡
3389/tcp : å…³é—­     RDP

è¯¦ç»†åˆ†æ:
- 8443ç«¯å£çŠ¶æ€: FILTERED (è¿‡æ»¤)
- å¯èƒ½åŸå› : ä¸­é—´é˜²ç«å¢™ã€æœ¬åœ°é˜²ç«å¢™ã€å®‰å…¨è½¯ä»¶
- å»ºè®®: æ£€æŸ¥æœ¬åœ°å’Œç½‘ç»œé˜²ç«å¢™è®¾ç½®`;
                    effect = () => updateScore(10);
                    break;
                case 'proxy':
                    output = `ä»£ç†æ£€æµ‹æŠ¥å‘Š:
================================
ç³»ç»Ÿä»£ç†è®¾ç½®æ£€æµ‹ä¸­...

æ£€æµ‹ç»“æœ:
- ä»£ç†æœåŠ¡å™¨: proxy.police.gov.cn:8080
- ä»£ç†å¯ç”¨: æ˜¯
- ä»£ç†æµ‹è¯•: âœ— è¿æ¥å¤±è´¥ (è¶…æ—¶: 10ç§’)
- ç»•è¿‡åˆ—è¡¨: *.local;10.*

é—®é¢˜åˆ†æ:
1. ä»£ç†æœåŠ¡å™¨æ— å“åº”
2. å¯èƒ½åŸå› : ä»£ç†æœåŠ¡å™¨æ•…éšœã€ç½‘ç»œé—®é¢˜ã€é…ç½®é”™è¯¯
3. å½±å“: æ‰€æœ‰HTTP/HTTPSæµé‡éƒ½ä¼šè¢«ä»£ç†æ‹¦æˆª

ç´§æ€¥è§£å†³æ–¹æ¡ˆ:
1. ä¸´æ—¶ç¦ç”¨ä»£ç†
2. ä½¿ç”¨ç›´è¿æ¨¡å¼
3. è”ç³»ç½‘ç®¡éƒ¨é—¨`;
                    effect = () => {
                        addClue('ä»£ç†æœåŠ¡å™¨æ•…éšœå¯¼è‡´ä¸Šä¼ å¤±è´¥', true);
                        updateScore(15);
                    };
                    break;
            }
            
            addTerminalOutput(`è¿è¡Œå·¥å…·: ${toolName}`, 'command');
            addTerminalOutput(output, 'output');
            if (effect) {
                effect();
                checkStepCompletion();
            }
            updateScore(5);
        }
        
        function showHelp() {
            const helpText = `è­¦åŠ¡ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ - å‘½ä»¤å¸®åŠ©
================================
åŸºç¡€ç½‘ç»œè¯Šæ–­:
  ping 127.0.0.1     æµ‹è¯•æœ¬åœ°ç½‘ç»œåè®®æ ˆ
  ping 10.10.1.1     æµ‹è¯•ç½‘å…³è¿é€šæ€§
  ipconfig           æŸ¥çœ‹ç½‘ç»œé…ç½®
  ping www.baidu.com æµ‹è¯•äº’è”ç½‘è¿æ¥

æœåŠ¡å™¨è¯Šæ–­:
  tracert 10.10.100.50  è¿½è¸ªåˆ°æ¡ˆä»¶æœåŠ¡å™¨è·¯ç”±
  telnet 10.10.100.50 8443  æµ‹è¯•æ¡ˆä»¶ç³»ç»Ÿç«¯å£
  nslookup case.gov.cn  DNSè§£ææµ‹è¯•

é˜²ç«å¢™ä¸å®‰å…¨:
  netsh advfirewall show rule name=all  æŸ¥çœ‹æ‰€æœ‰é˜²ç«å¢™è§„åˆ™
  netsh advfirewall show rule name="é˜»æ­¢æ¡ˆä»¶ç³»ç»Ÿç«¯å£"
  proxycfg  æŸ¥çœ‹ä»£ç†é…ç½®

ç³»ç»Ÿå‘½ä»¤:
  help     æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
  clear    æ¸…ç©ºç»ˆç«¯å±å¹•
  status   æ˜¾ç¤ºå½“å‰è¯Šæ–­çŠ¶æ€
  hint     è·å–è¯Šæ–­æç¤º`;
            addTerminalOutput(helpText, 'output');
        }
        
        function addTerminalOutput(text, type = 'output') {
            const terminal = document.getElementById('terminal-output');
            const line = document.createElement('div');
            line.className = 'terminal-line';
            let content = '';
            switch(type) {
                case 'command': content = `<span class="terminal-prompt">C:\\PoliceNet\\Diagnosis></span> <span class="terminal-command">${text}</span>`; break;
                case 'error': content = `<span class="terminal-error">${text}</span>`; break;
                case 'success': content = `<span class="terminal-success">${text}</span>`; break;
                case 'warning': content = `<span class="terminal-warning">${text}</span>`; break;
                default: content = `<span class="terminal-output-text">${text}</span>`;
            }
            line.innerHTML = content;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }
        
        function clearTerminal() {
            document.getElementById('terminal-output').innerHTML = '';
            addTerminalOutput('ç»ˆç«¯å·²æ¸…ç©º\nè­¦åŠ¡ç½‘ç»œè¯Šæ–­ç³»ç»Ÿå°±ç»ª...', 'output');
        }
        
        function showTab(tabName) {
            document.querySelectorAll('.diagnosis-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }
        
        function saveNotes() {
            const notes = document.getElementById('notes-textarea').value;
            localStorage.setItem(`scenario${currentScenario}_notes`, notes);
            showFeedback('è¯Šæ–­è®°å½•å·²ä¿å­˜', 'success');
            updateScore(5);
        }
        
        function exportNotes() {
            const notes = document.getElementById('notes-textarea').value;
            const summary = `=== è­¦åŠ¡ç½‘ç»œè¯Šæ–­æŠ¥å‘Š ===
åœºæ™¯: ${scenarios[currentScenario].name}
è¯Šæ–­æ—¶é—´: ${new Date().toLocaleString()}
æœ€ç»ˆå¾—åˆ†: ${score}
å‰©ä½™æ—¶é—´: ${Math.floor(timeRemaining/60)}åˆ†${timeRemaining%60}ç§’

${notes}

=== ç³»ç»Ÿç”Ÿæˆæ€»ç»“ ===
å‘ç°çº¿ç´¢: ${discoveredClues.size}
å®Œæˆæ­¥éª¤: ${completedSteps.size}/${totalSteps}
ä¸Šä¼ æµ‹è¯•: ${uploadSuccess ? 'æˆåŠŸ' : 'å¤±è´¥'}`;
            const blob = new Blob([summary], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `è­¦åŠ¡ç½‘ç»œè¯Šæ–­æŠ¥å‘Š_åœºæ™¯${currentScenario}_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showFeedback('è¯Šæ–­æŠ¥å‘Šå·²å¯¼å‡º', 'success');
            updateScore(10);
        }
        
        function printNotes() {
            const notes = document.getElementById('notes-textarea').value;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>è­¦åŠ¡ç½‘ç»œè¯Šæ–­æŠ¥å‘Š</title>
                    <style>
                        body { font-family: 'Microsoft YaHei', sans-serif; padding: 20px; }
                        pre { 
                            background: #f5f5f5; 
                            padding: 20px; 
                            border: 1px solid #ddd;
                            border-radius: 5px;
                            white-space: pre-wrap;
                            font-size: 14px;
                        }
                        .header { 
                            text-align: center; 
                            margin-bottom: 30px;
                            border-bottom: 2px solid #333;
                            padding-bottom: 20px;
                        }
                        .summary {
                            margin: 20px 0;
                            padding: 15px;
                            background: #e8f5e9;
                            border-radius: 5px;
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>è­¦åŠ¡ç½‘ç»œè¯Šæ–­æŠ¥å‘Š</h1>
                        <p>åœºæ™¯: ${scenarios[currentScenario].name} | æ—¶é—´: ${new Date().toLocaleString()}</p>
                        <div class="summary">
                            <p>æœ€ç»ˆå¾—åˆ†: ${score} | å‰©ä½™æ—¶é—´: ${Math.floor(timeRemaining/60)}:${(timeRemaining%60).toString().padStart(2,'0')}</p>
                            <p>å‘ç°çº¿ç´¢: ${discoveredClues.size} | å®Œæˆæ­¥éª¤: ${completedSteps.size}/${totalSteps}</p>
                        </div>
                    </div>
                    <pre>${notes}</pre>
                    <script>
                        window.onload = function() {
                            window.print();
                        }
                    <\/script>
                </body>
                </html>
            `);
            printWindow.document.close();
        }
        
        function addClue(clue, isNew = false) {
            if (!discoveredClues.has(clue)) {
                discoveredClues.add(clue);
                updateClueList();
                if (isNew) {
                    showFeedback(`ğŸ¯ å‘ç°æ–°çº¿ç´¢: ${clue}`, 'success');
                    updateScore(10);
                }
            }
        }
        
        function updateClueList() {
            const clueList = document.getElementById('clue-list');
            clueList.innerHTML = '';
            Array.from(discoveredClues).forEach((clue, index) => {
                const li = document.createElement('li');
                li.className = 'clue-item';
                if (index === discoveredClues.size - 1) {
                    li.classList.add('new');
                }
                li.textContent = clue;
                clueList.appendChild(li);
            });
            const totalClues = scenarios[currentScenario].clues.length;
            document.getElementById('clue-count').textContent = `${discoveredClues.size}/${totalClues}`;
        }
        
        function updateScore(points) {
            score = Math.max(0, score + points);
            updateScoreDisplay();
        }
        
        function updateScoreDisplay() {
            document.getElementById('score-display').textContent = score;
        }
        
        function updateTimeDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const timeStr = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('time-remaining').textContent = timeStr;
            document.getElementById('time-score').textContent = timeStr;
            const progress = (timeRemaining / (scenarios[currentScenario].timeLimit * 60)) * 100;
            const timeElement = document.getElementById('time-remaining');
            if (progress < 20) {
                timeElement.style.color = '#f44336';
            } else if (progress < 50) {
                timeElement.style.color = '#ff9800';
            } else {
                timeElement.style.color = '#4caf50';
            }
        }
        
        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeRemaining--;
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    showFeedback('â° æ—¶é—´åˆ°ï¼è¯Šæ–­ä»»åŠ¡å¤±è´¥', 'error');
                    updateScore(-50);
                    document.getElementById('next-step-btn').disabled = true;
                    document.getElementById('next-step-hint').textContent = 'æ—¶é—´è€—å°½ï¼Œä»»åŠ¡å¤±è´¥';
                    return;
                }
                updateTimeDisplay();
                if (timeRemaining === 5 * 60) {
                    showFeedback('âš ï¸ è­¦å‘Šï¼åªå‰©5åˆ†é’Ÿï¼', 'warning');
                } else if (timeRemaining === 60) {
                    showFeedback('ğŸš¨ ç´§æ€¥ï¼åªå‰©1åˆ†é’Ÿï¼', 'error');
                }
            }, 1000);
        }
        
        function checkStepCompletion() {
            let isCompleted = false;
            
            switch(currentStep) {
                case 1:
                    isCompleted = discoveredClues.has('ç½‘å…³è¿æ¥æ­£å¸¸ï¼Œæœ¬åœ°ç½‘ç»œæ— é—®é¢˜') && 
                                 discoveredClues.has('æ¡ˆä»¶ç®¡ç†ç³»ç»Ÿä½¿ç”¨8443ç«¯å£');
                    break;
                case 2:
                    isCompleted = discoveredClues.has('é˜²ç«å¢™å‡ºç«™è§„åˆ™é˜»æŒ¡äº†8443ç«¯å£');
                    break;
                case 3:
                    isCompleted = discoveredClues.has('ä»£ç†æœåŠ¡å™¨æ•…éšœå¯¼è‡´ä¸Šä¼ å¤±è´¥');
                    break;
                case 4:
                    isCompleted = uploadSuccess;
                    break;
            }
            
            if (isCompleted && !completedSteps.has(currentStep)) {
                completedSteps.add(currentStep);
                updateStepTracker();
                updateProgressDots();
                const messages = [
                    "âœ… æ­¥éª¤1å®Œæˆï¼åŸºç¡€ç½‘ç»œè¯Šæ–­é€šè¿‡",
                    "âœ… æ­¥éª¤2å®Œæˆï¼å‘ç°é˜²ç«å¢™é˜»æŒ¡é—®é¢˜",
                    "âœ… æ­¥éª¤3å®Œæˆï¼ç¡®è®¤ä»£ç†æœåŠ¡å™¨æ•…éšœ",
                    "ğŸ‰ æ­¥éª¤4å®Œæˆï¼æ‰€æœ‰é—®é¢˜å·²è¯Šæ–­ï¼Œæ–‡ä»¶ä¸Šä¼ æˆåŠŸ"
                ];
                showFeedback(messages[currentStep - 1], 'success');
                updateScore(25);
                updateNextStepButton();
            }
        }
        
        // ====== åœºæ™¯2å‡½æ•° ======
        function initializeScenario2() {
            updateScenario2ClueList();
            updateScenario2StepTracker();
            updateScenario2ScoreDisplay();
            updateScenario2ProgressDots();
            updateScenario2NextStepButton();
        }
        
        function loadScenario2Step(stepNumber) {
            scenario2Step = stepNumber;
            const scenario = scenarios[2];
            const step = scenario.steps[stepNumber];
            document.getElementById('scenario2-step-title').textContent = step.title;
            document.getElementById('scenario2-step-description').innerHTML = step.description;
            updateScenario2StepTracker();
            updateScenario2ProgressDots();
            if (stepNumber > 1 && stepNumber <= scenario.clues.length) {
                addScenario2Clue(scenario.clues[stepNumber - 1], true);
            }
            addScenario2TerminalOutput(`\n=== æ­¥éª¤ ${stepNumber}: ${step.title} ===\n${step.description.replace(/<[^>]*>/g, '').substring(0, 150)}...\n`, 'output');
            updateScenario2NextStepButton();
            showFeedback(`åœºæ™¯2 - è¿›å…¥æ­¥éª¤ ${stepNumber}: ${step.title}`, 'success');
        }
        
        function showScenario2Tab(tabName) {
            document.querySelectorAll('#scenario2 .diagnosis-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            document.querySelectorAll('#scenario2 .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`scenario2-${tabName}-tab`).classList.add('active');
        }
        
        function executeScenario2Command() {
            const input = document.getElementById('scenario2-command-input');
            const command = input.value.trim();
            if (!command) {
                showFeedback('è¯·è¾“å…¥å‘½ä»¤', 'warning');
                return;
            }
            addScenario2TerminalOutput(`C:\\PoliceNet\\VideoDiagnosis> ${command}`, 'command');
            const response = processScenario2Command(command);
            addScenario2TerminalOutput(response.output, response.type);
            if (response.effect) response.effect();
            input.value = '';
            checkScenario2StepCompletion();
        }
        
        function processScenario2Command(command) {
            const cmd = command.toLowerCase();
            let response = { output: '', type: 'output', effect: null };
            
            if (cmd.includes('show interface')) {
                response.output = `æ¥å£çŠ¶æ€æŠ¥å‘Š:
GigabitEthernet0/1: up, up
GigabitEthernet0/2: up, up
GigabitEthernet0/3: down, down  <- å¼‚å¸¸! è¿æ¥æ‘„åƒå¤´çš„ç«¯å£
GigabitEthernet0/4: down, down  <- å¼‚å¸¸!
GigabitEthernet0/5: up, up
GigabitEthernet0/6: up, up
GigabitEthernet0/7: down, down  <- å¼‚å¸¸!
GigabitEthernet0/8: down, down  <- å¼‚å¸¸!

å‘ç°: ç«¯å£3,4,7,8çŠ¶æ€å¼‚å¸¸ï¼Œè¿™äº›ç«¯å£è¿æ¥ç¦»çº¿æ‘„åƒå¤´`;
                response.effect = () => {
                    addScenario2Clue('å‘ç°äº¤æ¢æœºç«¯å£3,4,7,8çŠ¶æ€å¼‚å¸¸');
                    updateScenario2Score(10);
                };
            }
            else if (cmd.includes('show vlan brief')) {
                response.output = `VLANé…ç½®çŠ¶æ€:
VLAN ID  Name          Status    Ports
---- ----          ------    -----
1    default       active    Gi0/1-2, Gi0/5-6
10   Camera-Net    active    Gi0/3-4, Gi0/7-8
20   Admin-Net     active    Gi0/9-12
100  Management    active    Gi0/24

å‘ç°: æ‘„åƒå¤´VLAN(10)é…ç½®æ­£ç¡®ï¼Œä½†ç«¯å£çŠ¶æ€å¼‚å¸¸`;
                response.effect = () => {
                    addScenario2Clue('æ‘„åƒå¤´VLANé…ç½®æ­£ç¡®ï¼Œä¸æ˜¯VLANé—®é¢˜');
                    updateScenario2Score(5);
                };
            }
            else if (cmd.includes('show spanning-tree')) {
                response.output = `ç”Ÿæˆæ ‘åè®®çŠ¶æ€:
Spanning tree enabled protocol ieee
Root ID    Priority    32768
           Address     0011.2233.4455
           Cost        4
           Port        Gi0/13
           Hello Time  2 sec

Port           Role Sts Cost      Prio.Nbr Type
-------------- ---- --- --------- -------- ----------------------------
Gi0/1          Desg FWD 4         128.1    P2p
Gi0/2          Desg FWD 4         128.2    P2p
Gi0/3          Desg BLK 4         128.3    P2p <- é˜»å¡çŠ¶æ€!
Gi0/4          Desg BLK 4         128.4    P2p <- é˜»å¡çŠ¶æ€!

å‘ç°: ç«¯å£3å’Œ4å¤„äºé˜»å¡çŠ¶æ€ï¼Œå¯èƒ½æ˜¯ç¯è·¯å¯¼è‡´`;
                response.effect = () => {
                    addScenario2Clue('ç”Ÿæˆæ ‘åè®®é˜»å¡äº†æ‘„åƒå¤´ç«¯å£', true);
                    updateScenario2Score(15);
                };
            }
            else if (cmd === 'ping 192.168.10.1') {
                response.output = `æ­£åœ¨ Ping 192.168.10.1 å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:
æ¥è‡ª 192.168.10.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=1ms TTL=255
æ¥è‡ª 192.168.10.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=2ms TTL=255
æ¥è‡ª 192.168.10.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=1ms TTL=255
æ¥è‡ª 192.168.10.1 çš„å›å¤: å­—èŠ‚=32 æ—¶é—´=3ms TTL=255

æ ¸å¿ƒäº¤æ¢æœºå¯è¾¾ï¼ŒåŸºç¡€ç½‘ç»œæ­£å¸¸`;
                response.effect = () => updateScenario2Score(5);
            }
            else if (cmd === 'help' || cmd === '?') {
                response.output = `è§†é¢‘ç›‘æ§ç½‘ç»œè¯Šæ–­ - å¯ç”¨å‘½ä»¤:
================================
äº¤æ¢æœºè¯Šæ–­:
  show interface          æ˜¾ç¤ºæ¥å£çŠ¶æ€
  show vlan brief         æ˜¾ç¤ºVLANé…ç½®
  show spanning-tree      æ˜¾ç¤ºç”Ÿæˆæ ‘çŠ¶æ€
  show ip route           æ˜¾ç¤ºè·¯ç”±è¡¨
  show logging            æ˜¾ç¤ºç³»ç»Ÿæ—¥å¿—
  show mac address-table  æ˜¾ç¤ºMACåœ°å€è¡¨
  show cdp neighbors      æŸ¥çœ‹é‚»å±…è®¾å¤‡

ç½‘ç»œæµ‹è¯•:
  ping <IP>               æµ‹è¯•ç½‘ç»œè¿é€šæ€§
  tracert <IP>            è·¯ç”±è¿½è¸ª

ç³»ç»Ÿå‘½ä»¤:
  help                    æ˜¾ç¤ºæ­¤å¸®åŠ©
  clear                   æ¸…å±
  status                  æ˜¾ç¤ºå½“å‰çŠ¶æ€
  hint                    è·å–æç¤º`;
            }
            else if (cmd === 'clear' || cmd === 'cls') {
                clearScenario2Terminal();
                return {output: '', type: 'output', effect: null};
            }
            else if (cmd === 'status') {
                response.output = `å½“å‰çŠ¶æ€:
åœºæ™¯: ${scenarios[2].name}
æ­¥éª¤: ${scenario2Step}/4
ç§¯åˆ†: ${scenario2Score}
çº¿ç´¢: ${scenario2DiscoveredClues.size}
æ—¶é—´å‰©ä½™: ${Math.floor(scenario2TimeRemaining/60)}:${(scenario2TimeRemaining%60).toString().padStart(2,'0')}`;
            }
            else if (cmd === 'hint') {
                const scenario = scenarios[2];
                const availableClues = scenario.clues.filter(clue => !scenario2DiscoveredClues.has(clue));
                if (availableClues.length > 0) {
                    response.output = `æç¤º: ${availableClues[0]}`;
                    response.effect = () => {
                        addScenario2Clue(availableClues[0]);
                        updateScenario2Score(-5);
                    };
                } else {
                    response.output = 'æš‚æ— æ–°æç¤ºï¼Œè¯·ç»§ç»­æ¢ç´¢ã€‚';
                }
            }
            else {
                response.output = `'${command}' ä¸æ˜¯æœ‰æ•ˆçš„å‘½ä»¤ã€‚\nè¾“å…¥ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤ã€‚`;
                response.type = 'error';
                response.effect = () => updateScenario2Score(-2);
            }
            return response;
        }
        
        function runScenario2Command(command) {
            document.getElementById('scenario2-command-input').value = command;
            executeScenario2Command();
        }
        
        function runScenario2Tool(toolName) {
            let output = '';
            let effect = null;
            
            switch(toolName) {
                case 'switch-check':
                    output = `äº¤æ¢æœºçŠ¶æ€æ£€æŸ¥æŠ¥å‘Š:
================================
è®¾å¤‡: Cisco Catalyst 2960X
è¿è¡Œæ—¶é—´: 45å¤© 12å°æ—¶
CPUä½¿ç”¨ç‡: 15%
å†…å­˜ä½¿ç”¨ç‡: 32%

å…³é”®å‘ç°:
1. ç«¯å£Gi0/3, Gi0/4, Gi0/7, Gi0/8çŠ¶æ€: DOWN
2. é”™è¯¯è®¡æ•°å™¨: è¾“å…¥é”™è¯¯: 1520, è¾“å‡ºé”™è¯¯: 0
3. æœ€åçŠ¶æ€å˜åŒ–: 2å°æ—¶å‰
4. PoEçŠ¶æ€: ç«¯å£3-8 PoEä¾›ç”µå¼‚å¸¸

ç»“è®º: äº¤æ¢æœºç«¯å£ç¡¬ä»¶æ•…éšœæˆ–PoEæ¨¡å—é—®é¢˜`;
                    effect = () => {
                        addScenario2Clue('äº¤æ¢æœºPoEæ¨¡å—å¯èƒ½æ•…éšœ', true);
                        updateScenario2Score(15);
                    };
                    break;
                case 'loop-detection':
                    output = `ç½‘ç»œç¯è·¯æ£€æµ‹æŠ¥å‘Š:
================================
æ­£åœ¨æ£€æµ‹ç½‘ç»œç¯è·¯...

æ£€æµ‹ç»“æœ:
1. å¹¿æ’­åŒ…æ•°é‡å¼‚å¸¸: 15200åŒ…/ç§’ (æ­£å¸¸åº”<100)
2. MACåœ°å€æ¼‚ç§»æ£€æµ‹: å‘ç°å¤šä¸ªç«¯å£å­¦ä¹ åˆ°ç›¸åŒMAC
3. ç”Ÿæˆæ ‘çŠ¶æ€: ç«¯å£Gi0/3, Gi0/4è¢«é˜»å¡
4. ç¯è·¯ä½ç½®: ç–‘ä¼¼åœ¨æ‘„åƒå¤´æ¥å…¥å±‚

ç¯è·¯å½±å“:
- ç½‘ç»œæ€§èƒ½ä¸‹é™
- æ‘„åƒå¤´é€šä¿¡ä¸­æ–­
- äº¤æ¢æœºCPUè´Ÿè½½é«˜

å»ºè®®: æ£€æŸ¥æ‘„åƒå¤´æ¥çº¿ï¼Œç¦ç”¨æœ‰é—®é¢˜çš„ç«¯å£`;
                    effect = () => {
                        addScenario2Clue('æ£€æµ‹åˆ°ç½‘ç»œç¯è·¯å¯¼è‡´å¹¿æ’­é£æš´', true);
                        updateScenario2Score(20);
                    };
                    break;
                case 'vlan-check':
                    output = `VLANé…ç½®éªŒè¯æŠ¥å‘Š:
================================
æ‘„åƒå¤´VLANé…ç½®æ£€æŸ¥:

VLAN 10é…ç½®:
- åç§°: Camera-Net
- IPç½‘æ®µ: 192.168.10.0/24
- ç½‘å…³: 192.168.10.1
- DHCPæœåŠ¡å™¨: 192.168.10.100

ç«¯å£åˆ†é…:
- Gi0/3: VLAN 10 (æ‘„åƒå¤´01-04)
- Gi0/4: VLAN 10 (æ‘„åƒå¤´05-08)
- Gi0/7: VLAN 10 (æ‘„åƒå¤´09-12)
- Gi0/8: VLAN 10 (æ‘„åƒå¤´13-15)

ç»“è®º: VLANé…ç½®æ­£ç¡®ï¼Œä¸æ˜¯é…ç½®é—®é¢˜`;
                    effect = () => updateScenario2Score(10);
                    break;
                case 'poe-check':
                    output = `PoEç”µæºè¯Šæ–­æŠ¥å‘Š:
================================
PoEäº¤æ¢æœºçŠ¶æ€æ£€æŸ¥:

è®¾å¤‡: Cisco C2960X-48FPS-L
æ€»PoEé¢„ç®—: 740W
å·²ç”¨PoEåŠŸç‡: 320W
å¯ç”¨PoEåŠŸç‡: 420W

ç«¯å£PoEçŠ¶æ€:
Gi0/1: æ­£å¸¸ (15.4W)
Gi0/2: æ­£å¸¸ (15.4W)
Gi0/3: æ•…éšœ (0W)  <- å¼‚å¸¸!
Gi0/4: æ•…éšœ (0W)  <- å¼‚å¸¸!
Gi0/7: æ•…éšœ (0W)  <- å¼‚å¸¸!
Gi0/8: æ•…éšœ (0W)  <- å¼‚å¸¸!

é—®é¢˜åˆ†æ:
PoEæ¨¡å—éƒ¨åˆ†æ•…éšœï¼Œå¯¼è‡´æ‘„åƒå¤´ä¾›ç”µä¸­æ–­
å»ºè®®: æ›´æ¢PoEæ¨¡å—æˆ–ä½¿ç”¨å¤–éƒ¨PoEæ³¨å…¥å™¨`;
                    effect = () => {
                        addScenario2Clue('PoEäº¤æ¢æœºæ¨¡å—æ•…éšœå¯¼è‡´æ‘„åƒå¤´æ–­ç”µ', true);
                        updateScenario2Score(25);
                    };
                    break;
            }
            
            addScenario2TerminalOutput(`è¿è¡Œå·¥å…·: ${toolName}`, 'command');
            addScenario2TerminalOutput(output, 'output');
            if (effect) {
                effect();
                checkScenario2StepCompletion();
            }
            updateScenario2Score(5);
        }
        
        function showScenario2Help() {
            const helpText = `è§†é¢‘ç›‘æ§ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ - å‘½ä»¤å¸®åŠ©
================================
é‡ç‚¹æ£€æŸ¥é¡¹:
1. äº¤æ¢æœºç«¯å£çŠ¶æ€ (show interface)
2. VLANé…ç½® (show vlan brief)
3. ç”Ÿæˆæ ‘çŠ¶æ€ (show spanning-tree)
4. PoEç”µæºçŠ¶æ€ (ä¸“ç”¨å·¥å…·æ£€æŸ¥)
5. ç³»ç»Ÿæ—¥å¿— (show logging)

å¸¸è§é—®é¢˜:
1. äº¤æ¢æœºç«¯å£æ•…éšœ
2. ç½‘ç»œç¯è·¯
3. PoEä¾›ç”µé—®é¢˜
4. VLANé…ç½®é”™è¯¯
5. æ‘„åƒå¤´è®¾å¤‡æ•…éšœ`;
            addScenario2TerminalOutput(helpText, 'output');
        }
        
        function addScenario2Clue(clue, isNew = false) {
            if (!scenario2DiscoveredClues.has(clue)) {
                scenario2DiscoveredClues.add(clue);
                updateScenario2ClueList();
                if (isNew) {
                    showFeedback(`ğŸ¯ å‘ç°æ–°çº¿ç´¢: ${clue}`, 'success');
                    updateScenario2Score(10);
                }
            }
        }
        
        function updateScenario2ClueList() {
            const clueList = document.getElementById('scenario2-clue-list');
            clueList.innerHTML = '';
            Array.from(scenario2DiscoveredClues).forEach((clue, index) => {
                const li = document.createElement('li');
                li.className = 'clue-item';
                if (index === scenario2DiscoveredClues.size - 1) {
                    li.classList.add('new');
                }
                li.textContent = clue;
                clueList.appendChild(li);
            });
            const totalClues = scenarios[2].clues.length;
            document.getElementById('scenario2-clue-count').textContent = `${scenario2DiscoveredClues.size}/${totalClues}`;
        }
        
        function updateScenario2StepTracker() {
            const tracker = document.getElementById('scenario2-step-tracker');
            const items = tracker.querySelectorAll('.step-item');
            
            items.forEach((item, index) => {
                item.classList.remove('active', 'completed');
                const stepNum = index + 1;
                
                if (scenario2CompletedSteps.has(stepNum)) {
                    item.classList.add('completed');
                } else if (stepNum === scenario2Step) {
                    item.classList.add('active');
                }
            });
            
            document.getElementById('scenario2-step-count').textContent = `${scenario2CompletedSteps.size}/${totalSteps}`;
        }
        
        function updateScenario2ScoreDisplay() {
            document.getElementById('scenario2-score-display').textContent = scenario2Score;
        }
        
        function updateScenario2Score(points) {
            scenario2Score = Math.max(0, scenario2Score + points);
            updateScenario2ScoreDisplay();
        }
        
        function updateScenario2TimeDisplay() {
            const minutes = Math.floor(scenario2TimeRemaining / 60);
            const seconds = scenario2TimeRemaining % 60;
            const timeStr = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('scenario2-time-remaining').textContent = timeStr;
            document.getElementById('scenario2-time-score').textContent = timeStr;
            const progress = (scenario2TimeRemaining / (scenarios[2].timeLimit * 60)) * 100;
            const timeElement = document.getElementById('scenario2-time-remaining');
            if (progress < 20) {
                timeElement.style.color = '#f44336';
            } else if (progress < 50) {
                timeElement.style.color = '#ff9800';
            } else {
                timeElement.style.color = '#4caf50';
            }
        }
        
        function startScenario2Timer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                scenario2TimeRemaining--;
                if (scenario2TimeRemaining <= 0) {
                    clearInterval(timerInterval);
                    showFeedback('â° æ—¶é—´åˆ°ï¼è§†é¢‘ç›‘æ§è¯Šæ–­ä»»åŠ¡å¤±è´¥', 'error');
                    updateScenario2Score(-50);
                    document.getElementById('scenario2-next-step-btn').disabled = true;
                    document.getElementById('scenario2-next-step-hint').textContent = 'æ—¶é—´è€—å°½ï¼Œä»»åŠ¡å¤±è´¥';
                    return;
                }
                updateScenario2TimeDisplay();
                if (scenario2TimeRemaining === 5 * 60) {
                    showFeedback('âš ï¸ è­¦å‘Šï¼åªå‰©5åˆ†é’Ÿï¼', 'warning');
                } else if (scenario2TimeRemaining === 60) {
                    showFeedback('ğŸš¨ ç´§æ€¥ï¼åªå‰©1åˆ†é’Ÿï¼', 'error');
                }
            }, 1000);
        }
        
        function checkScenario2StepCompletion() {
            let isCompleted = false;
            
            switch(scenario2Step) {
                case 1:
                    isCompleted = scenario2DiscoveredClues.has('å‘ç°äº¤æ¢æœºç«¯å£3,4,7,8çŠ¶æ€å¼‚å¸¸');
                    break;
                case 2:
                    isCompleted = scenario2DiscoveredClues.has('ç”Ÿæˆæ ‘åè®®é˜»å¡äº†æ‘„åƒå¤´ç«¯å£');
                    break;
                case 3:
                    isCompleted = scenario2DiscoveredClues.has('æ£€æµ‹åˆ°ç½‘ç»œç¯è·¯å¯¼è‡´å¹¿æ’­é£æš´');
                    break;
                case 4:
                    isCompleted = scenario2DiscoveredClues.has('PoEäº¤æ¢æœºæ¨¡å—æ•…éšœå¯¼è‡´æ‘„åƒå¤´æ–­ç”µ');
                    break;
            }
            
            if (isCompleted && !scenario2CompletedSteps.has(scenario2Step)) {
                scenario2CompletedSteps.add(scenario2Step);
                updateScenario2StepTracker();
                updateScenario2ProgressDots();
                const messages = [
                    "âœ… æ­¥éª¤1å®Œæˆï¼ç¡®è®¤æ‘„åƒå¤´ç¦»çº¿èŒƒå›´",
                    "âœ… æ­¥éª¤2å®Œæˆï¼å‘ç°ç”Ÿæˆæ ‘é˜»å¡é—®é¢˜",
                    "âœ… æ­¥éª¤3å®Œæˆï¼æ£€æµ‹åˆ°ç½‘ç»œç¯è·¯",
                    "ğŸ‰ æ­¥éª¤4å®Œæˆï¼ç¡®è®¤PoEæ¨¡å—æ•…éšœ"
                ];
                showFeedback(messages[scenario2Step - 1], 'success');
                updateScenario2Score(25);
                updateScenario2NextStepButton();
            }
        }
        
        function updateScenario2ProgressDots() {
            for (let i = 1; i <= totalSteps; i++) {
                const dot = document.getElementById(`scenario2-step${i}-dot`);
                if (dot) {
                    dot.classList.remove('completed', 'active');
                    if (scenario2CompletedSteps.has(i)) {
                        dot.classList.add('completed');
                    } else if (i === scenario2Step) {
                        dot.classList.add('active');
                    }
                }
            }
        }
        
        function updateScenario2NextStepButton() {
            const btn = document.getElementById('scenario2-next-step-btn');
            const hint = document.getElementById('scenario2-next-step-hint');
            
            if (scenario2CompletedSteps.has(scenario2Step) && scenario2Step < totalSteps) {
                btn.disabled = false;
                const nextStep = scenarios[2].steps[scenario2Step + 1];
                hint.textContent = `å‡†å¤‡è¿›å…¥æ­¥éª¤ ${scenario2Step + 1}: ${nextStep.title}`;
            } else if (scenario2Step === totalSteps && scenario2CompletedSteps.has(scenario2Step)) {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-flag-checkered"></i> å®Œæˆæ‰€æœ‰è¯Šæ–­';
                hint.textContent = 'æ­å–œå®Œæˆæ‰€æœ‰è¯Šæ–­æ­¥éª¤ï¼ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹æ€»ç»“';
            } else {
                btn.disabled = true;
                const step = scenarios[2].steps[scenario2Step];
                hint.textContent = `éœ€è¦å®Œæˆå½“å‰æ­¥éª¤: ${step.nextCondition}`;
            }
        }
        
        function advanceScenario2Step() {
            if (!scenario2CompletedSteps.has(scenario2Step)) {
                showFeedback('è¯·å…ˆå®Œæˆå½“å‰æ­¥éª¤çš„è¯Šæ–­', 'warning');
                return;
            }
            
            if (scenario2Step < totalSteps) {
                loadScenario2Step(scenario2Step + 1);
            } else {
                showScenario2Solution();
            }
        }
        
        function showScenario2Solution() {
            const solution = scenarios[2].solution;
            const solutionContent = document.getElementById('scenario2-solution-content');
            
            let html = `<p><strong>æ ¹æœ¬åŸå› åˆ†æï¼š</strong></p>
                       <p>ç»è¿‡è¯Šæ–­å‘ç°åŒé‡é—®é¢˜å¯¼è‡´è§†é¢‘ç›‘æ§ä¸­æ–­ï¼š</p>
                       <ol style="margin-left: 20px; margin-bottom: 15px;">`;
            
            solution.steps.forEach(step => {
                html += `<li class="solution-step">${step}</li>`;
            });
            
            html += `</ol>
                    <p><strong>å®æ–½æ­¥éª¤ï¼š</strong></p>
                    <p>è¯·æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸Šè§£å†³æ–¹æ¡ˆæ­¥éª¤ã€‚</p>`;
            
            solutionContent.innerHTML = html;
            
            document.getElementById('scenario2-solution-area').style.display = 'block';
            
            const btn = document.getElementById('scenario2-next-step-btn');
            const hint = document.getElementById('scenario2-next-step-hint');
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-video"></i> éªŒè¯ç›‘æ§æ¢å¤';
            btn.onclick = function() { verifyScenario2Solution(); };
            hint.textContent = 'æ‰§è¡Œè§£å†³æ–¹æ¡ˆåï¼Œç‚¹å‡»æŒ‰é’®éªŒè¯ç›‘æ§æ¢å¤æƒ…å†µ';
            
            showFeedback('ğŸ¯ è¯Šæ–­å®Œæˆï¼è¯·æŸ¥çœ‹è§£å†³æ–¹æ¡ˆå¹¶å®æ–½', 'success');
        }
        
        function verifyScenario2Solution() {
            const resultDiv = document.getElementById('scenario2-verification-result');
            
            // æ¨¡æ‹ŸéªŒè¯ç»“æœ - éšæœºæˆåŠŸæˆ–å¤±è´¥
            const isSuccess = Math.random() > 0.3; // 70%æˆåŠŸç‡
            
            if (isSuccess) {
                resultDiv.className = 'test-result success';
                resultDiv.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <div>
                        <strong>éªŒè¯æˆåŠŸï¼</strong>
                        <div style="font-size: 12px; margin-top: 5px; color: #a5d6a7;">
                            è§†é¢‘ç›‘æ§ç³»ç»Ÿå·²å®Œå…¨æ¢å¤ï¼<br>
                            æ‰€æœ‰å…³é”®åŒºåŸŸæ‘„åƒå¤´æ¢å¤åœ¨çº¿ã€‚<br>
                            æ¢å¤æ—¶é—´: ${new Date().toLocaleTimeString()}<br>
                            åœ¨çº¿æ‘„åƒå¤´: 15/15
                        </div>
                    </div>
                `;
                
                setTimeout(() => {
                    showFeedback('ğŸ† æ­å–œï¼è§†é¢‘ç›‘æ§ä¸­æ–­æ•…éšœå®Œå…¨è§£å†³ï¼', 'success');
                    updateScenario2Score(100);
                }, 1000);
                
            } else {
                resultDiv.className = 'test-result failure';
                resultDiv.innerHTML = `
                    <i class="fas fa-times-circle"></i>
                    <div>
                        <strong>éªŒè¯å¤±è´¥ï¼</strong>
                        <div style="font-size: 12px; margin-top: 5px; color: #ffcdd2;">
                            éƒ¨åˆ†æ‘„åƒå¤´ä»æœªæ¢å¤ï¼Œè¯·æ£€æŸ¥è§£å†³æ–¹æ¡ˆæ˜¯å¦æ­£ç¡®å®æ–½ã€‚<br>
                            å¯èƒ½éœ€è¦æ›´æ¢PoEæ¨¡å—æˆ–é‡æ–°é…ç½®ç½‘ç»œã€‚
                        </div>
                    </div>
                `;
            }
        }
        
        function addScenario2TerminalOutput(text, type = 'output') {
            const terminal = document.getElementById('scenario2-terminal-output');
            const line = document.createElement('div');
            line.className = 'terminal-line';
            let content = '';
            switch(type) {
                case 'command': content = `<span class="terminal-prompt">C:\\PoliceNet\\VideoDiagnosis></span> <span class="terminal-command">${text}</span>`; break;
                case 'error': content = `<span class="terminal-error">${text}</span>`; break;
                case 'success': content = `<span class="terminal-success">${text}</span>`; break;
                case 'warning': content = `<span class="terminal-warning">${text}</span>`; break;
                default: content = `<span class="terminal-output-text">${text}</span>`;
            }
            line.innerHTML = content;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }
        
        function clearScenario2Terminal() {
            document.getElementById('scenario2-terminal-output').innerHTML = '';
            addScenario2TerminalOutput('ç»ˆç«¯å·²æ¸…ç©º\nè§†é¢‘ç›‘æ§ç½‘ç»œè¯Šæ–­ç³»ç»Ÿå°±ç»ª...', 'output');
        }
        
        function saveScenario2Notes() {
            const notes = document.getElementById('scenario2-notes-textarea').value;
            localStorage.setItem('scenario2_notes', notes);
            showFeedback('è¯Šæ–­è®°å½•å·²ä¿å­˜', 'success');
            updateScenario2Score(5);
        }
        
        function exportScenario2Notes() {
            const notes = document.getElementById('scenario2-notes-textarea').value;
            const summary = `=== è§†é¢‘ç›‘æ§ç½‘ç»œè¯Šæ–­æŠ¥å‘Š ===
åœºæ™¯: ${scenarios[2].name}
è¯Šæ–­æ—¶é—´: ${new Date().toLocaleString()}
æœ€ç»ˆå¾—åˆ†: ${scenario2Score}
å‰©ä½™æ—¶é—´: ${Math.floor(scenario2TimeRemaining/60)}åˆ†${scenario2TimeRemaining%60}ç§’

${notes}

=== ç³»ç»Ÿç”Ÿæˆæ€»ç»“ ===
å‘ç°çº¿ç´¢: ${scenario2DiscoveredClues.size}
å®Œæˆæ­¥éª¤: ${scenario2CompletedSteps.size}/${totalSteps}`;
            const blob = new Blob([summary], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `è§†é¢‘ç›‘æ§è¯Šæ–­æŠ¥å‘Š_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            showFeedback('è¯Šæ–­æŠ¥å‘Šå·²å¯¼å‡º', 'success');
            updateScenario2Score(10);
        }
        
        function printScenario2Notes() {
            const notes = document.getElementById('scenario2-notes-textarea').value;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>è§†é¢‘ç›‘æ§è¯Šæ–­æŠ¥å‘Š</title>
                    <style>
                        body { font-family: 'Microsoft YaHei', sans-serif; padding: 20px; }
                        pre { 
                            background: #f5f5f5; 
                            padding: 20px; 
                            border: 1px solid #ddd;
                            border-radius: 5px;
                            white-space: pre-wrap;
                            font-size: 14px;
                        }
                        .header { 
                            text-align: center; 
                            margin-bottom: 30px;
                            border-bottom: 2px solid #333;
                            padding-bottom: 20px;
                        }
                        .summary {
                            margin: 20px 0;
                            padding: 15px;
                            background: #e8f5e9;
                            border-radius: 5px;
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>è§†é¢‘ç›‘æ§ç½‘ç»œè¯Šæ–­æŠ¥å‘Š</h1>
                        <p>åœºæ™¯: ${scenarios[2].name} | æ—¶é—´: ${new Date().toLocaleString()}</p>
                        <div class="summary">
                            <p>æœ€ç»ˆå¾—åˆ†: ${scenario2Score} | å‰©ä½™æ—¶é—´: ${Math.floor(scenario2TimeRemaining/60)}:${(scenario2TimeRemaining%60).toString().padStart(2,'0')}</p>
                            <p>å‘ç°çº¿ç´¢: ${scenario2DiscoveredClues.size} | å®Œæˆæ­¥éª¤: ${scenario2CompletedSteps.size}/${totalSteps}</p>
                        </div>
                    </div>
                    <pre>${notes}</pre>
                    <script>
                        window.onload = function() {
                            window.print();
                        }
                    <\/script>
                </body>
                </html>
            `);
            printWindow.document.close();
        }
        
        // ====== åœºæ™¯3å‡½æ•° ======
        function initializeScenario3() {
            updateScenario3ClueList();
            updateScenario3StepTracker();
            updateScenario3ScoreDisplay();
            updateScenario3ProgressDots();
            updateScenario3NextStepButton();
        }
        
        function loadScenario3Step(stepNumber) {
            scenario3Step = stepNumber;
            const scenario = scenarios[3];
            const step = scenario.steps[stepNumber];
            document.getElementById('scenario3-step-title').textContent = step.title;
            document.getElementById('scenario3-step-description').innerHTML = step.description;
            updateScenario3StepTracker();
            updateScenario3ProgressDots();
            if (stepNumber > 1 && stepNumber <= scenario.clues.length) {
                addScenario3Clue(scenario.clues[stepNumber - 1], true);
            }
            addScenario3TerminalOutput(`\n=== æ­¥éª¤ ${stepNumber}: ${step.title} ===\n${step.description.replace(/<[^>]*>/g, '').substring(0, 150)}...\n`, 'output');
            updateScenario3NextStepButton();
            showFeedback(`åœºæ™¯3 - è¿›å…¥æ­¥éª¤ ${stepNumber}: ${step.title}`, 'success');
        }
        
        function showScenario3Tab(tabName) {
            document.querySelectorAll('#scenario3 .diagnosis-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            document.querySelectorAll('#scenario3 .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`scenario3-${tabName}-tab`).classList.add('active');
        }
        
        function executeScenario3Command() {
            const input = document.getElementById('scenario3-command-input');
            const command = input.value.trim();
            if (!command) {
                showFeedback('è¯·è¾“å…¥å‘½ä»¤', 'warning');
                return;
            }
            addScenario3TerminalOutput(`MobileNet\\Diagnosis> ${command}`, 'command');
            const response = processScenario3Command(command);
            addScenario3TerminalOutput(response.output, response.type);
            if (response.effect) response.effect();
            input.value = '';
            checkScenario3StepCompletion();
        }
        
        function processScenario3Command(command) {
            const cmd = command.toLowerCase();
            let response = { output: '', type: 'output', effect: null };
            
            if (cmd.includes('signal strength')) {
                response.output = `ä¿¡å·å¼ºåº¦æ£€æµ‹æŠ¥å‘Š:
================================
å½“å‰ä½ç½®: å¸‚ä¸­å¿ƒäº¤é€šæ‰§å‹¤ç‚¹
è¿è¥å•†: ä¸­å›½ç§»åŠ¨ (è­¦åŠ¡ä¸“ç½‘)
ä¿¡å·å¼ºåº¦: -110 dBm (æå¼±) <- å¼‚å¸¸!
ä¿¡å·è´¨é‡: å·®
ç½‘ç»œç±»å‹: æ— æœåŠ¡
å°åŒºID: æœªçŸ¥

å‘ç°: ä¿¡å·æå¼±ï¼Œæ— æ³•æ³¨å†Œåˆ°è­¦åŠ¡ä¸“ç½‘`;
                response.effect = () => {
                    addScenario3Clue('è­¦åŠ¡é€šä¿¡å·å¼ºåº¦æå¼±ï¼Œæ— æ³•æ³¨å†Œç½‘ç»œ');
                    updateScenario3Score(10);
                };
            }
            else if (cmd.includes('show apn')) {
                response.output = `APNé…ç½®æ£€æŸ¥:
================================
APNåˆ—è¡¨:
1. åç§°: CMNET
   çŠ¶æ€: å·²é…ç½® (é»˜è®¤)
   APN: cmnet
   ç±»å‹: default,supl

2. åç§°: Police-Special (è­¦åŠ¡ä¸“ç”¨) <- å½“å‰ä½¿ç”¨
   çŠ¶æ€: å·²é…ç½®
   APN: police.special.apn
   ç±»å‹: default,supl,mms
   ç”¨æˆ·å: police_user
   å¯†ç : ********

3. åç§°: CTLTE
   çŠ¶æ€: å·²é…ç½®
   APN: ctlte
   ç±»å‹: default,supl

å‘ç°: APNé…ç½®æ­£ç¡®ï¼Œä½†ä¸æ˜¯é…ç½®é—®é¢˜`;
                response.effect = () => {
                    addScenario3Clue('è­¦åŠ¡ä¸“ç”¨APNé…ç½®æ­£ç¡®');
                    updateScenario3Score(5);
                };
            }
            else if (cmd.includes('show imsi')) {
                response.output = `SIMå¡çŠ¶æ€æ£€æŸ¥:
================================
è®¾å¤‡: è­¦åŠ¡é€š PD-M001
IMSI: 460001234567890
ICCID: 8986012345678901234
è¿è¥å•†: ä¸­å›½ç§»åŠ¨
ç½‘ç»œçŠ¶æ€: æœªæ³¨å†Œ
æ³¨å†Œæ‹’ç»åŸå› : ç½‘ç»œæ‹’ç» (é”™è¯¯ç : 17)

å‘ç°: SIMå¡æœ‰æ•ˆï¼Œä½†ç½‘ç»œæ‹’ç»æ³¨å†Œ
å¯èƒ½åŸå› : åŸºç«™æ•…éšœã€ä¸“ç½‘ç»´æŠ¤ã€è´¦æˆ·é—®é¢˜`;
                response.effect = () => {
                    addScenario3Clue('SIMå¡æœ‰æ•ˆä½†ç½‘ç»œæ‹’ç»æ³¨å†Œ', true);
                    updateScenario3Score(15);
                };
            }
            else if (cmd === 'ping 8.8.8.8') {
                response.output = `æ­£åœ¨ Ping 8.8.8.8 å…·æœ‰ 32 å­—èŠ‚çš„æ•°æ®:
è¯·æ±‚è¶…æ—¶ã€‚
è¯·æ±‚è¶…æ—¶ã€‚
è¯·æ±‚è¶…æ—¶ã€‚
è¯·æ±‚è¶…æ—¶ã€‚

8.8.8.8 çš„ Ping ç»Ÿè®¡ä¿¡æ¯:
    æ•°æ®åŒ…: å·²å‘é€ = 4ï¼Œå·²æ¥æ”¶ = 0ï¼Œä¸¢å¤± = 4 (100% ä¸¢å¤±)

ç»“è®º: å®Œå…¨æ— æ³•è¿æ¥äº’è”ç½‘`;
                response.effect = () => updateScenario3Score(5);
            }
            else if (cmd === 'help' || cmd === '?') {
                response.output = `è­¦åŠ¡é€šç§»åŠ¨ç½‘ç»œè¯Šæ–­ - å¯ç”¨å‘½ä»¤:
================================
ç½‘ç»œçŠ¶æ€æ£€æŸ¥:
  signal strength         æ£€æŸ¥ä¿¡å·å¼ºåº¦
  show apn               æ˜¾ç¤ºAPNé…ç½®
  show imsi              æ˜¾ç¤ºSIMå¡ä¿¡æ¯
  network scan           æ‰«æå¯ç”¨ç½‘ç»œ
  show data status       æ˜¾ç¤ºæ•°æ®è¿æ¥çŠ¶æ€

ç½‘ç»œæµ‹è¯•:
  ping <IP>              æµ‹è¯•ç½‘ç»œè¿é€šæ€§
  check carrier          æ£€æŸ¥è¿è¥å•†çŠ¶æ€

ç³»ç»Ÿå‘½ä»¤:
  help                   æ˜¾ç¤ºæ­¤å¸®åŠ©
  clear                  æ¸…å±
  status                 æ˜¾ç¤ºå½“å‰çŠ¶æ€
  hint                   è·å–æç¤º
  reset network          é‡ç½®ç½‘ç»œè®¾ç½®`;
            }
            else if (cmd === 'clear' || cmd === 'cls') {
                clearScenario3Terminal();
                return {output: '', type: 'output', effect: null};
            }
            else if (cmd === 'status') {
                response.output = `å½“å‰çŠ¶æ€:
åœºæ™¯: ${scenarios[3].name}
æ­¥éª¤: ${scenario3Step}/4
ç§¯åˆ†: ${scenario3Score}
çº¿ç´¢: ${scenario3DiscoveredClues.size}
æ—¶é—´å‰©ä½™: ${Math.floor(scenario3TimeRemaining/60)}:${(scenario3TimeRemaining%60).toString().padStart(2,'0')}`;
            }
            else if (cmd === 'hint') {
                const scenario = scenarios[3];
                const availableClues = scenario.clues.filter(clue => !scenario3DiscoveredClues.has(clue));
                if (availableClues.length > 0) {
                    response.output = `æç¤º: ${availableClues[0]}`;
                    response.effect = () => {
                        addScenario3Clue(availableClues[0]);
                        updateScenario3Score(-5);
                    };
                } else {
                    response.output = 'æš‚æ— æ–°æç¤ºï¼Œè¯·ç»§ç»­æ¢ç´¢ã€‚';
                }
            }
            else {
                response.output = `'${command}' ä¸æ˜¯æœ‰æ•ˆçš„å‘½ä»¤ã€‚\nè¾“å…¥ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤ã€‚`;
                response.type = 'error';
                response.effect = () => updateScenario3Score(-2);
            }
            return response;
        }
        
        function runScenario3Command(command) {
            document.getElementById('scenario3-command-input').value = command;
            executeScenario3Command();
        }
        
        function runScenario3Tool(toolName) {
            let output = '';
            let effect = null;
            
            switch(toolName) {
                case 'signal-analysis':
                    output = `ä¿¡å·å¼ºåº¦åˆ†ææŠ¥å‘Š:
================================
åœ°ç†ä½ç½®åˆ†æ:
- ä½ç½®: å¸‚ä¸­å¿ƒäº¤é€šæ‰§å‹¤ç‚¹
- é¢„æœŸä¿¡å·å¼ºåº¦: -75 dBm è‡³ -85 dBm
- å®é™…ä¿¡å·å¼ºåº¦: -110 dBm
- ä¿¡å·è¡°å‡: 25-35 dB

é¢‘è°±åˆ†æ:
- ä¸»é¢‘æ®µ: 1800MHz (Band 3)
- å¤‡ç”¨é¢‘æ®µ: 900MHz (Band 8)
- å½“å‰è¿æ¥: æ— 

åŸºç«™æ£€æµ‹:
- æœ€è¿‘åŸºç«™: è·ç¦»500ç±³ (æ­£å¸¸åº”<2000ç±³)
- åŸºç«™çŠ¶æ€: æ£€æµ‹åˆ°ç»´æŠ¤ä¿¡å·
- è­¦åŠ¡ä¸“ç½‘åŸºç«™: ç¦»çº¿ç»´æŠ¤ä¸­

ç»“è®º: è­¦åŠ¡ä¸“ç½‘åŸºç«™è®¡åˆ’å¤–ç»´æŠ¤å¯¼è‡´ä¿¡å·ä¸­æ–­`;
                    effect = () => {
                        addScenario3Clue('è­¦åŠ¡ä¸“ç½‘åŸºç«™ç»´æŠ¤å¯¼è‡´ä¿¡å·ä¸­æ–­', true);
                        updateScenario3Score(20);
                    };
                    break;
                case 'apn-check':
                    output = `APNé…ç½®æ·±åº¦æ£€æŸ¥:
================================
è­¦åŠ¡ä¸“ç”¨APNéªŒè¯:

APNåç§°: police.special.apn
æœåŠ¡å™¨: 10.20.30.40
ç«¯å£: 8080
è®¤è¯: PAP/CHAP
åè®®: IPv4/IPv6
æ¼«æ¸¸åè®®: IPv4

è¿æ¥æµ‹è¯•:
1. DNSè§£æ: æˆåŠŸ
2. æœåŠ¡å™¨è¿æ¥: å¤±è´¥ (è¶…æ—¶)
3. è®¤è¯æ¡æ‰‹: æœªæ‰§è¡Œ
4. æ•°æ®é€šé“: æœªå»ºç«‹

é—®é¢˜åˆ†æ:
APNé…ç½®æ­£ç¡®ï¼Œä½†æ— æ³•è¿æ¥åˆ°è­¦åŠ¡ä¸“ç½‘æœåŠ¡å™¨
å¯èƒ½åŸå› : åŸºç«™æ•…éšœã€ä¸“ç½‘ç»´æŠ¤ã€è·¯ç”±é—®é¢˜`;
                    effect = () => {
                        addScenario3Clue('APNé…ç½®æ­£ç¡®ä½†æ— æ³•è¿æ¥æœåŠ¡å™¨');
                        updateScenario3Score(10);
                    };
                    break;
                case 'carrier-check':
                    output = `è¿è¥å•†çŠ¶æ€æ£€æµ‹æŠ¥å‘Š:
================================
è¿è¥å•†: ä¸­å›½ç§»åŠ¨
ç½‘ç»œç±»å‹: 4G LTE (è­¦åŠ¡ä¸“ç½‘)
åŸºç«™çŠ¶æ€æ£€æŸ¥:

åŸºç«™1 (ID: 12345):
- ä½ç½®: å¸‚ä¸­å¿ƒå¹¿åœº
- çŠ¶æ€: åœ¨çº¿ (å…¬å…±ç½‘ç»œ)
- è­¦åŠ¡ä¸“ç½‘: ç¦»çº¿ç»´æŠ¤
- ç»´æŠ¤æ—¶é—´: 08:00-10:00

åŸºç«™2 (ID: 12346):
- ä½ç½®: å¸‚æ”¿åºœ
- çŠ¶æ€: åœ¨çº¿ (å…¬å…±ç½‘ç»œ)
- è­¦åŠ¡ä¸“ç½‘: ç¦»çº¿ç»´æŠ¤
- ç»´æŠ¤æ—¶é—´: 08:00-10:00

è”ç³»è¿è¥å•†ç»“æœ:
ç¡®è®¤è­¦åŠ¡ä¸“ç½‘åŸºç«™è®¡åˆ’å¤–ç»´æŠ¤
é¢„è®¡æ¢å¤æ—¶é—´: 10:30
å½±å“èŒƒå›´: å¸‚ä¸­å¿ƒåŒºåŸŸ`;
                    effect = () => {
                        addScenario3Clue('ç¡®è®¤è¿è¥å•†åŸºç«™ç»´æŠ¤å¯¼è‡´è­¦åŠ¡ä¸“ç½‘ä¸­æ–­', true);
                        updateScenario3Score(25);
                    };
                    break;
                case 'emergency-test':
                    output = `ç´§æ€¥é€šä¿¡æµ‹è¯•æŠ¥å‘Š:
================================
å¤‡ç”¨é€šä¿¡æ–¹æ¡ˆæµ‹è¯•:

æ–¹æ¡ˆ1: å…¬å…±ç½‘ç»œAPN
- APN: cmnet
- è¿æ¥æµ‹è¯•: æˆåŠŸ
- é€Ÿåº¦: 25 Mbps
- é™åˆ¶: æ— æ³•è®¿é—®è­¦åŠ¡å†…ç½‘

æ–¹æ¡ˆ2: å«æ˜Ÿé€šä¿¡ (å¤‡ç”¨)
- è®¾å¤‡çŠ¶æ€: å°±ç»ª
- è¿æ¥æµ‹è¯•: æˆåŠŸ
- é€Ÿåº¦: 2 Mbps
- å¯ç”¨æ€§: ç´§æ€¥æƒ…å†µä¸“ç”¨

æ–¹æ¡ˆ3: æ— çº¿Meshç½‘ç»œ
- è®¾å¤‡çŠ¶æ€: éƒ¨ç½²ä¸­
- è¦†ç›–èŒƒå›´: 500ç±³åŠå¾„
- è¿æ¥æµ‹è¯•: éƒ¨åˆ†æˆåŠŸ

åº”æ€¥å»ºè®®:
1. ä¸´æ—¶ä½¿ç”¨å…¬å…±ç½‘ç»œAPNå¤„ç†éæ•æ„Ÿæ•°æ®
2. å¯ç”¨å«æ˜Ÿé€šä¿¡å¤„ç†ç´§æ€¥è­¦åŠ¡
3. éƒ¨ç½²ä¾¿æºå¼åŸºç«™æ¢å¤ä¸“ç½‘è¦†ç›–`;
                    effect = () => {
                        addScenario3Clue('åº”æ€¥é€šä¿¡æ–¹æ¡ˆæµ‹è¯•å®Œæˆ', true);
                        updateScenario3Score(15);
                    };
                    break;
            }
            
            addScenario3TerminalOutput(`è¿è¡Œå·¥å…·: ${toolName}`, 'command');
            addScenario3TerminalOutput(output, 'output');
            if (effect) {
                effect();
                checkScenario3StepCompletion();
            }
            updateScenario3Score(5);
        }
        
        function showScenario3Help() {
            const helpText = `è­¦åŠ¡é€šç§»åŠ¨ç½‘ç»œè¯Šæ–­ç³»ç»Ÿ - å‘½ä»¤å¸®åŠ©
================================
é‡ç‚¹æ£€æŸ¥é¡¹:
1. ä¿¡å·å¼ºåº¦ (signal strength)
2. APNé…ç½® (show apn)
3. SIMå¡çŠ¶æ€ (show imsi)
4. è¿è¥å•†ç½‘ç»œ (network scan)
5. æ•°æ®è¿æ¥çŠ¶æ€ (show data status)

å¸¸è§é—®é¢˜:
1. ä¿¡å·å¼±æˆ–æ— ä¿¡å·
2. APNé…ç½®é”™è¯¯
3. SIMå¡æ•…éšœ
4. è¿è¥å•†ç½‘ç»œé—®é¢˜
5. è®¾å¤‡ç¡¬ä»¶æ•…éšœ`;
            addScenario3TerminalOutput(helpText, 'output');
        }
        
        function addScenario3Clue(clue, isNew = false) {
            if (!scenario3DiscoveredClues.has(clue)) {
                scenario3DiscoveredClues.add(clue);
                updateScenario3ClueList();
                if (isNew) {
                    showFeedback(`ğŸ¯ å‘ç°æ–°çº¿ç´¢: ${clue}`, 'success');
                    updateScenario3Score(10);
                }
            }
        }
        
        function updateScenario3ClueList() {
            const clueList = document.getElementById('scenario3-clue-list');
            clueList.innerHTML = '';
            Array.from(scenario3DiscoveredClues).forEach((clue, index) => {
                const li = document.createElement('li');
                li.className = 'clue-item';
                if (index === scenario3DiscoveredClues.size - 1) {
                    li.classList.add('new');
                }
                li.textContent = clue;
                clueList.appendChild(li);
            });
            const totalClues = scenarios[3].clues.length;
            document.getElementById('scenario3-clue-count').textContent = `${scenario3DiscoveredClues.size}/${totalClues}`;
        }
        
        function updateScenario3StepTracker() {
            const tracker = document.getElementById('scenario3-step-tracker');
            const items = tracker.querySelectorAll('.step-item');
            
            items.forEach((item, index) => {
                item.classList.remove('active', 'completed');
                const stepNum = index + 1;
                
                if (scenario3CompletedSteps.has(stepNum)) {
                    item.classList.add('completed');
                } else if (stepNum === scenario3Step) {
                    item.classList.add('active');
                }
            });
            
            document.getElementById('scenario3-step-count').textContent = `${scenario3CompletedSteps.size}/${totalSteps}`;
        }
        
        function updateScenario3ScoreDisplay() {
            document.getElementById('scenario3-score-display').textContent = scenario3Score;
        }
        
        function updateScenario3Score(points) {
            scenario3Score = Math.max(0, scenario3Score + points);
            updateScenario3ScoreDisplay();
        }
        
        function updateScenario3TimeDisplay() {
            const minutes = Math.floor(scenario3TimeRemaining / 60);
            const seconds = scenario3TimeRemaining % 60;
            const timeStr = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('scenario3-time-remaining').textContent = timeStr;
            document.getElementById('scenario3-time-score').textContent = timeStr;
            const progress = (scenario3TimeRemaining / (scenarios[3].timeLimit * 60)) * 100;
            const timeElement = document.getElementById('scenario3-time-remaining');
            if (progress < 20) {
                timeElement.style.color = '#f44336';
            } else if (progress < 50) {
                timeElement.style.color = '#ff9800';
            } else {
                timeElement.style.color = '#4caf50';
            }
        }
        
        function startScenario3Timer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                scenario3TimeRemaining--;
                if (scenario3TimeRemaining <= 0) {
                    clearInterval(timerInterval);
                    showFeedback('â° æ—¶é—´åˆ°ï¼è­¦åŠ¡é€šè¯Šæ–­ä»»åŠ¡å¤±è´¥', 'error');
                    updateScenario3Score(-50);
                    document.getElementById('scenario3-next-step-btn').disabled = true;
                    document.getElementById('scenario3-next-step-hint').textContent = 'æ—¶é—´è€—å°½ï¼Œä»»åŠ¡å¤±è´¥';
                    return;
                }
                updateScenario3TimeDisplay();
                if (scenario3TimeRemaining === 5 * 60) {
                    showFeedback('âš ï¸ è­¦å‘Šï¼åªå‰©5åˆ†é’Ÿï¼', 'warning');
                } else if (scenario3TimeRemaining === 60) {
                    showFeedback('ğŸš¨ ç´§æ€¥ï¼åªå‰©1åˆ†é’Ÿï¼', 'error');
                }
            }, 1000);
        }
        
        function checkScenario3StepCompletion() {
            let isCompleted = false;
            
            switch(scenario3Step) {
                case 1:
                    isCompleted = scenario3DiscoveredClues.has('è­¦åŠ¡é€šä¿¡å·å¼ºåº¦æå¼±ï¼Œæ— æ³•æ³¨å†Œç½‘ç»œ');
                    break;
                case 2:
                    isCompleted = scenario3DiscoveredClues.has('SIMå¡æœ‰æ•ˆä½†ç½‘ç»œæ‹’ç»æ³¨å†Œ');
                    break;
                case 3:
                    isCompleted = scenario3DiscoveredClues.has('ç¡®è®¤è¿è¥å•†åŸºç«™ç»´æŠ¤å¯¼è‡´è­¦åŠ¡ä¸“ç½‘ä¸­æ–­');
                    break;
                case 4:
                    isCompleted = scenario3DiscoveredClues.has('åº”æ€¥é€šä¿¡æ–¹æ¡ˆæµ‹è¯•å®Œæˆ');
                    break;
            }
            
            if (isCompleted && !scenario3CompletedSteps.has(scenario3Step)) {
                scenario3CompletedSteps.add(scenario3Step);
                updateScenario3StepTracker();
                updateScenario3ProgressDots();
                const messages = [
                    "âœ… æ­¥éª¤1å®Œæˆï¼ç¡®è®¤ä¿¡å·é—®é¢˜",
                    "âœ… æ­¥éª¤2å®Œæˆï¼å‘ç°ç½‘ç»œæ‹’ç»æ³¨å†Œ",
                    "âœ… æ­¥éª¤3å®Œæˆï¼ç¡®è®¤åŸºç«™ç»´æŠ¤é—®é¢˜",
                    "ğŸ‰ æ­¥éª¤4å®Œæˆï¼åº”æ€¥æ–¹æ¡ˆæµ‹è¯•å®Œæˆ"
                ];
                showFeedback(messages[scenario3Step - 1], 'success');
                updateScenario3Score(25);
                updateScenario3NextStepButton();
            }
        }
        
        function updateScenario3ProgressDots() {
            for (let i = 1; i <= totalSteps; i++) {
                const dot = document.getElementById(`scenario3-step${i}-dot`);
                if (dot) {
                    dot.classList.remove('completed', 'active');
                    if (scenario3CompletedSteps.has(i)) {
                        dot.classList.add('completed');
                    } else if (i === scenario3Step) {
                        dot.classList.add('active');
                    }
                }
            }
        }
        
        function updateScenario3NextStepButton() {
            const btn = document.getElementById('scenario3-next-step-btn');
            const hint = document.getElementById('scenario3-next-step-hint');
            
            if (scenario3CompletedSteps.has(scenario3Step) && scenario3Step < totalSteps) {
                btn.disabled = false;
                const nextStep = scenarios[3].steps[scenario3Step + 1];
                hint.textContent = `å‡†å¤‡è¿›å…¥æ­¥éª¤ ${scenario3Step + 1}: ${nextStep.title}`;
            } else if (scenario3Step === totalSteps && scenario3CompletedSteps.has(scenario3Step)) {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-flag-checkered"></i> å®Œæˆæ‰€æœ‰è¯Šæ–­';
                hint.textContent = 'æ­å–œå®Œæˆæ‰€æœ‰è¯Šæ–­æ­¥éª¤ï¼ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹æ€»ç»“';
            } else {
                btn.disabled = true;
                const step = scenarios[3].steps[scenario3Step];
                hint.textContent = `éœ€è¦å®Œæˆå½“å‰æ­¥éª¤: ${step.nextCondition}`;
            }
        }
        
        function advanceScenario3Step() {
            if (!scenario3CompletedSteps.has(scenario3Step)) {
                showFeedback('è¯·å…ˆå®Œæˆå½“å‰æ­¥éª¤çš„è¯Šæ–­', 'warning');
                return;
            }
            
            if (scenario3Step < totalSteps) {
                loadScenario3Step(scenario3Step + 1);
            } else {
                showScenario3Solution();
            }
        }
        
        function showScenario3Solution() {
            const solution = scenarios[3].solution;
            const solutionContent = document.getElementById('scenario3-solution-content');
            
            let html = `<p><strong>æ ¹æœ¬åŸå› åˆ†æï¼š</strong></p>
                       <p>ç»è¿‡è¯Šæ–­å‘ç°è¿è¥å•†åŸºç«™ç»´æŠ¤å¯¼è‡´è­¦åŠ¡ä¸“ç½‘ä¸­æ–­ï¼š</p>
                       <ol style="margin-left: 20px; margin-bottom: 15px;">`;
            
            solution.steps.forEach(step => {
                html += `<li class="solution-step">${step}</li>`;
            });
            
            html += `</ol>
                    <p><strong>å®æ–½æ­¥éª¤ï¼š</strong></p>
                    <p>è¯·æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸Šè§£å†³æ–¹æ¡ˆæ­¥éª¤ã€‚</p>`;
            
            solutionContent.innerHTML = html;
            
            document.getElementById('scenario3-solution-area').style.display = 'block';
            
            const btn = document.getElementById('scenario3-next-step-btn');
            const hint = document.getElementById('scenario3-next-step-hint');
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-mobile-alt"></i> éªŒè¯ç½‘ç»œæ¢å¤';
            btn.onclick = function() { verifyScenario3Solution(); };
            hint.textContent = 'æ‰§è¡Œè§£å†³æ–¹æ¡ˆåï¼Œç‚¹å‡»æŒ‰é’®éªŒè¯è­¦åŠ¡é€šç½‘ç»œæ¢å¤æƒ…å†µ';
            
            showFeedback('ğŸ¯ è¯Šæ–­å®Œæˆï¼è¯·æŸ¥çœ‹è§£å†³æ–¹æ¡ˆå¹¶å®æ–½', 'success');
        }
        
        function verifyScenario3Solution() {
            const resultDiv = document.getElementById('scenario3-verification-result');
            
            // æ¨¡æ‹ŸéªŒè¯ç»“æœ - éšæœºæˆåŠŸæˆ–å¤±è´¥
            const isSuccess = Math.random() > 0.3; // 70%æˆåŠŸç‡
            
            if (isSuccess) {
                resultDiv.className = 'test-result success';
                resultDiv.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <div>
                        <strong>éªŒè¯æˆåŠŸï¼</strong>
                        <div style="font-size: 12px; margin-top: 5px; color: #a5d6a7;">
                            è­¦åŠ¡é€šç§»åŠ¨ç½‘ç»œå·²æ¢å¤ï¼<br>
                            æ‰€æœ‰8å°è­¦åŠ¡é€šæ¢å¤åŸºæœ¬é€šä¿¡åŠŸèƒ½ã€‚<br>
                            æ¢å¤æ—¶é—´: ${new Date().toLocaleTimeString()}<br>
                            ç½‘ç»œç±»å‹: 4G LTE (å…¬å…±ç½‘ç»œAPN)
                        </div>
                    </div>
                `;
                
                setTimeout(() => {
                    showFeedback('ğŸ† æ­å–œï¼è­¦åŠ¡é€šæ— æ³•è”ç½‘æ•…éšœå®Œå…¨è§£å†³ï¼', 'success');
                    updateScenario3Score(100);
                }, 1000);
                
            } else {
                resultDiv.className = 'test-result failure';
                resultDiv.innerHTML = `
                    <i class="fas fa-times-circle"></i>
                    <div>
                        <strong>éªŒè¯å¤±è´¥ï¼</strong>
                        <div style="font-size: 12px; margin-top: 5px; color: #ffcdd2;">
                            éƒ¨åˆ†è­¦åŠ¡é€šä»æœªæ¢å¤ç½‘ç»œï¼Œè¯·æ£€æŸ¥è§£å†³æ–¹æ¡ˆæ˜¯å¦æ­£ç¡®å®æ–½ã€‚<br>
                            å¯èƒ½éœ€è¦é‡æ–°é…ç½®APNæˆ–è”ç³»è¿è¥å•†ã€‚
                        </div>
                    </div>
                `;
            }
        }
        
        function addScenario3TerminalOutput(text, type = 'output') {
            const terminal = document.getElementById('scenario3-terminal-output');
            const line = document.createElement('div');
            line.className = 'terminal-line';
            let content = '';
            switch(type) {
                case 'command': content = `<span class="terminal-prompt">MobileNet\\Diagnosis></span> <span class="terminal-command">${text}</span>`; break;
                case 'error': content = `<span class="terminal-error">${text}</span>`; break;
                case 'success': content = `<span class="terminal-success">${text}</span>`; break;
                case 'warning': content = `<span class="terminal-warning">${text}</span>`; break;
                default: content = `<span class="terminal-output-text">${text}</span>`;
            }
            line.innerHTML = content;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }
        
        function clearScenario3Terminal() {
            document.getElementById('scenario3-terminal-output').innerHTML = '';
            addScenario3TerminalOutput('ç»ˆç«¯å·²æ¸…ç©º\nè­¦åŠ¡é€šç§»åŠ¨ç½‘ç»œè¯Šæ–­ç³»ç»Ÿå°±ç»ª...', 'output');
        }
        
        function saveScenario3Notes() {
            const notes = document.getElementById('scenario3-notes-textarea').value;
            localStorage.setItem('scenario3_notes', notes);
            showFeedback('è¯Šæ–­è®°å½•å·²ä¿å­˜', 'success');
            updateScenario3Score(5);
        }
        
        // ====== é€šç”¨å‡½æ•° ======
        function showFeedback(message, type = 'info') {
            const container = document.getElementById('feedback-container');
            const feedback = document.createElement('div');
            feedback.className = `feedback-message ${type}`;
            feedback.innerHTML = `
                <div style="display: flex; align-items: center; gap: 15px;">
                    <i class="fas fa-${getFeedbackIcon(type)}"></i>
                    <div>${message}</div>
                </div>
            `;
            
            container.appendChild(feedback);
            
            setTimeout(() => {
                if (feedback.parentNode) {
                    feedback.parentNode.removeChild(feedback);
                }
            }, 3000);
        }
        
        function getFeedbackIcon(type) {
            switch(type) {
                case 'success': return 'check-circle';
                case 'warning': return 'exclamation-triangle';
                case 'error': return 'times-circle';
                default: return 'info-circle';
            }
        }
    </script>
</body>
</html>